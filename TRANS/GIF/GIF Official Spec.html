<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>GIF Official Spec</title>
  </head>
  <body> <sub>Переклад українською - <a href="mailto:ac2epsilon@gmail.com">Арсеній
        Чеботарьов</a> - Ніжин 2017</sub><br>
    <pre style="color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; word-wrap: break-word; white-space: pre-wrap;">    Заголовна сторінка GIF89a Specification


    ВІДКЛАДЕНІ КОДИ ОЧИЩЕННЯ В LZW КОМПРЕСІЇ

    Було непорозуміння щодо того, де коди очидення можуть бути знайдені в потоці даних. Як каже специфікація, вони можуть з'явитись будь-коли. Немає вимоги надсилати коди очищення тільки коли таблиця рядків повна. Це рішення кодувальника, коли таблиця має бути очищеною. Коли таблиця заповнена, кодувальник може обрати використовувати таблицю як є, не роблячи в ній змін до того, коли кодувальник вирішить очистити її. На протязі цього часу кодувальник надсилає коди, що за межами максимального розміру коду. Як ми побачимо нижче, коли таблиця декодера повна, вона має залишатись незмінною до отримання коду очищення. Розмір коду є максимальним розміром коду. Обробка, крім цього, виконується звичайно. <br>
    Завдяки великій кількості декодерів, що не вміють обробляти декомпресію в цьому стилі, ми вмовили розробників програмного забезпечення кодувальниуів GIF НЕ реалізувати цю можливість щонайменш до 1991 року та пізніше, якщо їх власний ринок ще не готовий до цього. Це дасть розробникам GIF декодерів час для реалізації цієї можливості, та передасть її в руки їх клієнтів, перед тим, як декодери почнуть "ламатись" на нових     GIF. Не вимагається, щоб кодувальники змінювали своє програмне забезпечення, щоб отримати переваги від відкладеного кода очищення, але для декодерів це так.

    БЛОК РОЗШИРЕННЯ ЗАСТОСУВАННЯ - ІДЕНТИФІКАТОР ЗАСТОСУВАННЯ

    Буде файл Директорії Ввічливості на CompuServe на форумі PICS. Ця директорія буде містити Ідентифікатори Застосувань для блоків розширення застосування, що будуть використовуватись розробниками GIF застосувань. Цей файл призначений для допомоги розробникам, що бажають створити блоки розширення застосування від одночасного використання ідентифікаторів. Це не офіційна директорія; вона призначена тільки для добровільної участі, та не гарантує, що дехто не використає той самий ідентифікатор. Треба надіслати лист до Larry Wood (менеджер форума PICS), що вказує на запит на включення власного ідентифікатора до цього файла.


              GRAPHICS INTERCHANGE FORMAT(sm) Версія 89a (c)1987,1988,1989,1990
              Copyright CompuServe Incorporated Columbus, Ohio

CompuServe Incorporated                              Graphics Interchange Format
Дата документу : 31 July 1990                         Посилання по програмуванню

                                      Зміст

Дисклаймер  .................................................................  1

Передмова ...................................................................  1

Ліцензія   ..................................................................  1

Про документ        .........................................................  2

Загальний опис       ........................................................  2

Номери версій    ............................................................  2

Кодувальник  ................................................................  3

Декодувальник................................................................  3

Відповідність................................................................  3

Щодо рекомендацій      ......................................................  4

Щодо таблиці кольорів........................................................  4

Блоки, розширення та поле дії...............................................  4

Розмір блоків................................................................  5

Використання GIF як вбудованого протокола....................................  5

субблоки даних  ............................................................  5

Термінатор блоку  ...........................................................  6

Заголовок ...................................................................  7

Дескриптор логічного екрана..................................................  8

Глобальна таблиця кольорів................................................... 10

Дескриптор зображення........................................................ 11

Лакальна таблиця кольорів.................................................... 13

Дані зображення на базі таблиці.............................................. 14

Розширення контроля графіки.................................................. 15

Розширення коментаря......................................................... 17

Розширення простого тексту .................................................. 18

Розширення застосування...................................................... 21

Трейлер  .................................................................... 23

Таблиця швидких посилань..................................................... 24

Граматика GIF................................................................ 25

Глосарій  ................................................................... 27

Домовленості ................................................................ 28

Переміжені зображення........................................................ 29

Компрессія LZW зі змінною довжиною коду...................................... 30

Можиливості в один рядок       .............................................. 33

1. Дисклаймер

Все, що тут подане, може бути змінено без повідомлення. В жодному разі CompuServe Incorporated не відповідатиме за втрату, включаючи любу втрату прибутку, або інші ненамисні або наведені збитки, що зазнані від використання або незрозуміння цієї інформації; CompuServe Incorporated не має передбачень щодо вірного застосування цієї інформації.

2. Передмова

Цей документ визначає Graphics Interchange Format. Надана тут специфікація визначає версію 89a, що є поширенням версії 87a. Версія Graphics Interchange Format(sm), що визначається тут, має розглядатись як повна; любе відхилення від його має визначатись як непотріб, включаючи, але не обмежуючись, використанням зарезервованих або невизначених полів в контрольних блоках або блоках даних, використання методів або алгоритмів, що не вказані як частина формату, тощо. Загалом, любі або всі відхилення, розширення або модифікації, не вказані в цьому документі повинні розглядатись як порушення формату, та їх слід уникати.


3. Ліцензування

The Graphics Interchange Format(c) є copyright власністю CompuServe Incorporated. Тільки CompuServe Incorporated авторизований до визначення, перевизначення, розширення, зміни, модифікації або переміни в любий спосіб визначення формата. CompuServe Incorporated цим надає обмежену, не-ексклюзивну, роялти-фрі ліцензію на використання Graphics Interchange Format(sm) в комп'ютерному програмноу забезпеченні; комп'ютерне програмне забезпечення, що задіє GIF(sm) має визнавати власність Graphics Interchange Format, та його Service Mark за CompuServe Incorporated у власній технічній та користувацькій документації. Комп'ютерне програмне забезпечення, що використовує GIF, та розповсюджується, або може розповсюджуватись без користувацької або технічної документації, повинне відображувати не екрані або принтері повідомлення щодо власності Graphics Interchange Format та Service Mark за CompuServe Incorporated; в цьому випадку відповідне повідомлення може відображуватись на відкриваючому вікні або початковому банері, або на заключному вікні або банері. Може використовуватись повідомлення наступного змісту: "The Graphics Interchange Format(c) is the Copyright property of CompuServe Incorporated. GIF(sm) is a Service Mark property of CompuServe Incorporated."

Щодо подальшої інформації, будь ласка, звертайтесь сюди: 

      CompuServe Incorporated
      Graphics Technology Department
      5000 Arlington Center Boulevard
      Columbus, Ohio  43220
      U. S. A.

CompuServe Incorporated підтримує поштовий список з усіма особами та організаціями, хто бажає отримувати копії цього документа, коли він виправляється або переробляється. Цей сервіс надається безкоштовно; для цього запровадьте нам свою поштову адресу.


4. Про цей документ

Цей документ описує в деталях визначення Graphics Interchange Format. Цей документ призначений як посилання для програмування; рекомендуєтсья уважно прочитати цілий документ, перед тим як почати програмування, оскільки різні частини взаємно пов'язані. Існують окремі частини для кожного з блоків формату. В кожному розділі існує субсекція повтірбної версії, що посилається на номер версії кодувальника, яку треба використовувати, якщо даний блок присутній в потоці даних. В кожному розділі діаграма описує окремі поля блока; діаграма малюється вертикально; верхні байти в діаграмі з'являються перші в потоці даних. Біти в байті зображуються зліва від самого значущого біта.  Багато-байтові числові поля впорядковані в форматі найменш-значущий-перший. Числові константи представлені як шістнадцятирічні, та починаються з "0x". Бітові поля в байті описані в порядку від найбільш значущих бітів.


5. Загальний опис

Graphics Interchange Format(sm) визначає протокол, призначений для онлайн передачі та обміну растровими даними зображення в спосіб, що є незалежним від обладнання, що використовуєтсья для створення та відображення.

Graphics Interchange Format визначений в термінах блоків та субблоків, що містять відповідні параметри та дані, що використовуються для відтворення графіки. Потік даних GIF є послідовністю блоків та субблоків протоколу, що представляють набір графчних зображень. Загалом, зображення в потоці певною мірою вважаються пов'язаними, та поділяють деяку контрольну інформацію; рекомендовано, щоб кодувальники намагались групувати разом пов'язані зображення, щоб мінімізувати зміни обладнання в процесі обробки та мінімізувати навантаження на контрольну інформацію. З тієї ж причини, непов'язана графіка, або така, що потребує скидання параметрів обладнання, повинна бути закодована окремо, в межах можливості. 

Потік даних може мати локальне походження, як коли коли читається з файла, або може походити віддалено, як коли передається через лінії комунікації. Формат визначений в припущенні, що для комунікації використовується транспортний протокол з виправленням помилок; формат не має способів для пошуку та корекції помилок.

Потік даних GIF має бути інтерпретований в контексті, тобто, програма-застосування має покладатись на інформацію, зовнішню до потоку даних, щоб викликати процес декодувальника.


6. Номери версій

Номери версії в заголовку потоку даних призначений для ідентифікації мінімального набору можливостей, потрібних для декодера, щоб повністю обробити потік даних. Кодувальник повинен використовувати найраніший можливий номер версії, що включає всі блоки, використані в потоці даних. В кожному розділі блока цього документа є відмітка, що позначає номер версії, що означає найраніший номе версії, що включає відповідний блок. Кодувальник повинен зробити спробу використовувати найраніший номер версії, що покриває всі блоки в потоці даних; непотрібне використання пізнішого номера версії буде перешкоджати обробці деякими декодерами.


7. Кодувальник (енкодер)

Кодувальник є програмою, що використовуєтья для створення потоку даних GIF. З растрових даних та іншої інформації енкодер продукує потрібні блоки контролю та даних, що треба для відтворення оригінальної графіки.

Кодувальник відповідає за наступні аспекти.

- Включає в потік даних всю потрібну інформацїю для відтворення графіки.

- Переконується, що потік даних помічений найранішим номером версії, що покриває всі блоки в ньому; це дасть гарантію, що цей потік даних зможе обробити найбільша кількість декодерів.

- Виконує кодуваняя графіки таким чином, щоб оптимізувати процес декодування. За змоги надмірна інформація відкидається.

- В рамках можливого уникається групування графіки, що інакше може викликати потребу скидання апаратних параметрів в процесі декодування. <br>
- Встановлювати в нуль (вимикати) кожний з бітів кожного поля, що помічені як зарезервовані. Зауважте, що ті є поля в дескрипторі логічного екрана та дескрипторі зображення зарезервовані в версії 87a, але використовуються в версії 89a.


8. Декодер

Декодер є програмою, що використовується для обробки потоку даних GIF. Він послідовно обробляє потік даних, розбираючи різні блоки та субблоки, використовуючи контрольну інформацію для налаштування обладнання та обробки параметрів, та інтерпретує дані для малювання графіки.

Декодер відповідає за наступне.

- Обробляє кожний фрагмент графіки в потоці без затримок, якщо не вказано в контрольній інформації.

- Встановлює параметри обладнання для максимальної відповідності з контрольною інформацією в потоці даних.


9. Відповідність

Енкодер та декодер відповідні до певної версії Graphics Interchange Format, якщо, і тільки коли, вони повністю відповідають та коректно реалізують визначення стандарту, асоційованого з цією версією. Кодувальник та декодер можуть бути відповідними з даним номером версії, та не сумісними з деякою наступною версією.


10. Щодо рекомендацій

Кожний розділ блока цього документа містить мітку щодо рекомендацій; цей розділ перелічує набір рекомендацій, призначених для настанов та організації використання певного блоку. Такі рекомендації спрямовані на більш ефективне функціонування енкодерів та декодерів, так само, як і покращує використання пропускної полоси комунікацій. Рекомендовано, щоб всі слідували цім настановам.


11. Щодо таблиць кольорів

Формат GIF утилізує таблиці кольорів для малювання растрової графіки. Таблиця кольорів може мати один з двох полей дії: глобальний або локальний. Глобальна таблиця кольорів використовуєть всіма тими зображеннями в потоці даних, які не мають асоційованих локальний таблиць кольорів. Глобальна таблиця кольорів огортає весь потік. Локальна таблиця завжди асоційована з окремим зображенням, що безпосередньо слідує за нею; дія локальної таблиці кольорів обмежена до одного зображення. Локальна таблиця кольорів переважає глобальну таблицю, тобто, якщо потік даних має глобальну таблицю кольорів, та зображення має локальну таблицю кольорів, декодер має зберігти глобальну таблицю, використовувати локальну для малювання зображення, та потім відновити локальну таблицю. Обоє типи таблиці кольорів є опціональними, що робить можливим, щоб потік даних мав декілька зображень взагалі без таблиці кольорів. З цієї причини рекомендовано, щоб декодер зберігав останню використану глобальну таблицю, доки не надійде нова глобальна таблиця. В такий спосіб потік даних, що не містить ані глобальної, ані локальної таблиці, може виконувати обробку з використанням останньої глобальної таблиці кольорів, що була збережена. Якщо використовується збережена глобальна таблиця від попереднього потоку, тоді вона стає глобальною таблицею для нагального потоку. Це призначено для зменшення навантаження через таблиці кольорів. Зокрема, рекомендовано, щоб енкодер використовував тільки одну глобальну таблицю кольорів, якщо всі зображення в пов'язаних потоках даних можуть бути відтворені за допомогою однієї таблиці. Якщо доступної таблиці кольорів немає, декодер вільний використовувати системну таблицю кольорів або свою власну таблицю. В цьому випадку декодер може використовувати таблицю з такою кількістю кольорів, яке може підтримувати його обладнання; рекомендовано, щоб така таблиця мала чорний та білий як свої перші два елементи, так що монохромні зображення будуть відображуватись адекватно.

Визначення формату GIF дозволяє, щоб потік даних містив лише заголовок, дескриптор логічного екрана, глобальну таблицю та завершуючий GIF трейлер. Такий потік даних може бути використаний для завантаження в декодер глабальну таблицю кольорів, як підготування для наступних потоків даних, що взагалі не мають таблиць кольорів.


12. Блоки, розширення та сфера дії

Блоки можуть бути класифіковані в три групи: контрольні, відображення графіки та спеціального призначення. Контрольні блоки, такі як заголовок, дескриптор логічного екрану, розширення графічного контролю та трейлер, містять інформацію, що використовуєтсья для обробки потоку даних, або інформації, що встановлює параметри обладнання. Блоки відтворення графіки, такі, як дескриптор зображення або розширення простого тексту містять інформацію та дані, що використовуються для відтворення графіки на пристрої дисплея. Блоки спеціального призначення, такі як розширення коментаря та розширення застосування не використовуються ані в контролі процесом потоку даних, та вони не містять інформацію або дані для відтворення графіки на пристрої дисплею. За винятком дескриптора та глобальної таблиці даних, чия дія весь потік даних, дія інших обмежена до наступного блока малювання. Блоки спеціального призначення не обмежують дію жодних контрольних блоків; блоки спеціального призначення взагалі прозорі для процесу декодування. Блоки малювання графіки та розширення використовуються як обмежувачі бачення для контрольних блоків та розширень. Мітки, використані для помічення блоків, підпадають до трьох диапазонів: 0x00-0x7F (0-127) є блоки графічного відтворення, включаючи трейлер (0x3B); 0x80-0xF9 (128-249) є контрольні блоки; 0xFA-0xFF (250-255) є блоками спеціального призначення. Ці диапазони визначені так, щоб декодери могли обробляти поле дії блоку, відповідно ідентифікувавши мітку блока, навіть якщо самий блок не може бути оброблений.


13. Розмір блоків

Поле розміру блока виміряє число байт в блоці, не зважаючи на саме це поле розміру, та не зважаючи на термінатор блоку, якщо такий передбачений. Блоки, окрім блоків даних, призначені бути фіксованого розміру; поле розміру блока провадиться для того, щоб спростити їх перестрибування, бо їх розмір не зміниться в майбутньому. Блоки даних та субблоки змінні за довжиною, щоб відповідати кількості даних.


14. Використання GIF як вбудованого протоколу

В якості вбудованого протоколу GIF може бути частиною більшого протоколу застосування, де GIF використовується для малювання графіки. В такому випадку може визначати блок, в якому може міститись потік даних GIF. Пограма-застосування потім буде викликати декодер GIF, коли натрапить на блок з типом GIF. Цей підхід рекомендований переважно до використання розширень застосування, що накладатиме навантаження на всі інші застосування, що не оброблятимуть його. Оскільки потік GIF має бути оброблений в контексті, застосування має покладатись на деякі засоби, що відрізнятимуть потік даних GIF в середині самого потіку.


15. Субблоки даних: 87a

Дані субблоків є одиницями, що містять дані. Вони не мають мітки, ці блоки обробляються в контексті контрольних блоків, коли блоки даних вказані в форматі. Перший байт субблока даних вказує на число байт, що послідують. Субблок даних може містити від 0 до 255 байтів даних. Розмір блока не зважає на сам байт розміру, та, таким чином, пустий субблок має один байт зі значенням 0x00.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Розмір блоку                 Байт
     +---------------+
  1  |               |
     +-             -+
  2  |               |
     +-             -+
  3  |               |
     +-             -+
     |               |       Значення Даних                Байт
     +-             -+
 up  |               |
     +-   . . . .   -+
 to  |               |
     +-             -+
     |               |
     +-             -+
255  |               |
     +---------------+

Розмір блоку - число байтів в субблоці даних; розмір має бути в межах від 0 до 255 байтів, включно. Значення даних - любі байти, кількість яких точно співпадає з полем розміру.

Цей блок завжди виникає як частина більшого блоку. Сам по собі він не має сфери дії.


16. Блок термінатора: 87a

Цей субблок даних нульової довжини використовується для завершення послідовності субблоків даних. Він містить один байт в позиції розміру блоку, та не містить даних.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Розмір блоку                 Байт
     +---------------+

Цей субблок з особливою довжиною, значенням 0x00. Блок не містить жодних даних. Цей блок завершує послідовність субблоків. Він не може бути модифікований жодним розширенням.
<br>
17. Заголовок. Не має відношення до версії, бо сам містить номер версії. 

Заголовок ідентифікує потік даних GIF в контексті. Поле сигнатури відмічає початок потоку даних, та версія ідентифікує набір можливостей, що має забезпечувати декодер, щоб повністю обробляти потік даних. Цей блок ОБОВ'ЯЗКОВИЙ; в потоці даних має бути рівно один потік даних.


      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
   0 |               |       Сигнатура                     3 Байт
     +-             -+
   1 |               |
     +-             -+
   2 |               |
     +---------------+
   3 |               |       Версія                        3 Байт
     +-             -+
   4 |               |
     +-             -+
   5 |               |
     +---------------+

Сигнатура ідентифікує потік даних, це поле має бути завжди містити значення 'GIF'. Версія є номером версії, яку використовує потік даних. Вказує на мінімальний набір можливостей, потрібних декодеру, щоб повністю обробити потік даних. Версії даних станом на 1990й рік: "87a" та "89a". Номери версій утворюються збільшенням числового та літерного компонент. <br><br>Цей блок має глобальне значення, та не може бути модифікований жодним розширенням.
<br>Це поле вказує на початок потоку даних GIF; він не призначений для надання унікальної сигнатури для ідентифікації даних. Ремендовано, щоб потік даних GIF був розпізнаватись зовнішньо самим застосуванням. Посилайтесь до Додатку G щодо онлайн ідентифікації потоку даних GIF.

Версія: енкодер має використовувати найранший номе рверсії, що покриває всі блоки в потоці даних. Коли два або більше потоків даних комбінуються, треба використовувати найпізніший номер версії для результуючого потоку. Декодер повинен спробувати обробляти потік даних з найвищим рівнем можливостей; якщо він натрапляє на номер версії, що не може повністю обробити, він, тим не менш, має намагатись обробити потік даних як зможе, можливо попередивши користувача, що дані можуть бути неповні.


18. Дескриптор логічного екрана. Версія не стосується даного блока. 

Дескриптор логічного екрана містить параметри, потрібні для визначення місця, де буде намальоване зображення. Координати в цьому блоці беруться з верхнього правого кута віртуального екрана; вони не обов'язково посилаються на абсолютні координати пристрою дисплея. Це має на увазі, що вони не посилаються на віконні координати оточення віконного інтерфейсу, або координати принтера, коли використовується принтер.

Цей блок ОБОВ'ЯЗКОВИЙ; рівно один дескриптор логічного екрана має бути присутній в потоці даних. Версія не стосується даного блока. Цей блок має слідувати безпосередньо за блоком заголовка.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Ширина логічного екрана      Беззнакове
     +-             -+
  1  |               |
     +---------------+
  2  |               |       Висота логічного екрана      Беззнакове
     +-             -+
  3  |               |
     +---------------+
  4  | |     | |     |       Паковані біти                Див.нижче
     +---------------+
  5  |               |       Індекс фонового кольору      Байт
     +---------------+
  6  |               |       Пропорція пікселя            Байт
     +---------------+


     Паковані біти    =      Флаг глобальної таблиці кольору   1 Біт
                             Розрішення кольору                3 Біт
                             Флаг сортування                   1 Біт
                             Розмір глобальної таблиці         3 Біт

Логічні ширина та висота екрана - розміри в пікселях, де буде відображені зображення на пристрої дисплея.
<br>Флаг глобальної таблиці кольорів - флаг вказує присутність глобальної таблиці; якщо встановлений, глобальна таблиця слідує безпосередньо за дескриптором логічного екрана. Флаг також обирає інтерпретацію індекса фонового кольору; якщо флаг встановлений, значення індексу фона повинне використовуватись як індекс в таблиці для фонового кольору. Це поле найбільш важливий біт байта. Значення: 0 - глобальна таблиця відсутня, індекс фону не має сенсу, 1 - глобальна таблиця слідує за дескриптором логічного екрана, індекс фону має сенс. 

Розрішення кольору - число біт на кожний первинний колір, доступний для оригінального зображення, мінус 1. Це значення представляє розмір цілої палітри, з якої обираються кольори для графіки, не число кольорів, що дійсно використовуються в графіці. Наприклад, якщо значення в цьому полі є 3, тоді палітра оригінального зображення має 4 біти на кожний первинний колір, доступних для створення оригінального зображення. Це значення повинне бути встановлене щоб вказувати на багатство оригінальної палітри, навіть якщо не кожний колір з цілої палітри доступне на машині джерела.
<br>Флаг сортування - вказує, чи глобальна таблиця кольорів відсортована. Якщо флаг встановлений, таблиця відсортована, в порядку зменшення важливості. Типово, порядок буде за зменшенням частоти використання, найбільш часті кольори ідуть першими. Це допомагає декодеру з меншим числом доступних кольорів, щоб обрати кращий набір кольорів; декодер може використовувати початковий сегмент таблиці щоб малювати графіку. Значення: 0 - не впорядковано, 1 - впорядковано за зменшенням значущості, більш важливі перші.

Розмір глобальної таблиці - якщо таблиця присутня, та відповідний флаг встановлений в 1, значення в цьому полі використовуєтсья для обчислення числа байтів, що містяться в глобальній таблиці кольорів. Щоб визначити дійсний розір таблиці кольорів, віднесіть 2 ступеня значення_цього_поля+1. Навіть якщо глобальна таблиця не встановлена, встановіть це поле відповідно до формули вище, так що декодери можуть обрати кращий режим графіки для відображення потоку. Це поле займає три найменш значущі біти байта.

Індекс фонового кольору - індекс в глобальній таблиці кольорів для кольору фона. Колір фона використовується для тих пікселів екрана, що не покриті зображеннями. Якщо флаг глобальної таблиці встановлений в нуль, це поле повинно бути встановлене в ноль, та повинне ігноруватись.

Пропорції викривлення пікселя - коефіцієнт, що використовуєтсья для обчислення апроксимації геометричних пропорцій пікселя в оригінальному зображенні. Якщо значення цього поля не є 0, ця апроксимація пропорцій обчислюється за формулою: пропорція = (значення_цього_поля + 15) / 64. Пропорція визначається як частка довжини пікселя до його висоти. Диапазон значень для цього поля дозволяє задати найширші пікселі 4:1 до найвищих пікселів 1:4 з кроком в 1/64. Значення: 0 - пропорція пікселя не надається, 1..255 - значення, що використовується в обчисленнях. Дія блока стосується всього потока даних.

19. Глобальна таблиця кольорів. Версія 87a

Цей блок містить таблицю кольорів, що є послідовніть байтів, що по при поспіль представляють компоненти червоного-зеленого-синього. Глобальна таблиця кольорів використовується зображеннями без локальної таблиці, та також розширенням простого тексту. Її присутність позначається флагом глобальної таблиці, що встановлений в 1, в дескрипторі логічного екрана; якщо присутня, глобальна таблиця слідує безпосередньо за дескрипторов логічного екрана, та містить кількість байтів, рівну 3 x 2^(розмір_глобальної_таблиці+1). Цей блок ОПЦІОНАЛЬНИЙ; в кожному потоці даних може зустрічатись щонайбільше одна глобальна таблиця кольорів.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +===============+
  0  |               |       Червоний 0                   Байт
     +-             -+
  1  |               |       Зелений 0                    Байт
     +-             -+
  2  |               |       Синій 0                      Байт
     +-             -+
  3  |               |       Червоний 1                   Байт
     +-             -+
     |               |       Зелений 1                    Байт
     +-             -+
 up  |               |
     +-   . . . .   -+       ...
 to  |               |
     +-             -+
     |               |       Зелений 255                  Байт
     +-             -+
767  |               |       Синій 255                    Байт
     +===============+


Цей блок має дію для всього потоку даних. Він не може бути модифікований розширенням.

20. Дескриптор зображення. Версія 87a
<br>Кожне зображення в потоці даних складається з дескриптора зображення, опціональної локальної таблиці кольорів, та даних зображення. Кожне зображення має вкладатись в рамки логічного екрана, як визначено в дескрипторі логічного екрана.<br><br>Дескриптор екрана містить параметри, необхідні для обробки зображення на базі таблиці. Координати, надані в блоці, посилаються на координати логічного екрана, та надаються в пікселях. Цей блок є блоком малювання графіки, перед яким опціонально стоять один або більше контрольні блоки, такі, як блок розширення графічного контролю, та може опціонально завершуватись локальною таблицею кольорів; за дескриптором зображення завжди ідуть дані зображення.

Цей блок ПОТРІБЕН для зображення. Для кожного зображення в потоці даних має бути рівно один дескриптор зображення.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Роздільник зображень         Байт
     +---------------+
  1  |               |       Ліва позиція зображення      Беззнакове
     +-             -+
  2  |               |
     +---------------+
  3  |               |       Верхня позиція зображення    Беззнакове
     +-             -+
  4  |               |
     +---------------+
  5  |               |       Ширина зображежння           Беззнакове
     +-             -+
  6  |               |
     +---------------+
  7  |               |       Висота зображення            Беззнакове
     +-             -+
  8  |               |
     +---------------+
  9  | | | |   |     |       &lt;Запаковані поля&gt;            Дивіться нижче
     +---------------+

     &lt;Запаковані поля&gt;  =    Флаг локлаьної таблиці        1 Біт
                             Флаг переміження              1 Біт
                             Флаг сортування               1 Біт
                             Зарезервовані                 2 Біт
                             Розмір локальної таблиці      3 Біт

Роздільник зображень - вказує на початок дескриптора зображення. Це поле містить фіксоване значення 0x2C.

Ліва позиція зображення - номер рядка, в пікселях, лівого края зображення, відносно лівого краю логічного екраан.Самий лівий стовпчик логічного екрана має номер 0.
<br>Верхня позиція екрана - номер рядка, в пікселях, верхнього края зображення, відносно верхнього краю логічного екрана. Верхній рядок логічного екрана має номер 0.

Ширина зображення - ширина зображення в пікселях.

Висота зображення - висота зображення в пікселях.

Флаг локальної таблиці кольорів - вказує присутність локальної таблиці кольорів безпосередньо за цім дескрипторам зображення. (Це поле найбільш значущий біт байта.) Значення: 0 - локальна таблиця кольлорів відсутня. 1 - локальна таблиця присутня, та слідує безпосередньо за цім дескриптором зображення.
<br>Флаг переміжування - вказує, чи зображення переміжене. Зображення є переміженним за шаблоном чотирьох проходів; дивіться Додаток E щодо деталей. Значення: 0 - зображення не переміжене, 1 - зображення переміжене.

Флаг сортування - вказує, чи локальна таблиця кольорів сортована. Якщо флаг встановлений, локальна таблиця сортована в порядку зменьшення важливості. Типово, порядок порядок має бути за зменшенням частоти, де найбільш часті кольори ідуть першими. Це допомагає декодеру, з меншими доступними кольорами, при обиранні кращої підмножини кольорів; декодер може використовувати початковий сегмент таблиці для малювання графіки. Значення: 0 - не сортована, 1 - сортована за зменшенням важливості, найбільш важливі кольори перші.

Розмір локальної таблиці кольорів - якщо флаг локальної таблиці кольорів встановлений в 1, значення цього поля використовується для обчислення числа байтів, що містяться в локальній таблиці. Щоб визначити дійсний розмір таблиці кольорів, піднесіть 2 в ступінь в цьому полі + 1. Це значення повинне бути 0, якщо не вказано локальної таблиці кольорів. (Це поле займає три найменш значущі біти байта.)

Поле дії цього блока є блок даних зображення. Цей блок може бути модифікований розширенням графічного контролю.

21. Локальна таблиця кольорів. Версія 87a

Цей блок містить таблицю кольорів, що є послідовністю байтів, які представляють триплети червоний-зелений-синій. Локальна таблиця використовується зображенням, що безпосередньо слідує за нею. Її присутність відмічається флагом локальної таблиці кольлорів, що встановлений в 1 в дескрипторі зображення; якщо присутня, локальна таблиця слідує безпосередньо за дескриптором зображення, та містить число байтів, рівне 3x2^(розмфір_локальної_таблиці+1).Коли присутня, ця таблиця тимчасово стає активною таблицею кольорів, та наступне зображення має оброблятись з її використанням. Цей блок є ОПЦІОНАЛЬНИМ; на кожний дескриптор зображення може бути щонайбільше одна локальна таблиця, та поле її дії є одне зображення, що асоційоване з дескриптором зображення.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +===============+
  0  |               |       Червоний 0                   Байт
     +-             -+
  1  |               |       Зелений 0                    Байт
     +-             -+
  2  |               |       Синій 0                      Байт
     +-             -+
  3  |               |       Червоний 1                   Байт
     +-             -+
     |               |       Зелений 1                    Байт
     +-             -+
 up  |               |
     +-   . . . .   -+       ...
 to  |               |
     +-             -+
     |               |       Зелений 255                  Байт
     +-             -+
767  |               |       Синій 255                    Байт
     +===============+

Поле дії цього блоку є блок даних зображення, що слідує за ним. Блок не може бути модифікований розширенням.<br>
22. Базовані на таблиці дані зображення. Версія 87a

Дані зображення для базованого на таблиці зображення складаються з послідовності субблоків, розміром щонайбільше 255 байтів кожний, що містять індекс в активній кодовій таблиці для кожного пікселя в зображенні. Піксельні індекси ідуть в порядку зліва направо зверху до низу. Кожний індекс має бути в межах розміру активної кодової таблиці, починаючи з 0. Послідовність індексів закодована з використанням алгоритму LZW з кодом змінної довжини, як описано в Додатку F

     c. Синтакс формату даних зображення наступний:

      7 6 5 4 3 2 1 0        Ім'я поля                     Тип
     +---------------+
     |               |       LZW мінімальний розмір коду   Байт
     +---------------+

     +===============+
     |               |
     /               /       Дані зображення               Субблоків даних
     |               |
     +===============+

LZW мінімальний розмір коду. Цей байт визначає початкове число біт, що використовуються для кодів LZW в даних зображення, як описане в Додатку F.

Цей блок не має поля дії, він містить растрові дані. Розширення, призначені для модифікації зображення на базі таблиці, мають з'являтись до відповідного дескриптора зображення.


23. Розширення графічного контроля. Версія 89a

Розширення графічного контроля містить параметри, що використовуються для обробки блока графічного малювання. Поле дії цього розширення є перший графічний блок, що послідує. Розширення містить тільки один субблок даних. Цей блок ОПЦІОНАЛЬНИЙ; блоку графічного малювання може передувати не більше одного розширення графічного контроля. Це єдине обмеження на кількість розширень графічного контроля, що можуть міститись в потоці даних.

      7 6 5 4 3 2 1 0        Ім'я поля                     Тип
     +---------------+
  0  |               |       Вступ розширення              Байт
     +---------------+
  1  |               |       Маркер графічного контроля    Байт
     +---------------+

     +---------------+
  0  |               |       Розмір блоку                  Байт
     +---------------+
  1  |     |     | | |       &lt;Паковані поля&gt;               Дивіться нижче
     +---------------+
  2  |               |       Час затримки                  Беззнакове
     +-             -+
  3  |               |
     +---------------+
  4  |               |       Індекс прозорого кольору      Байт
     +---------------+

     +---------------+
  0  |               |       Завершувач блоку              Байт
     +---------------+


      &lt;Паковані поля&gt;  =     Зарезервовано                 3 Біт
                             Метод очищення                 3 Біт
                             Флаг користувацького вводу    1 Біт
                             Флаг прозорого кольору        1 Біт

Вступ розширення - вказує на початок блока розширення. Це поле містить фіксоване значення 0x21.

Маркер графічного контроля - ідентифікує поточний блок як розширення графічного контролю. Це поле має фіксоване значення        0xF9.
<br>Розмір блоку - часло байтів в блоці після розміру блоку, та аж до, але не включаючи завершувач блоку. Це поле містить фіксоване значення 4.

Метод очищення - вказує, в який спосіб буде трактуватись після того, як вона відображена.

            Значення :  0 -   Очищення не задане. Декодер не має виконувати жодних дій.
                        1 -   Не очищувати. Графіка буде залишатись на місці.
                        2 -   Відновити до фонового кольлору. Область, використана для <br>			      графіки, міє відновитись до фонового кольору.
                        3 -   Відновити до попереднього. Від декодера вимагається відновити <br>			      область, що пула переписана зображенням, тим, що було там до цього.
                      4-7 -   Доки не визначено.
<br>Флаг користувацького вводу - Індикує, буде або ні користувацький ввод очікуваться перед продовженням. Якщо цей флаг встановлений, обробка буде продовжувженої, коли користувач введе всій ввід. Природа користувацького вводу визначається застосуванням (перевод рядка, клацання мишою, тощо).

            Значення :  0 -   Користувацький ввод не очікується.
                        1 -   Очікується користувацький ввод.
<br>Коли заданий час затримки, та встановлений флаг користувацького вводу, обробка буде продовжена, коли буде отриманий користувацький ввод, або коли вийде затримка, що відбудеться раніше.
<br>Флаг прозорості - вказує, чи наданий індекс прозорості в відповідному полі (це поле є найменш значущим бітом в байті).

            Значення :  0 -   Індекс прозорості не вказаний.
                        1 -   Індекс прозорості вказаний.
<br>Час затримки - якщо не 0, це поле вказує число в сотих (1/100) частинах секунди, як час очікування перед обробкою потоку даних. Час почианє відлічуватись безпосередньо після малювання графіки. Це поле може бути використане в поєднанні з флагом користувацького вводу.<br><br>Індес прозорого кольору - якщо зустрічається, відповідний піксель пристрою відображення не модифікується, та обробка переходить до наступного пікселя. Індекс присутній, тільки якщо флаг прозорості встановлений в 1.
<br>Завершувач блоку - цей блок даних нульової довжини відмічає кінець розширення графічного контролю.

Поле дії цього розширення є блок графічного малювання, що слідує за ним; можлива присутність інших розширень між цім блоком і ціллю. Цей блок може модифікувати блок дескриптора зображення, та блок звичайеого текста.<br><br>Рекомендації<br><br>Метод очищення: режим відновлення попереднього зображення призначений для використання в малих секціях графіки. Використання цього режиму має на увазі значні вимоги на декодері по зблеріганню секцій графіки, що потібно зберігти. З цієї причини цей режим повинен використовуватись помірковано. Цей режим не призначений для зберігання всієї графіки. Коли потрібне саме це, кодувальник повинен прикласти всіх зусиль, щоб зробити розділи графіки, що мають відновлюватись, окремими зоображеннями в потоці даних. В випадку, коли декодер не в змозі зберігати область графіки, що помічена для відновлення, рекомендовано, щоб декодер відновлював фоновий колір.<br><br>Флаг користувацького вводу: коли цей флаг встановлено, що вказує, що очікується користувацький ввод, декодер може програти сигнал символом (0x07), щоб попередити користувача, що очікується ввод. При відсутності вказаного часу затримки, декодер має очікувати користувацького безкінечно. Рекомендовано, щоб кодувальник не встановлював флаг користувацького вводу без задання часу затримки.


24. Розширення коментаря. Версія 89a
<br>Розширеня коментаря містить текстуальну інформацію, що не є частиною справжньої графіки в потоці даних GIF. Це підходить для включення коментарів щодо графіки, авторів, опису або любого іншого типу не-контрольних та не-графічних даних. Розширення коментаря може бути проігнорована декодером, або воно може бути збережене для подальшої обробки. Ні за яких умов розширення коментаря не повинне заважати або взаємодіяти з обробкою потока даних.

Цей блок ОПЦІОНАЛЬНИЙ, в потоці даних може з'являтись люба кількість таких блоків.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Вступ розширення             Байт
     +---------------+
  1  |               |       Маркер коментаря             Байт
     +---------------+

     +===============+
     |               |
  N  |               |       Дані коментаря               Субблоки даних
     |               |
     +===============+

     +---------------+
  0  |               |       Завершувач блоку              Байт
     +---------------+

Вступ розширення - вказує на початок блока розширення. Це поле містить фіксоване значення 0x21.
<br>Мітка коментаря - ідентифікує блок як розширення коментаря. Це поле містить фіксоване значення 0xFE.

Дані коментаря - послідовність субблоків, кожний розміром щонайбільше 255 байт, та щонайменьше 1 байт, з розміром в байті, що передує даним. Кінець послідовності відмічений завершувачем блоку.<br><br>Завершувач блоку - блок даних нульової довжини, що позначає кінець розширення коментаря.<br><br>Цей блок не має поля дії. Цей блок не може бути модифікований ніяким розширенням.
<br>Рекомендації
<br>Дані: цей блок призначений для людей. Він має містити текст з використанням набір символів 7-біт ASCII. Цей блок не повинен використовуватись для контрольної інформації для власної обробки.<br><br>Позиція: цей блок може з'являтись в любій точці в потоці даних, де може починатись блок. Однак рекомендовано, щоб розширення коментаря не взаємодіяв з контрольними блоками та даними даних; вони мають розміщуватись на початку або в кінці потоку даних, наскільки це можливо. 

25. Розширення простого тексту. Версія 89a

Розширення простого тексту містить текстові дані та параметри, необхідні для малювання ціх даних як графіки в простій формі. Текстуальні дані закодовані як 7-бітні друковані ASCII символи. Текстові дані малюються з використанням решітки символів, визначеної в полях блока. Кожний символ малюється в окремій клітині. Текстуальні дані в блоці відмальовуються як пропорційні символи, по одному в клітині, з найкращим заповненням щодо розміру та шрифту. Щодо подальшої інформації дивіться рекомендації нижче. Символи даних беруться послідовно з області даних блоку, та відмальовуються в клітинці, починаючи з верхнього лівого кута в сітці, та продовжуються зліва направо та зверху донизу. Текстові дані малюються до кінця тексту, або доки сітка не буде заповнена. Сітка символів містить цілі номери клітин; в випадку, коли розмірності клітин не дозволяють цілі числа, дробні клітини мають бути відкинуті; кодувальник має уважно вказати розмірність клітин, так, щоб цього не трапилось. Цей блок потребує глобальної таблиці кольорів, щоб це було можливе; кольори, що використовуються цім блоком, посилаються на глобальну таблицю в потоці, якщо така є, або на глобальну таблицю з попереднього потоку, якщо він був збережений. Цей блок є блоком графічного малювання, і, таким чином, може бути модифікований розширенням графічного контролю. Цей блок є ОПЦІОНАЛЬНИМ; в потоці даних може траплятись будь яка кількість таких блоків.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Вступ розширення             Байт
     +---------------+
  1  |               |       Мітка простого тексту        Байт
     +---------------+

     +---------------+
  0  |               |       Розмір блоку                 Байт
     +---------------+
  1  |               |       Ліва позиція решітки       Беззнакове
     +-             -+
  2  |               |
     +---------------+
  3  |               |       Верхня позиція решітки     Беззнакове
     +-             -+
  4  |               |
     +---------------+
  5  |               |       Ширина решітки             Беззнакове
     +-             -+
  6  |               |
     +---------------+
  7  |               |       Висота решітки             Беззнакове
     +-             -+
  8  |               |
     +---------------+
  9  |               |       Ширина клітини символів      Байт
     +---------------+
 10  |               |       Висота клітини символів      Байт
     +---------------+
 11  |               |       Індекс кольору текста        Байт
     +---------------+
 12  |               |       Індекс кольору фона          Байт
     +---------------+

     +===============+
     |               |
  N  |               |       Дані простого тексту     Дані субблока
     |               |
     +===============+

     +---------------+
  0  |               |       Завершувач блоку             Байт
     +---------------+

Вступ розширення - вказує на початок блока розширення. Це поле містить фіксоване значення 0x21.


Мітка простого тексту - ідентифікує блок як розширення простого тектсу. Це поле містить фіксоване значення 0x01.

Розмір блоку - число байтів розширення після самого розміру, але не включаючи початок даних. Це поле має фіксоване значення 12.

Ліва позиція решітки - стовпчик в пікселях лівого кута текстової решітки відносно логічного екрана.
Верхня позиція решітки - номер рядка в пікселях верхнього кута текстової решітки відносно логічного екрана.
Ширина решітки - ширина текстової решітки в пікселях.
Висота решітки - висота текстової решітки в пікселях.
Ширина клітини символа - ширина в пікселях кожної клітини решітки.
Висота клітини символа - висота в пікселях кожної клітини решітки.<br>Індекс кольору тексту - індекс в глобальній таблиці кольору тексту.
Індекс кольору фона - індекс в глобальній таблиці кольору фону. 
<br>Дані простого тексту - послідовність субблоків, кожний від 1 до 255 байтів, де розмір передує даним. Кінець послідовності позначається завершувачем блоку.<br><br>Завершувач блоку - блок з нульовою довжиною, що позначає кінець блоків даних простого тексту.

Розширення та поле дії. Поле дії цього блока є простий текст, що міститься в ньому. Цей блок може бути модифікований розширенням графічного контролю.

Дані в розширенні простого тексту очікуються в форматованому вигляді. Вибір шрифту та розміру залишається на розсуд декодера. Якщо трапляються символи меньше 0x20, або більше ніж 0xf7, рекомендовано, щоб декодер відображував символ проміжку (0x20). Кодувальник повинен використовувати сітку та розміри клітин, так, щоб чіле число клітин пасувало до розміру решітки горизонтально та вертикально. Для ширшої сумісності розміри клитин символів мають бути 8x8 або 8x16 (ширина x висота); розглядайте зображення як звичайний текст.


26. Розширення застосування. Версія 89a

Розширення застосування містить специфічну до зостовування інформацію; він відповідає синтаксису блока розширення, як описано нижче, та його мітка 0xFF.

      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       Вступ розширення             Байт
     +---------------+
  1  |               |       Extension Label              Байт
     +---------------+

     +---------------+
  0  |               |       Розмір блоку                 Байт
     +---------------+
  1  |               |
     +-             -+
  2  |               |
     +-             -+
  3  |               |       Ідентифікатор застосування   8 Байт
     +-             -+
  4  |               |
     +-             -+
  5  |               |
     +-             -+
  6  |               |
     +-             -+
  7  |               |
     +-             -+
  8  |               |
     +---------------+
  9  |               |
     +-             -+
 10  |               |       Код аутефінкації застосування  3 Байт
     +-             -+
 11  |               |
     +---------------+

     +===============+
     |               |
     |               |       Дані застосування              субблоки даних
     |               |
     |               |
     +===============+

     +---------------+
  0  |               |       Завершувач блоку               Байт
     +---------------+

Вступ розширення - вказує на початок блока розширення. Це поле містить фіксоване значення 0x21.

Мітка розширення застосування - ідентифікує блок як розширення застосування. Це поле містить фіксоване значення 0xFF.

Розмір блоку - число байт в цьому блоці розширення, що слідують за цім байтом, але не включаючи початок даних застосування. Це поле містить фіксоване значення 11.

Ідентифікатор застосування - послідовність друкованих ASCII символів, що використовуються для ідентифікації застосування, якому належить розширення.

Код аутентифікації застосування - послідовність з трьох байтів, що використовуються для аутентифікації ідентифікатора застосування. Програма застосування може використовувати алгоритм для обчислення двійникового кода, що унікально ідентифікує його, як застосування, якому належить розширення.

Цей блок не має меж дії. Цей блок не може бути модифікований розширенням.

27. Трейлер. Версія 87a

Цей блок є блоком з одного поля, ща вказує на кінець потоку даних GIF. Він містить фіксоване значення 0x3B.


      7 6 5 4 3 2 1 0        Ім'я поля                    Тип
     +---------------+
  0  |               |       GIF трейлер                   Байт
     +---------------+

Розширення та поле дії. Цей блок не має поля дії, він завершує потік даних GIF. Цей блок не може бути модифікований розширенням.

Додаток A. Таблиця для швидкого посилання.

Ім'я блоку                  	Потрібне   Мітка       Розш.  Верс.
<br>Розширення застосування     	Опц. (*)   0xFF (255)  yes    89a
Розширення коментаря        	Опц. (*)   0xFE (254)  yes    89a
Глобальна таблиця кольлорів 	Опц. (1)   none        no     87a
Розширення графічного контролю  Опц. (*)   0xF9 (249)  yes    89a
Заголовок                      	Req. (1)   none        no     N/A
Дескриптор зображення         	Опц. (*)   0x2C (044)  no     87a (89a)
Локальна таблиця кольорів       Опц. (*)   none        no     87a
Логічний дескриптор екрану   	Req. (1)   none        no     87a (89a)
Розширення простого тексту      Опц. (*)   0x01 (001)  yes    89a
Трейлер                     	Req. (1)   0x3B (059)  no     87a

Непомічені блоки<br><br>Заголовок                       Req. (1)   none        no     N/A
Логічний дескриптор зображення  Req. (1)   none        no     87a (89a)
Глобальна таблиця кольорів      Опц. (1)   none        no     87a
Локальна таблиця кольлорів      Опц. (*)   none        no     87a

Блоки малювання графіки<br><br>Розширення простого тексту      Опц. (*)   0x01 (001)  yes    89a
Дескриптор зображення           Опц. (*)   0x2C (044)  no     87a (89a)
<br>Конрольні блоки<br><br>Розширення графічного контролю  Опц. (*)   0xF9 (249)  yes    89a

Блоки спеціального призначення
<br>Трейлер                         Req. (1)   0x3B (059)  no     87a
Розширення коментаря            Опц. (*)   0xFE (254)  yes    89a
Розширення застосування         Опц. (*)   0xFF (255)  yes    89a

позначки:         (1)   якщо присутнє, щонайбільше одне входження
                  (*)   нуль або більше на потік
                  (+)   один або більше на потік

Зауваження : Заголовок не є предметом номерів версій. (89a) Логічний дескриптор екрана та дескриптор зображення зберігли свій синтаксис від версії 87a до версії 89a, але деякі поля зарезервовані у версії 87a, та використовуються в версії 89a.

Додаток B. Граматика GIF.

Граматика є формою запису для представлення послідовності, в якій певні об'єкти формують довші об'єкти. Граматика також використовується для представлення числа об'єктів, що можуть траплятись в певній позиції. Надана тут граматика представляє послідовність блоків, що формують потік даних GIF. Граматика надається через перелік правил. Кожне правило складається з лівой сторони, за якою іде якась форма знаку рівняння, за яким іде права сторона. В правилі права сторона описує, як визначаєтсья ліва сторона. Права сторона складаєтсья з послідовності сутностей, з можливою присутністю спеціальних символів. Наступні позначки визначають символи в цій граматиці для GIF.

Позначки:         &lt;&gt;    слово граматики
                  ::=   визначає символ
                  *     нуль або більше входжень
                  +     нуль або більше входжень
                  |     альтернативний елемент
                  []    опціональний елемент

Приклад:

&lt;Потік даних GIF&gt; ::= Заголовок &lt;Логічний екран&gt; &lt;Дані&gt;* Трейлер

Це правило визначає сутність &lt;Потік даних GIF&gt; наступним чином. Він має починатись з Заголовка. За Заголовком слідує сутність з назвою Логічний екран, що визначена нижче в іншому правилі. За Логічним екраном слідує сутність Дані, що також визначена нижче в іншому правилі. Нарешті, за сутністю Дані слідує Трейлер. Оскільки немає правила, що визначають Заголовок та Трейлер, це означає, що ці блоки визначені в документі. Сутність Дані має додатково специальний символ (*), що означає, що в цій позиції сутність Дані може бути представлена будь-яку кількість раз, включаючи 0 раз. Для подальшого читання по цьому предмету шукайте стандартні тексти по мавам програмування.

Граматика.

&lt;Потік даних GIF&gt; ::=     Заголовок &lt;Логічний екран&gt; &lt;Дані&gt;* Трейлер

&lt;Логічний екран&gt; ::=      Дескриптор лонічного екрана [Глобальна таблиця кольорів]

&lt;Дані&gt; ::=                &lt;Графічний блок&gt;  | &lt;Блок спеціального призначення&gt;

&lt;Графічний блок&gt; ::=       [Розширення графічного контролю] &lt;Блок відтворення графіки&gt;

&lt;Блок відтворення графіки&gt; ::=  &lt;Базована на таблиці графіка&gt;  | Розширення простого тексту

&lt;Базована на таблиці графіка&gt; ::=   Дескриптор зображення [Локальна таблиця кольорів] Дані зображення

&lt;Блок спеціального призначення&gt; ::=    Розширення застосування  |  Розширення коментаря<br><br>ЗАУВАЖЕННЯ : Граматика вказує, що можливо для Потоку даних GIF містити Заголовок, Логічний дескриптор екрана, Глобальну таблицю та Трейлер GIF. Цей особистий випадок використовується для завантаження декодера GIF Глобальною таблицею кольорів, в підготовці до слідуючих Потоків даних без таблиць кольлорів, взагалі.

Додаток C. Глосарій.

Активна таблиця кольорів - таблиця кольорів, що використовується для малювання наступної графіки. Якщо наступна графіка є зображення, що має Локальну таблицю кольорів, асоційовану з собою, активною таблицею кольорів стає Локальна таблиця кольорів, асоційована з цім зображенням. Якщо наступна графіка є зображення без Локальної таблиці кольорів, або це Розширення простого тексту, активною таблицею буде Глобальна таблиця кольорів в Потоці даних, або активною таблицею буде таблиця кольорів, збережена з попередніх Потоків даних, або така, що запроваджується декодером.

Блок - Колекція байтів, що формує одиницю протокола. Загалом, цей термін включає помічені та непомічені блоки, так само, як і Розширення.

Потік даних - Потік даних GIF складається з блоків та субблоків, що представляють зображення та графіку, разом з контрольною інформацією для її відображення на цифровому пристрої. Всі контрольні та блоки даних в Потоці даних повинні слідувати за Заголовком, та мають передувати Трейлеру.

Декодер - Програма, здатна обробляти Потік даних GIF відображувати зображення, та графіку, що міститься в ній.

Енкодер (кодувальник) - Програма, здатна захватувати та форматувати зображення та графічні растрові дані, слідуя визначенням Graphics Interchange Format.

Розширення - Блок протоколу, помічений байтом Вступ розширення 0x21.

Вступ розширення - Маркер (0x21), що визначає Розширення.

Графіка - Дані, які можуть бути намальовані на екрані через слідування деякому алгоритму. Термін графіка є дещо загальною, ніж термін зображення: на додаток до зображень, термін графіка також включає дані, такі як текст, що відображується з використанням символьних біт-мепів.

Зображення - Дані, що представляють картину або малюнок. Зображення представлений масивом пікселей, що називаєтсья растром зображення.<br><br>Растр - Масив зі значень пікселів, що представляють зображення.

Додаток D. Домовленості.

Анімація - Graphics Interchange Format не призначений як платформа для анімації, навіть хоча і може бути виконана в деякий обмежений спосіб.

Порядок байт - Коли не вказано інакше, мульти-байтні числові поля впорядковані в порядку, коли найменьш значущий байт іде першим.

Індекси кольорів - Індекси кольору завжди посилаються на активну таблицю колорів, або Глобальну таблицю кольлорів, або на Локальну таблицю кольорів.

Порядок кольорів - Коли не вказано інакше, всі три-компонентні значення кольорів RGB задаються в порядку Червоний-Зелений-Синій.

Таблиці кольлорів - Обоє таблиці кольорів, Глобальна та Локальна, є опціональними. Якщо присутня, Глобальна таблиця кольорів буде використовуватись для кожного зображення в Потоці даних, для якого не задана Локальна таблиця кольорів. Однак, якщо жодної таблиці не надано, програма застосування вільна використовувати довільну таблицю кольорів. Якщо графіка в декількох Потоках даних використовує ту саму таблицю кольорів, енкодер може помістити таблицю кольорів як Глобальну таблицю кольорів в першому Потоці даних, та залишити наступні Потоки даних без Глобальної таблиці кольорів, так само, як і Локальних таблиць кольорів. Таким чином, уникається навантиаження таблиці. Рекомендується, щоб декодер зберігав попередню Глобальну таблицю кольорів, щоб використовувати її в наступних Потоках даних, в випадку, якщо вона не містить ані Глобальної таблиці кольорів, ані Локальної таблиці кольорів. Загалом, це дозволяє програмі застосування використовувати останні таблиці кольорів, значно зменшивши навантаження на передачу.<br>
Блоки розширень - Розширення визначаються з використанням коду Вступ розширення, щоб позначити початок блоку, за яким іде мітка блоку, що ідентифікує розширення. Коди розширення є номерами в диапазоні від 0x00 до 0xFF, включно. Розширення особливого призначення є прозорими для декодера, та можуть бути пропущені при передачі Потоку даних оналйн. Діалог Можливості GIF може запропонувати для отримувача запитувати передачу всіх блоків; стан по замовчанню в цьому сенсі є відсутність передачі блоків спеціального призначення.

Зарезервовані поля - Всі зарезервовані поля очікуються як такі, де кожний біт встановлений в нуль (вимкнені).

Додаток E. Переміжені зображення.

Рядки в переміжених зображеннях організовані в наступному порядку:

      Група 1 : Кожний 8-й рядок, починаючи з рядка 0.              (Прохід 1)
      Група 2 : Кожний 8-й рядок, починаючи з рядка 4.              (Прохід 2)
      Група 3 : Кожний 4-й рядок, починаючи з рядка 2.              (Прохід 3)
      Група 4 : Кожний 2-й рядок, починаючи з рядка 1.              (Прохід 4)

Наступний приклад ілюструє, як впорядковані рядки переміженого зображення.

      Номер рядка                                     Прохід

 0    -----------------------------------------       1
 1    -----------------------------------------                         4
 2    -----------------------------------------                   3
 3    -----------------------------------------                         4
 4    -----------------------------------------             2
 5    -----------------------------------------                         4
 6    -----------------------------------------                   3
 7    -----------------------------------------                         4
 8    -----------------------------------------       1
 9    -----------------------------------------                         4
 10   -----------------------------------------                   3
 11   -----------------------------------------                         4
 12   -----------------------------------------             2
 13   -----------------------------------------                         4
 14   -----------------------------------------                   3
 15   -----------------------------------------                         4
 16   -----------------------------------------       1
 17   -----------------------------------------                         4
 18   -----------------------------------------                   3
 19   -----------------------------------------                         4

Додаток F. Компресія LZW зі змінною довжиною кода.

Компресія LZW зі змінною довжиною кода є варіацією алгоритма компресії Lempel-Ziv, в якому використовуються коди для заміни шаблонів, визначених в оригінальних даних. Алгоритм використовує таблицю кодів або трансляції, сконструйовану з шаблонів, знайдених в оригінальних даних; кожний новий шаблон вставляється в таблицю, та його індекс використовується для заміщення його в стиснутому потоці.

Компрессор приймає дані на вхідному потоці, та будує кодову таблицю, або таблицю транзакції, з шаблонами, по мірі того,як натрапляють на їх; кожний новий шаблон потрапляє в кодову таблицю, та його індекс додається в вихідний потік; коли трапляється шаблон, що був знайдений з часу останнього оновлення кодової таблиці, його індекс з кодової таблиці потрапляє в вихідний список, і, таким чином, досягається компресія даних. На боці розширення приймається потік зі стиснутих даних, та з них будується таблиця кодів або трансляції; по мірі обробки потоку компресованих даних, коди використовуються для індексування в кодовій таблиці, та відповідні дані покладаються в вихідний декомпресований потік, і так досягаючи декомпресію даних. Деталі алгоритму наведені далі. Аспект кодів змінною довжини цього алгоритму базується на початковому розмірі коду
(початковий розмір коду LZW), що вказує початкову кількість біт, що використовується для кодів компресії. Коли число шаблонів, визначених компресором у вхідному потоці перевищує число шаблонів з поточною кількістю біт, число біт на код LZW буде збільшений на одиницю.

Потік растрових даних, що презентує дійсний вивід, може бути представлений таким чином:

         7 6 5 4 3 2 1 0
        +---------------+
        |розмір коду LZW|
        +---------------+

        +---------------+ ----+
        |розмір блоку   |     |
        +---------------+     |
        |               |     +-- Повторюється так багато
        | байти даних   |     |   разів, як треба.
        |               |     |
        +---------------+ ----+

        . . .       . . . ------- Код що завершує компресовані дані LZW
                                  Завершувач блоку.
        +---------------+
        |0 0 0 0 0 0 0 0|  Завершувач блоку
        +---------------+

Перетворення зображення з послідовності значень пікселів до передаваних або збережених потоків символів включає декілька кроків. Скорочено ці кроки наступні:

1. Встановити розмір коду - Визначити кількість біт, потрібних для представлення дійсних даних.

2. Компресія даних - Компресія послідовності пікселів зображення в послідовність компресованих кодів.

3. Будування послідовності байт - Приймає набір кодів компресії, та конвертація до рядка 8-бітних байтів.

4. Package the Байт - Package sets of bytes into blocks preceded by character
counts and output.

ESTABLISH CODE SIZE

The first byte of the Compressed Data stream is a value indicating the minimum
number of bits required to represent the set of actual pixel values. Normally
this will be the same as the number of color bits. Because of some algorithmic
constraints however, black &amp; white images which have one color bit must be
indicated as having a code size of 2.
This code size value also implies that the compression codes must start out one
bit longer.

COMPRESSION

The LZW algorithm converts a series of data values into a series of codes which
may be raw values or a code designating a series of values. Using text
characters as an analogy, the output code consists of a character or a code
representing a string of characters.

The LZW algorithm used in GIF matches algorithmically with the standard LZW
algorithm with the following differences:

1.  A special Clear code is defined which resets all compression/decompression
parameters and tables to a start-up state. The value of this code is 2**&lt;code
size&gt;. For example if the code size indicated was 4 (image was 4 bits/pixel)
the Clear code value would be 16 (10000 binary). The Clear code can appear at
any point in the image data stream and therefore requires the LZW algorithm to
process succeeding codes as if a new data stream was starting. Encoders should
output a Clear code as the first code of each image data stream.

2. An End of Information code is defined that explicitly indicates the end of
the image data stream. LZW processing terminates when this code is encountered.
It must be the last code output by the encoder for an image. The value of this
code is &lt;Clear code&gt;+1.

3. The first available compression code value is &lt;Clear code&gt;+2.

4. The output codes are of variable length, starting at &lt;code size&gt;+1 bits per
code, up to 12 bits per code. This defines a maximum code value of 4095
(0xFFF). Whenever the LZW code value would exceed the current code length, the
code length is increased by one. The packing/unpacking of these codes must then
be altered to reflect the new code length.

BUILD 8-BIT BYTES

Because the LZW compression used for GIF creates a series of variable length
codes, of between 3 and 12 bits each, these codes must be reformed into a
series of 8-bit bytes that will be the characters actually stored or
transmitted. This provides additional compression of the image. The codes are
formed into a stream of bits as if they were packed right to left and then picked off 8 bits at a time to be output.

Assuming a character array of 8 bits per character and using 5 bit codes to be
packed, an example layout would be similar to:

     +---------------+
  0  |               |    bbbaaaaa
     +---------------+
  1  |               |    dcccccbb
     +---------------+
  2  |               |    eeeedddd
     +---------------+
  3  |               |    ggfffffe
     +---------------+
  4  |               |    hhhhhggg
     +---------------+
           . . .
     +---------------+
  N  |               |
     +---------------+


Note that the physical packing arrangement will change as the number of bits
per compression code change but the concept remains the same.

ПАКУВАННЯ БАЙТІВ

Once the bytes have been created, they are grouped into blocks for output by
preceding each block of 0 to 255 bytes with a character count byte. A block
with a zero byte count terminates the Raster Data stream for a given image.
These blocks are what are actually output for the GIF image. This block format
has the side effect of allowing a decoding program the ability to read past the
actual image data if necessary by reading block counts and then skipping over
the data.


ПОДАЛЬШЕ ЧИТАННЯ

[1] Ziv, J. and Lempel, A. : "A Universal Algorithm for Sequential Data
Compression", IEEE Transactions on Information Theory, May 1977.
[2] Welch, T. : "A Technique for High-Performance Data Compression", Computer,
June 1984.
[3] Nelson, M.R. : "LZW Data Compression", Dr. Dobb's Journal, October 1989.

Appendix G. On-line Capabilities Dialogue.

NOTE : This section is currently (10 July 1990) under revision; the information
provided here should be used as general guidelines. Code written based on this
information should be designed in a flexible way to accommodate any changes
resulting from the revisions.

The following sequences are defined for use in mediating control between a GIF
sender and GIF receiver over an interactive communications line. These
sequences do not apply to applications that involve downloading of static GIF
files and are not considered part of a GIF file.

GIF CAPABILITIES ENQUIRY

The GIF Capabilities Enquiry sequence is issued from a host and requests an
interactive GIF decoder to return a response message that defines the graphics
parameters for the decoder. This involves returning information about available
screen sizes, number of bits/color supported and the amount of color detail
supported. The escape sequence for the GIF Capabilities Enquiry is defined as:

ESC[&gt;0g           0x1B 0x5B 0x3E 0x30 0x67

GIF CAPABILITIES RESPONSE

The GIF Capabilities Response message is returned by an interactive GIF decoder
and defines the decoder's display capabilities for all graphics modes that are
supported by the software. Note that this can also include graphics printers as
well as a monitor screen. The general format of this message is:

#version;protocol{;dev, width, height, color-bits, color-res}...&lt;CR&gt;


'#'            GIF Capabilities Response identifier character.
version        GIF format version number;  initially '87a'.
protocol='0'   No end-to-end protocol supported by decoder Transfer as direct
               8-bit data stream.
protocol='1'   Can use CIS B+ error correction protocol to transfer GIF data
               interactively from the host directly to the display.
dev = '0'      Screen parameter set follows.
dev = '1'      Printer parameter set follows.
width          Maximum supported display width in pixels.
height         Maximum supported display height in pixels.
color-bits     Number of bits per pixel supported. The number of supported
               colors is therefore 2**color-bits.
color-res      Number of bits per color component supported in the hardware
               color palette. If color-res is '0' then no hardware palette
               table is available.

Note that all values in the GIF Capabilities Response are returned as ASCII
decimal numbers and the message is terminated by a Carriage Return character.

The following GIF Capabilities Response message describes three standard IBM PC
Enhanced Graphics Adapter configurations with no printer; the GIF data stream

can be processed within an error correcting protocol:

#87a;1;0,320,200,4,0;0,640,200,2,2;0,640,350,4,2&lt;CR&gt;

ENTER GIF GRAPHICS MODE

Two sequences are currently defined to invoke an interactive GIF decoder into
action. The only difference between them is that different output media are
selected. These sequences are:

ESC[&gt;1g     Display GIF image on screen

                  0x1B 0x5B 0x3E 0x31 0x67

ESC[&gt;2g   Display image directly to an attached graphics printer. The image may
optionally be displayed on the screen as well.

                  0x1B 0x5B 0x3E 0x32 0x67

Note that the 'g' character terminating each sequence is in lowercase.

INTERACTIVE ENVIRONMENT

The assumed environment for the transmission of GIF image data from an
interactive application is a full 8-bit data stream from host to micro.  All
256 character codes must be transferrable. The establishing of an 8-bit data
path for communications will normally be taken care of by the host application
programs. It is however up to the receiving communications programs supporting
GIF to be able to receive and pass on all 256 8-bit codes to the GIF decoder
software.</pre>
    <p></p>
  </body>
</html>
