:ascii-ids:
:doctype: book
:source-highlighter: pygments
:icons: font

= Vue 3: new & improved ~by ac2~

*Composition API*: Теперь можно напрямую импортировать и обращаться к `core` примитивам: создавать реактивные переменные через `ref`, `reactive`, `watch`, `computed`, напрямую устанавливать хуки и так далее. Для этого создан дополнительный хук `setup()`, который вызывается между `beforeCreate` и `created`. Три замечания: 
* Все эти возможности всегда были частью ядра Vue, и тепрь они просто стали публично доступны. 
* Vue 2 располагал плагином со статусом _technology preview_ для доступа к этим функциям.
* Данная технология _аддиктивная_. То есть ее можно использовать самостоятельно, совместно с традициоными опциями и ее можно вообще игнорировать. Важно помнить, что `setup()` вызывается до обработки опционных блоков. 

*Multi Root*: Теперь в шаблонах не обязательно указывать единый контейнерный тег, можно указывать несколько тегов. Мило, но не более.

*Suspense*: если компиляция шаблона предполагает асинхронную загрузку данных, то на время ожидания можно определить альтернативный шаблон `<template #fallback>`. Оба шаблона заключаются в контейнер `<Suspense>`. Технология позаимствована у React.js.

*Multipe V-models*: традиционно модели служат для двусторонней связи елементов формы и реактивных. Vue 3 позволяет подключить несколько моделей к кастомным компонентам: 

[source,html]
----
<survey-form v-model:name="name" v-model:age="age"> </survey-form>
...
<input :value="name" @input="updateName($event.target.value)" />
----

*Better Reactivity*: во Vue 3 поддерживается глубокая реактивность, которая не поддерживалась во Vue 2, а именно - добавление елемента к массиву, добавление елемента к объекту и удаление елемента из объекта. Раньше эти ситуации обрабатывались `vue.set()` и `vue.delete()`. Теперь эти события непосредственно вызывают `watch`.

*Global Mounting*: Vue 3 не использует глобальный екземпляр Vue, вместо этого используется метод `crateApp`. Это ограждает глобальный экземпляр от влияния плагинов и миксинов - теперь плагины устанавливаются в конкретный экхемпляр.

[source,html]
----
import { createApp } from 'vue'
import App from './App.vue'
const myApp = createApp(App)
myApp.use(/* plugin name */)
myApp.mount('#app')
----

*Portals*: известный плагин `portal-vue` стал частью ядра Vue. Часть кода компонента, заключенная в тег `<Teleport to="#modal-layer">`, будет отображаться в указаной локации.  