<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>BEP03</title>
  </head>
  <body> <sub style="margin: 1em 0px 0.1em; font-weight: normal; letter-spacing: -1px;">
      Переклад українською - <a href="mailto:ac2epsilon@gmail.com">Арсеній
        Чеботарьов</a> - Ніжин 2017</sub><br>
    <p> </p>
    <div id="header" style="margin: 0px; width: 700px; border-bottom: 2px solid rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 10px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;">
      <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;"><a
          href="http://bittorrent.org/index.html" style="color: rgb(102, 102, 102); text-decoration: none; border: 0px;">BitTorrent<span
            style="font-weight: bold; color: rgb(0, 153, 255);">.org <br>
          </span></a></h1>
      <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;"><a
          href="http://bittorrent.org/index.html" style="color: rgb(102, 102, 102); text-decoration: none; border: 0px;"><span
            style="font-weight: bold; color: rgb(0, 153, 255);">BEP03 The
            BitTorrent Protocol Specification<br>
          </span></a></h1>
    </div>
    <div id="second" style="color: rgb(51, 51, 51); font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 10px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;">
      <table class="docinfo" frame="void" rules="none" style="border: 0px; margin-left: 4em;">
        <colgroup><col class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;"><col
            class="docinfo-content"></colgroup>
        <tbody valign="top">
          <tr class="bep field">
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">BEP:</th>
            <td class="field-body" style="font-size: 9pt; padding: 10px;">3</td>
          </tr>
          <tr class="title field">
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Назва:</th>
            <td class="field-body" style="font-size: 9pt; padding: 10px;">The
              BitTorrent Protocol Specification</td>
          </tr>
          <tr>
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Версія:</th>
            <td style="font-size: 9pt; padding: 10px;">0e08ddf84d8d3bf101cdf897fc312f2774588c9e</td>
          </tr>
          <tr class="last-modified field">
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Останні
              зміни:</th>
            <td class="field-body" style="font-size: 9pt; padding: 10px;">Sat
              Feb 4 12:58:40 2017 +0100</td>
          </tr>
          <tr>
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Автор:</th>
            <td style="font-size: 9pt; padding: 10px;">Bram Cohen &lt;<a class="reference external"
                href="mailto:bram%40bittorrent.com" style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">bram<span>@</span>bittorrent<span>.</span>com</a>&gt;</td>
          </tr>
          <tr>
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Статус:</th>
            <td style="font-size: 9pt; padding: 10px;">Final</td>
          </tr>
          <tr class="type field">
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Тип:</th>
            <td class="field-body" style="font-size: 9pt; padding: 10px;">Стандартний</td>
          </tr>
          <tr class="created field">
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Створено:</th>
            <td class="field-body" style="font-size: 9pt; padding: 10px;">10-Jan-2008</td>
          </tr>
          <tr class="post-history field">
            <th class="docinfo-name" style="margin: 0px; font-size: 1.2em; text-align: right; vertical-align: middle;">Історія:</th>
            <td class="field-body" style="font-size: 9pt; padding: 10px;">24-Jun-2009
              (<a class="reference external" href="mailto:arvid%40bittorrent.com"
                style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">arvid<span>@</span>bittorrent<span>.</span>com</a>),
              прояснено кодування рядків в торент файлах. 20-Oct-2012 (<a class="reference external"
                href="mailto:arvid%40bittorrent.com" style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">arvid<span>@</span>bittorrent<span>.</span>com</a>),
              прояснено, що інфор-хеш є дайджестом b-енкодінгу&nbsp; файла
              .torrent. Додані на деякі нові BEP та покращене форматування.
              11-Oct-2013 (<a class="reference external" href="mailto:arvid%40bittorrent.com"
                style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">arvid<span>@</span>bittorrent<span>.</span>com</a>),
              скореговано прийнятий та де-факто розміри для повідомлень запитів
              04-Feb-2017 (<a class="reference external" href="mailto:the8472.bep%40infinite-source.de"
                style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">the8472<span>.</span>bep<span>@</span>infinite-source<span>.</span>de</a>),
              подальше роз'яснення інфо-хешу, додані ресурси для нових
              реалізаторів</td>
          </tr>
        </tbody>
      </table>
      <p style="font-size: 1.3em; line-height: 1.5em;">BitTorrent - це протокол
        для обміну файлами. Він ідентифікує вміст по URL, та розроблений для
        безпроблемної інтеграції з веб. Його перевага над HTTP в тому, що
        декілька завантажень того самого файла відбуваєтсья одночасно,
        завантажувачі відвантажують всім іншим, що дозволяє для джерела файла
        підтримувати дуже великі числа завантажувачів, тільки з поміркованим
        збільшенням навантаження.</p>
      <div class="section" id="a-bittorrent-file-distribution-consists-of-these-entities">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Дистриб'юція
          файла BitTorrent складається з таких сутностей:</h1>
        <ul class="simple">
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Звичайний
            веб сервер</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Статичний
            файл 'metainfo'</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Трекер
            BitTorrent</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Оригінальний
            'original' завантажувач</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Веб
            браузери кінцевого користувача</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Завантажувачі
            кінцевого користувача</li>
        </ul>
        <p style="font-size: 1.3em; line-height: 1.5em;">В ідеалі існує багато
          кінцевих користувачів для єдиного файла.</p>
      </div>
      <div class="section" id="to-start-serving-a-host-goes-through-the-following-steps">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Щоб
          почати обслуговування, вузол проходить через такі кроки:</h1>
        <ol class="arabic simple">
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Почати
            виконувати трекер (або, більш вірогідно, мати вже запущений).</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Почати
            виконувати звичайний веб сервер, такий як apache, або мати вже
            готовий.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Асоціювати
            розширення .torrent з mimetype application/x-bittorrent на своєму
            веб сервері (або вже мати це зробленим).</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Згенерувати
            файл metainfo (.torrent) використовуючи завершений файл, що буде
            обслуговуватись, та URL трекера.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Покласти
            файл metainfo на веб сервер.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Зв'язати
            файл metainfo (.torrent) з якоїсь іншої веб сторінки.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Запустити
            завантажувач, що вже має повний файл (джерело, 'origin').</li>
        </ol>
      </div>
      <div class="section" id="to-start-downloading-a-user-does-the-following">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Щоб
          почати завантаження, користувач робить наступне:</h1>
        <ol class="arabic simple">
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Встановлює
            BitTorrent (або вже має готовий).</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Серфує
            в мережі.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Клацає
            посилання на .torrent.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Обирає,
            де зберігти файл локально, або обирає часткове завантаження для
            продовження.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Очікує
            завершення завантаження.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Наказати
            завантажувачу завершитись (той буде роздавати файл, доки його не
            зупинять).</li>
        </ol>
      </div>
      <div class="section" id="bencoding">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">bencoding</h1>
        <ul class="simple">
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Рядки
            мають префікс довжини по основі 10, двокрапку та сам рядок.
            Наприклад<span> </span><tt class="docutils literal">4:spam</tt><span>
              відповідає до</span> 'spam'.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Цілі
            представлені як 'i', далі число по основі 10, та за ним 'e'.
            Наприклад, <span></span><tt class="docutils literal">i3e</tt>
            відповідає до 3, та<span> </span><tt class="docutils literal"><span
                class="pre">i-3e</span></tt><span> відповідає до</span> -3. Цілі
            не мають обмежень розміру. <span></span><tt class="docutils literal"><span
                class="pre">i-0e</span></tt><span> невалідне</span>. Всі
            кодування з ведучим нулем, як <span></span><tt class="docutils literal">i03e</tt>,
            невалідні, крім <span></span><tt class="docutils literal">i0e</tt>,
            що, звичайно, відповідає до 0.</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Списки
            кодуються як 'l', за яким ідуть елементи (також bencoded), за якими
            іде 'e'. Наприклад,&nbsp;<span> </span><tt class="docutils literal">l4:spam4:eggse</tt><span>
            </span>відповідає до ['spam', 'eggs'].</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">Словники
            кодуються як 'd', за яким іде список переміжених ключів та
            відповідних значень, за якими іде 'e'. Наприклад, <span></span><tt
              class="docutils literal">d3:cow3:moo4:spam4:eggse</tt><span>
              відповідає до</span> {'cow': 'moo', 'spam': 'eggs'}, та <span></span><tt
              class="docutils literal">d4:spaml1:a1:bee</tt><span> відповідає до</span>
            {'spam': ['a', 'b']}. Ключі мають бути рядками, та іти в
            відсортованому порядку (сортування як сирих рядків, не алфавітно).</li>
        </ul>
      </div>
      <div class="section" id="metainfo-files">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Файли
          metainfo</h1>
        <p style="font-size: 1.3em; line-height: 1.5em;">Metainfo файли (також
          відомі як .torrent файли) є бінкодовані словники з наступними ключами:</p>
        <dl class="docutils">
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;"><strong>announce</strong></dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">URL
            трекера.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;"><strong>info</strong></dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Відображується
            на словник, ключі якого описані нижче.</dd>
        </dl>
        <p style="font-size: 1.3em; line-height: 1.5em;">Всі рядки в .torrent
          файлі, що містять текст, мають бути закодовані в UTF-8.</p>
        <div class="section" id="info-dictionary">
          <h2 style="margin: 0px; padding: 0px 0px 0.5em; font-size: 1.6em; font-weight: normal; border: 0px;">словник
            info</h2>
          <p style="font-size: 1.3em; line-height: 1.5em;">Ключ <strong><span></span><tt
                class="docutils literal">name</tt></strong><span> посилається на
            </span>UTF-8 кодований рядок, що є підказкою назви збереженого файла
            (або директорії). Це суцільна рекомендація.</p>
          <p style="font-size: 1.3em; line-height: 1.5em;"><strong><tt class="docutils literal">piece
                length</tt></strong><span> відображує кількість байтів в кожному
              шматку файла, на які він поділений</span>. Для цілей передачі
            файли поділяються на частини фіксованої довжини, що мають ту саму
            довжину, окрім, можливо, останнього, що може бути усічений. <strong><span></span><tt
                class="docutils literal">piece length</tt></strong><span> </span>майже
            завжди ступінь двох, більш загально 2** 18 = 256 K (BitTorrent до
            версії 3.2 використовує 2** 20 = 1 M по замовчанню).</p>
          <p style="font-size: 1.3em; line-height: 1.5em;"><strong><tt class="docutils literal">pieces</tt></strong><span>
              відображується на рядок, чия довжина є кратною </span>20. Коли
            його розбити на рядки довжиною 20 байт, кожний буде хешем SHA1
            частини з відповідним індексом.</p>
          <p style="font-size: 1.3em; line-height: 1.5em;">Також є ключі <strong><span></span><tt
                class="docutils literal">length</tt></strong><span> та</span><span>
            </span><strong><tt class="docutils literal">files</tt></strong>, але
            не обоє або ні одного. Якщо присутній <strong><span></span><tt class="docutils literal">length</tt></strong><span>,
              тоді завантаження представляє один файл, інакше це набір файлів,
              що ідуть як структура директорій.</span></p>
          <p style="font-size: 1.3em; line-height: 1.5em;">В випадку одного
            файла <span></span><strong><tt class="docutils literal">length</tt></strong><span>
              вказує на довжину файла в байтах</span>.</p>
          <p style="font-size: 1.3em; line-height: 1.5em;">Для цілей інших
            ключів, випадок багатьох файлів розглядається як тільки один файл,
            через конкатенацію файлів в порядку, як вони з'являються в списку
            файлів. Список файлів є значення <strong><span></span><tt class="docutils literal">files</tt></strong><span>
              - це список словників, що містять наступні ключі</span>:</p>
          <p style="font-size: 1.3em; line-height: 1.5em;"><strong><tt class="docutils literal">length</tt></strong><span>&nbsp;</span>-
            довжина файла в байтах.</p>
          <p style="font-size: 1.3em; line-height: 1.5em;"><strong><tt class="docutils literal">path</tt></strong><span>&nbsp;</span>-
            список рядків UTF-8, що відповідає іменам субдиректорій, та останній
            є дійсним іменем файла (список нульової довжини є помилковим
            випадком).</p>
          <p style="font-size: 1.3em; line-height: 1.5em;">В випадку одного
            файлу, ключ <strong>name</strong> є іменем файла, в випадку
            декількох він є назвою каталога.</p>
        </div>
      </div>
      <div class="section" id="trackers">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Трекери</h1>
        <p style="font-size: 1.3em; line-height: 1.5em;">Запити трекера GET
          мають наступні ключі:</p>
        <dl class="docutils">
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">info_hash</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">
            <p class="first" style="font-size: inherit; line-height: inherit;">20
              байтів sha1 хеш в формі bencoded значення info з файла metainfo.
              Це значення майже напевне має бути виключене.</p>
            <p class="last" style="font-size: inherit; line-height: inherit;">Зауважте,
              що це субрядок файла metainfo. info-hash має бути хешем
              закодованої форми, як вона є в файлі&nbsp; .torrent, що ідентично
              до bdecoding файла metainfo, виділення словника info, та
              закодування його, <em>якщо </em>та <em>тільки якщо </em>bdecoder
              повністю перевірив вхід (порядок ключів, відсутність початкових
              нулів. І навпаки, це означає, що клієнт має або відхиляти
              невалідні файли metainfo, або виділяти субрядок напряму. Вони не
              мають виконувати цикл декодування-закодування на невалідних даних.</p>
          </dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">peer_id</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Рядок
            довжиною 20, яку цей завантажувач використовує як власний. Кожний
            завантажувач генерує свій власний id випадково напочатку нового
            завантаження. Це значення також буде майже напевне виключене.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">ip</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Опціональний
            параметр, надаючий IP (або ім'я dns) для даного вузла. Загалом
            використовується для джерела, якщо воно на тій же машині, що і
            трекер.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">port</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Номер
            порта, на якому слухає цей вузол. Загальна поведінка для
            завантажувача спробувати слухати на порті 6881, та якщо він зайнятий
            спробувати 6882, потім 6883, тощо. Та здатись після 6889.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">uploaded</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Загальна
            кількість відданого, закодована в ascii по основі 10.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">downloaded</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Загальна
            кількість завантаженого, закодована в ascii по основі 10.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">left</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Число
            байт, що цей вузол залишилось завантажити, закодовано в&nbsp; ascii
            по основі 10. Зауважте, що це не може бути обчислено з завантаженого
            та довжини файла, оскільки це може бути відновлення, та є шанс, що
            деякі з завантажених даних не пройшли тест на цілісність, та мають
            бути перезавантажені.</dd>
          <dt style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">event</dt>
          <dd style="margin-bottom: 7px; font-size: 1.2em; line-height: 1.5em;">Це
            опціональний ключ, що відображається на <span></span><tt class="docutils literal">started</tt>,<span>&nbsp;</span><tt
              class="docutils literal">completed</tt>, або<span> </span><tt class="docutils literal">stopped</tt><span>&nbsp;</span>(або<span>
            </span><tt class="docutils literal">empty</tt>, що те саме, що ключ
            відсутній). Якщо ключ відсутній, це один з анонсів, зроблених через
            регулярні інтервали. Анонс з використанням <span></span><tt class="docutils literal">started</tt><span>
              надсилається, коли завантаження тільки починається, та </span><span></span><tt
              class="docutils literal">completed</tt><span> надсилається, коли
              завантаження завершено. </span><span></span><tt class="docutils literal">completed</tt><span>
              не надсилається, якщо файл був завершений, коли </span>started.
            Завантажувачі надсилають анонс з <span></span><tt class="docutils literal">stopped</tt><span>,
              коли вони прозупиняють завантаження</span>.</dd>
        </dl>
        <p style="font-size: 1.3em; line-height: 1.5em;">Трекер відповідає&nbsp;
          в вигляді словників bencoded. Якщо відповідь трекера має ключ <strong><span></span><tt
              class="docutils literal">failure reason</tt></strong>, тоді це
          читаємий людиною рядок, що пояснює, чому запит схибив, та інші ключі
          не потрібні. Інакше мають бути два ключа: <strong><span></span><tt class="docutils literal">interval</tt></strong>,
          що вказує число секунд, які завантажувач повинен зачекати між
          звичайними запитами, та <strong><span></span><tt class="docutils literal">peers</tt></strong>.<span>&nbsp;</span><strong><tt
              class="docutils literal">peers</tt></strong><span> </span>це
          список словників, що відповідає вузлам, кожний з яких містить <tt class="docutils literal"><strong>id</strong>
            вузла</tt>,<span>&nbsp;</span><strong><tt class="docutils literal">ip</tt></strong>,
          та <strong><tt class="docutils literal">port</tt></strong>, що
          позначає відповідний само-призначений id вузла, його IP або dns ім'я
          та порт. Зауважте, що завантажувачі можуть запитати в незаплановані
          моменти, якщо трапляється подія або вони потребують більше вузлів.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Більш загальна ситуація
          коли трекери повертають компактну репрезентацію списка вузлів, дивітья<span>
          </span><a class="reference external" href="http://bittorrent.org/beps/bep_0023.html"
            style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">BEP
            23</a>.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Якщо ви бажаєте зробити
          якісь розширення до файлів metainfo або запитів трекера, будь ласка
          координуйтесь з Bram Cohen, щоб переконатись, що всі розширення
          виконані сумісно.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Також загально робити
          анонси через <span></span><a class="reference external" href="http://bittorrent.org/beps/bep_0015.html"
            style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">трекерний
            протокол UDP</a>.</p>
      </div>
      <div class="section" id="peer-protocol">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Протокол
          вузла</h1>
        <p style="font-size: 1.3em; line-height: 1.5em;">Протокол вузла
          BitTorrent робить через TCP or<span>&nbsp;</span><a class="reference external"
            href="http://bittorrent.org/beps/bep_0029.html" style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">uTP</a>.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">З'єднання вузлів
          симетричні. Повідомлення, що надсилаються в обох напрямках, виглядають
          однаково, та дані можуть рухатись в любому напрямку.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Протокол вузла
          посилається на частини файла по індексу, як описано в файлі metainfo,
          починаючи з нуля. Коли вузол завершує отримання частини, та перевіряє,
          що хеш співпадає, він анонсує що має цю частину всім відомим вузлам.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Зʼєднання мають два
          біта стану на кожному кінці: блокований чи ні, та зацікавлений чи ні.
          Блокування це нотифікація, що дані не будуть надіслані, доки цей режим
          не буде відмінено. Причини та загальні прийоми щодо блокування будуть
          пояснені пізніше в цьому документі.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Передача даних
          відбувається, коли одна сторона зацікавлена, та інша не блокує
          передачу. Стан зацікавленості має зберігатись оновленим весь час -
          коли завантажувач не має дечого, про що вони могли би запитати в
          неблокованому стані, вони мають виявляти відсутність зацікавленості,
          навіть якщо зв'язок блокований. Реалізація цієї властивості хитра, але
          це дає можливість завантажувачам знати, який вузол почне завантажежння
          безпосередньо, коли не буде блокований.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Зʼєднання
          розпочинаються блокованими та незацікавленими.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Коли передаються дані,
          завантажувачі мають підтримувати декілька запитів до частин одночасно,
          щоб отримати гарну продуктивність TCP (це називається
          'конвеєризація'). З іншого боку, запити, що не можуть бути
          безпосередньо записані в буфер TCP, мають утримувати їх у пам'яті, ніж
          в мережевому буфері рівня застосування, так що всі воні можуть бути
          відкинуті, коли трапиться блокування.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Дротовий протокол вузла
          складається з потискання, за чим слідує нескінчений потік повідомлень
          з префіксами розміру. Потискання починається з символа 19
          (десятичного), за яким слідує рядок 'BitTorrent protocol'. Цей символ
          є префіксом довжини, покладений тут в надії, що інші новіші протоколи
          можуть робити те саме, і, таким чином, стане тривіальним відрізняти
          формати один від одного. </p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Всі подальші цілі що
          надсилаються протоколом, закодовані як чотирибайтні big-endian.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Після зафіксованих
          заголовків ідуть вісім зареєстрованих байт, що будуть нуль в усіх
          поточних реалізаціях. Якщо ви бажаєте розширити протокол,
          використовуючи ці байти, будь ласка, координуйтесь з Bram Cohen, щоб
          переконатись, що всі розширення зроблені сумісно.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Далі іде 20 байтів хешу
          sha1 bencoded форми значення info з файла metainfo. (Це те саме
          значення, що анонсоване як <span></span><tt class="docutils literal">info_hash</tt><span>
          </span>до трекера, тільки тут воно силе, замість квотованого). Якщо
          обі сторони не надсилають те саме значення, вони роз'єднують
          з'єднання. Одне можливе виключення це коли завантажувач бажає робити
          декілька завентажень по однму порту, вони можуть очікувати для вхідних
          з'єднать, щоб спочатку отримати хеш завантаження, та відповісти з тим
          самим, якщо він є в списку. </p>
        <p style="font-size: 1.3em; line-height: 1.5em;">За хешем завантаження
          іде 20-байтовий id вузла, що повідомляється в запиті трекера, та
          зберігається в списку відповіді трекера. Якщо id вузла отримуючої
          сторони не співпадає з тим, який очікує&nbsp; ініціююча сторона,
          ініціатор розриває з'єднання.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Ось і все щодо
          потискання, далі іде з переміжного потоку з префіксів довжини та
          повідомлень. Повідомлення нульової довжини є keepalive, та
          ігноруються. Keepalive загалом надсилаються кожні дві хвалини, але
          зауважте, що таймаути можуть бути зроблені значно більш швидко, коли
          очікуються дані.</p>
      </div>
      <div class="section" id="peer-messages">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Повідомлення
          вузлів</h1>
        <p style="font-size: 1.3em; line-height: 1.5em;">Всі не-keepalive
          повідомлення починаються з одного байта, що означає їх тип.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Можливі значення:</p>
        <ul class="simple">
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">0 -
            choke (блокування)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">1 -
            unchoke (неблокування)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">2 -
            interested (зацікавлений)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">3 -
            not interested (незацікавлений)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">4 -
            have (маю)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">5 -
            bitfield (бітове поле)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">6 -
            request (запит)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">7 -
            piece (шматок)</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">8 -
            cancel (відміна)</li>
        </ul>
        <p style="font-size: 1.3em; line-height: 1.5em;">'choke', 'unchoke',
          'interested', та 'not interested' не мають навантаження.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">'bitfield' надсилається
          тільки раз як перше повідомлення. Його навантаження є бітове поле з
          кожним індексом, що завантажувач отримав, встановленим в 1, та ініші
          встановлені в . Завантажувачі, що нічого ще не мають, можуть
          пропустити повідомлення 'bitfield'. Перший байт поля bitfield
          відповідає індексам 0 - 7 зі старшого біта до молодшого відновідно,
          наступний 8-15, тощо. Зайві біти в кінці встановлені в нуль.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Навантаження
          повідомлень 'have' є одне число, індекс, який завантажувач тільки що
          завершив, та перевірив його хеш.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Повідомлення 'request'
          містять індекс, початок та довжину. Останні двоє є зміщення байт.
          Довжина загалом є ступінь двох, тільки якщо вона не усічена наприкинці
          файла. Всі поточні реалізації використовують 2^14 (16 Кб), та
          закривають з'єднання, що запитують більше ніж це.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Повідомлення 'cancel'
          мають те саме навантаження, що і повідомлення запитів. В основному
          вони надсилаються перед кінцем завантаження, під час того, що
          називається 'режим завершенян гри'. Коли завантаження майже завершене,
          є схильність для декількох останніх часток завантажуватись з однієї
          підмоченої модемної лінії, забираючи багато часу. Щоб переконатись, що
          декілька останніх шматків надходять швидко, як тільки запити на всі
          частини, які завантажувач ще не має, наразі підвисають, він розсилає
          запити на все до всіх, у кого він завантажує. Щоб не робити це
          страшенно неефективним, він надсилає відміни до кожного іншого, як
          тільки фрагмент надходить.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Повідомлення 'piece'
          містять індекс, початок та частку. Зауважте, що вони корелюють з
          повідомленнями запитів неявно. Можливо отримання неочікуваної частини,
          якщо повідодмлення блокування та розблокування надіслані в тісний
          проміжок, або коли передача іде дуже повільно.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Завантажувачі загалом
          завантажують частини в випадковому порядку, що робить досить гарну
          роботу по утриманню від зберігання стійкої підмножини або супермножини
          частин любого з вузлів.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Блокування зроблене з
          декількох причин. Контроль скуачення TCP робить дуже погано, коли
          надсилання іде через багато з'єднань одночасно. Також блокування
          дозволяє кожному вузлу використовувати алгоритм щось-за-дещо, щоб
          переконатись, що вони отримують узгоджену швидкість завантаження.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Описаний нижче алгоритм
          є наразі розгорнутим. Це дуже важливо, щоб нові алгоритми гарно робили
          обоє, в мережах, що складаються повністю з таких самих, та в мережах,
          що складаються здебільшого з таких.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Існує декілька
          критерій, яким має задовільняти гарний алгоритм блокування. Він має
          обмежувати число одночасних завантажень для гарної TCP продуктивності.
          Він має уникати блокування та розблокування швидко, що відоме як
          'фібріляція'. Він має бути взаємним з вузлами, що дозволяють
          завантаження. Нарешті, алгоритм має спробувати невикористані
          з'єднання, щоб з'ясувати, чи можливо вони кращі, ніж ті, що
          використовуються, що відоме як оптимістичне розблокування.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">Наразі розгорнутий
          алгоритм блокування уникає фібріляції, змінюючи стан хто блокований
          раз на десять секунд. Він робить дію у відповідь та обмежує число
          віддач, розблокуючи чотири вузла, що мають найкращі швидкості
          reciprocation and number of uploads capping by unchoking the four
          peers which it has the best download rates from and are interested.
          Peers which have a better upload rate but aren't interested get
          unchoked and if they become interested the worst uploader gets choked.
          If a downloader has a complete file, it uses its upload rate rather
          than its download rate to decide who to unchoke.</p>
        <p style="font-size: 1.3em; line-height: 1.5em;">For optimistic
          unchoking, at any one time there is a single peer which is unchoked
          regardless of its upload rate (if interested, it counts as one of the
          four allowed downloaders.) Which peer is optimistically unchoked
          rotates every 30 seconds. To give them a decent chance of getting a
          complete piece to upload, new connections are three times as likely to
          start as the current optimistic unchoke as anywhere else in the
          rotation.</p>
      </div>
      <div class="section" id="resources">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Ресурси</h1>
        <ul class="simple">
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;"><a
              class="reference external" href="http://bittorrent.org/bittorrentecon.pdf"
              style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">Економіка
              BitTorrent</a><span> </span>описує деякі алгоритми запитів та
            блокування, які має реалізувати клієнт для оптимальної
            продуктивності</li>
          <li style="margin: 0.4em 0px; font-size: 10pt; line-height: 12pt;">При
            розробці для зневадження та порівняння може стати в нагоді нова
            реалізація аналізатора&nbsp; протоколів Wireshark та його <span></span><a
              class="reference external" href="https://wiki.wireshark.org/BitTorrent"
              style="color: rgb(102, 119, 136); text-decoration: none; border-bottom: 1px dotted rgb(102, 119, 136);">дисектори
              для bittorrent</a>.</li>
        </ul>
      </div>
      <div class="section" id="copyright">
        <h1 style="margin: 1em 0px 0.1em; font-size: 2em; font-weight: normal; letter-spacing: -1px;">Copyright</h1>
        <p style="font-size: 1.3em; line-height: 1.5em;">Цей документ був
          розміщений в публічному домені.</p>
      </div>
    </div>
    <br class="Apple-interchange-newline">
    <p></p>
  </body>
</html>
