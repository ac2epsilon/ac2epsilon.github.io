<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>TensorFlow and MNIST</title>
  </head>
  <body> <sub> Переклад українською - <a href="mailto:ac2epsilon@gmail.com">Арсеній
        Чеботарьов</a> - Ніжин 2017 </sub> <br>
    <p> </p>
    <h1 itemprop="name" class="devsite-page-title" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: #757575; font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto,sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; text-decoration-style: initial; text-decoration-color: initial;">TensorFlow
      та MNIST</h1>
    <h1 itemprop="name" class="devsite-page-title" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: rgb(117, 117, 117); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Починаємо</h1>
    <div class="devsite-article-body clearfix
            " itemprop="articleBody" style="box-sizing: inherit; margin: 0px; padding: 0px; color: rgb(33, 33, 33); font-family: Roboto, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
      <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Для
        короткого огляду фундаментального програмування TensorFlow, дивіться
        наступний розділ:</p>
      <ul style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;">
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/get_started"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Починаємо
            з TensorFlow</a></li>
      </ul>
      <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">MNIST став
        канонічним набором даних для перевірки нових тулкітів машинного
        навчання. Ми надаємо три керівництва, кожне демострує різний підхід до
        тренування моделі MNIST на TensorFlow:</p>
      <ul style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;">
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/mnist/beginners"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">MNIST
            для ML початківців</a>, що вводить до MNIST через високорівневе API.</li>
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/mnist/pros"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Поглиблений
            MNIST для експертів</a>, що більш заглиблений ніж "MNIST для ML
          початківців", та припускає знайомство з концепціями машинного
          навчання.</li>
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/mnist/mechanics"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorFlow
            механіка 101</a>, що вводить до MNIST через низькорівневе API.</li>
      </ul>
      <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Для
        розробників, що нові до TensorFlow, високорівневе API є ґарною
        початковою точкою. Щоб ознайомитись з високорівневим API прочитайте
        наступні керівництва:</p>
      <ul style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;">
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/tflearn"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">tf.contrib.learn
            Quickstart</a>, що є вступом до цього API.</li>
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/input_fn"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Побудова
            вхідних функцїй за допомогою tf.contrib.learn</a>, що забирає вас до
          дещо складнішого використання цього API.</li>
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/monitors"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Основи
            журналювання та моніторінгу tf.contrib.learn</a>, що пояснює, як
          здійснювати аудит в процессі тренування моделі.</li>
      </ul>
      <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorBoard
є
        утілітою для візуалізації різних аспектів машинного навчання. Наступні
        керівництва пояснюють, як користуватись TensorBoard:</p>
      <ul style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;">
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/summaries_and_tensorboard"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorBoard:
            візуалізація навчання</a>, що дає вам початкові навички.</li>
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/embedding_viz"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorBoard:
вбудована
            візуалізація</a>, що демонструє, як переглядати та взаємодіяти з
          високо-розмірними даними, такими як embeddings.</li>
        <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><a href="https://www.tensorflow.org/get_started/graph_viz"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorBoard:
візуалізація
            графів</a>, що пояснює, як візуалізувати граф обчислення.
          Візуалізаця графів типово більш корисна для програмістів з
          використанням низькорівневого API.</li>
      </ul>
      <p> </p>
      <h1 itemprop="name" class="devsite-page-title" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: rgb(117, 117, 117); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Починаємо
        з TensorFlow</h1>
      <div class="devsite-article-body clearfix
            " itemprop="articleBody" style="box-sizing: inherit; margin: 0px; padding: 0px; color: rgb(33, 33, 33); font-family: Roboto, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
        <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ця
          інструкція надає вам основи програмування в TensorFlow. Перед
          використанням цього керівництва,<span> встановіть</span><a href="https://www.tensorflow.org/install/index"
            style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">
            TensorFlow</a>. Щоб отримати більше від цієї інструкції, ви повинні
          знати наступне:</p>
        <ul style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;">
          <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">Як
            програмувати на Python.</li>
          <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">Щонайменьше
            дещо знати про масиви.</li>
          <li style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">В
            ідеалі дещо знати про машинне навчання. Однак якщо ви нічого або
            мало знаєте щодо машинного навчання, тоді це все одно перше
            керівництво, що ви маєти прочитати. </li>
        </ul>
        <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow
провадить
          декілька API. Найнижчий рівень, API, TensorFlow Core, провадить вас
          повний програмний контроль. Ми рекомендуємо TensorFlow Core для
          дослідників машинного навчання, та інших, хто потребує гарний рівень
          контроля над своїми моделями. Вищий рівень API побудований зверху
          TensorFlow Core. Цей високорівневий рівень API типово простіші для
          навчання та використання, ніж TensorFlow Core. На додаток, вищий
          рівень API робить повторювані завдання простішими та більш узгодженими
          між різними користувачами. Високорівневий API, як tf.contrib.learn,
          допомагають вам впоратись з наборами даних, очікуваннями, тренуванням
          та виводом. Зауважте, що є декілька високорівневих TensorFlow API,
          імена методів яких містять&nbsp;<span></span><code style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">contrib</code>,
          що все ще під розробкою. Можливо, що деякі методи з&nbsp;<span></span><code
            style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">contrib</code><span>
            будуть змінені або стануть неактуальними в наступних випусках</span>
          TensorFlow.</p>
        <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ця
          інструкція починається з керівництва по TensorFlow Core. Пізніше ми
          продемонструємо, як реалізувати ту ж модель в tf.contrib.learn. Знання
          принципів TensorFlow Core надасть вам чудову ментальну модель того, як
          робляться справи, коли ви використовуєте більш компактний
          високорівневий API.</p>
        <h1 class="page-title" id="tensors" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: rgb(117, 117, 117); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px;">Тензори</h1>
        <p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Центральною
          одиницею даних в TensorFlow є<span> </span><strong style="box-sizing: inherit; font-weight: bold;">тензор</strong>.
          Тензор складається з набору примітивних значень, розташованих в масиві
          з довільним числом розмірностей. <strong>Рангом </strong>тензора
          називають кількість його вимірів. Ось декілька прикладів тензорів:</p>
        <pre class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># тензор рангу 0; це скаляр з розмірнісю []</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">,</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># тензор рангу 1; це вектор з розмірністю [3]</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="pun" style="box-sizing: inherit;">[[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">6.</span><span
class="pun" style="box-sizing: inherit;">]]</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># тензор рангу 2; матриця з розмірністю [2, 3]</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="pun" style="box-sizing: inherit;">[[[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">]],</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">8.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">9.</span><span
class="pun" style="box-sizing: inherit;">]]]</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># тензор рангу 3 з розмірністю [2, 1, 3]</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><h2
id="tensorflow_core_tutorial" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Інструкция з TensorFlow Core</h2><h3
id="importing_tensorflow" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 0px 0px 16px;">Імпортування TensorFlow</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Канонічна форма імпорту для програм на базі TensorFlow наступна:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> tensorflow </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> tf<br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Це дає доступ з Python до всіх класів, методів та символів TensorFlow. Більшість документації припускає, що ви вже зробили це.&nbsp;</p><h3
id="the_computational_graph" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Граф обчислень</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ви можете думати про програми TensorFlow Core як про дві дискретні дії:</p><ol
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: decimal outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">Побудова графу обчислень.</li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">Виконання графу обчислень.</li></ol><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><span></span><strong
style="box-sizing: inherit; font-weight: bold;">Граф обчислень</strong><span> </span>є послідовність операцій TensorFlow, розміщених в вигляді графу вузлів. Давайте побудуємо простий граф обчислень. Кожний вузел приймає нуль або більше тензорів на вході, та продукує тензор на виході. Один з типів вузлів є константа. Як і всі константи TensorFlow, вона не приймає нічого на вході, та видає на вихід значення, що зберігає всередині. Ми можемо створити два тензори з плаваючою крапкою,&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">node1</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">node2</code><span>, наступним чином</span>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">node1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">constant</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.0</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">node2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">constant</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.0</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># also tf.float32 implicitly</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">node1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> node2</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Остання команда друку спродукує таке:</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Tensor</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"Const:0"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> shape</span><span
class="pun" style="box-sizing: inherit;">=(),</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Tensor</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"Const_1:0"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> shape</span><span
class="pun" style="box-sizing: inherit;">=(),</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, що друк вузла не виводить значення&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">3.0</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">4.0</code><span>, як ви могли очікувати. Замість цього це вузли, що при обчисленні будуть продукувати </span>3.0 та 4.0, відповідно. Щоб насправді обчислити вузли нам потрібно виконати обчислювальний граф всередині&nbsp;<span></span><strong
style="box-sizing: inherit; font-weight: bold;">сессії</strong>. Сессія інкапсулює контроль та стан середовища виконання TensorFlow.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Наступний код створює об'єкт<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Session</code><span>, та потім викликає метод</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">run</code><span>, щоб виконати досить з графу обчислення, щоб розрахувати&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">node1</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">node2</code>. Виконання графу обчислень в сессії, що відбувається наступним чином</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">sess </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Session</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="pln" style="box-sizing: inherit;">node1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> node2</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">дає нам очікувані значення 3.0 та 4.0:</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.0</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.0</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми можемо побудувати більш складні обчислення, комбінуючи вузли&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Tensor</code><span> з операціями</span> (операції це також вузли). Наприклад, ми можемо додати дві вузли-константи, та спродукувати новий граф, наступним чином:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">node3 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">add</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">node1</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> node2</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"node3: "</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> node3</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"sess.run(node3): "</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">node3</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Два останні команди друку видадуть таке</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">node3</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> &nbsp;</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Tensor</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"Add:0"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> shape</span><span
class="pun" style="box-sizing: inherit;">=(),</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">node3</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"> &nbsp;</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7.0</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow провадить утіліту, що може відобразити на малюнку граф обчислень. Ось зображення екрану, що показує, як TensorBoard візуалізує граф:</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><img alt="TensorBoard screenshot"
src="https://www.tensorflow.org/images/getting_started_add.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%;">https://weka.waikato.ac.nz/explorer</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В такому вигляді це граф не дуже цікавий, бо він завжди продукує сталий результат. Граф може бути параметризований, щоб сприймати зовнішій ввод, що відомий як&nbsp;<span></span><strong
style="box-sizing: inherit; font-weight: bold;">заміщувач</strong>.&nbsp;<span></span><strong
style="box-sizing: inherit; font-weight: bold;">Заміщувач</strong><span style="box-sizing: inherit; font-weight: bold;"><strong></strong></span> це обіцянка надати значення пізніше.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">a </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">b </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">placeholder</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">adder_node </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> a </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> b &nbsp;</span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># + provides a shortcut for tf.add(a, b)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Попередні три рядки трохи схожі на функцію або лямбду, де ми визначаємо два вхідні параметри (a та b), та потім операцію з ними. Ми можемо обчислити цей граф з декількома вхідними значеннями через використання параметра feed_dict, де вказуються Tensor-и, що провадять конкретні значення для ціх заміщувачів:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">adder_node</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">a</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> b</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.5</span><span
class="pun" style="box-sizing: inherit;">}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">adder_node</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">a</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> b</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">]}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">видає результат</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7.5</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="pun" style="box-sizing: inherit;">[</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pln" style="box-sizing: inherit;"> &nbsp;</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7.</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В TensorBoard граф виглядає так:</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><img alt="TensorBoard screenshot"
src="https://www.tensorflow.org/images/getting_started_adder.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%;"></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми можемо зробити граф обчислення більш складнішим, через додавання інших операцій. наприклад,</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">add_and_triple </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> adder_node </span><span
class="pun" style="box-sizing: inherit;">*</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">add_and_triple</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">a</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> b</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.5</span><span
class="pun" style="box-sizing: inherit;">}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">продукує на виході</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">22.5</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Попередній граф обчислень буде виглядати в TensorBoard наступним чином:</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><img alt="TensorBoard screenshot"
src="https://www.tensorflow.org/images/getting_started_triple.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%;"></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В машинному навчанні ми будемо типово вивчати модель, що може мати довільні дані на вході, такі як вище. Щоб зробити модель здатною до тренування, нам треба мати змогу модифікувати граф, щоб отримувати нові виходи з тими самими входами.&nbsp;<span></span><strong
style="box-sizing: inherit; font-weight: bold;">Змінні </strong>дозволяють нам додати тренувальні параметри до графа. Вони сконструйовані з типу та значення ініціалізації:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">([.</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">([-.</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">x </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">linear_model </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> W </span><span
class="pun" style="box-sizing: inherit;">*</span><span class="pln" style="box-sizing: inherit;"> x </span><span
class="pun" style="box-sizing: inherit;">+</span><span class="pln" style="box-sizing: inherit;"> b<br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Константи ініціалізуються, коли ви викликаєте&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.constant</code>, та їх значення ніколи не змінюється. На відміну від цього, змінні ініціалізуються, коли ви викликаєте&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code>. Щоб ініціалізувати всі змінні в програмі TensorFlow, вам треб явно викликати спеціальну операцію таким чином:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">init </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">global_variables_initializer</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">init</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Важливо розуміти, що&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">init</code><span> обробляє суб-граф </span>TensorFlow, що ініціалізує всі глобальні змінні. Доки ми не виконаємо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">sess.run</code>, змінні не будуть ініціалізовані.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Оскльки&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> </span>є заміщувачем, ми можемо обчислити&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">linear_model</code><span> для декількох значень&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> одночасно</span>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">linear_model</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">x</span><span
class="pun" style="box-sizing: inherit;">:[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">]}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">що дасть на виході</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pun" style="box-sizing: inherit;">[</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.</span><span
class="pln" style="box-sizing: inherit;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.30000001</span><span
class="pln" style="box-sizing: inherit;"> &nbsp;</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.60000002</span><span
class="pln" style="box-sizing: inherit;"> &nbsp;</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.90000004</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми створили модель, але ми досі не знаємо, наскільки вона гарна. Щоб спробувати модель на тренувальних даних, нам треба замісник<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">y</code>, що буде провадити потрібні значення, та нам треба написати функцію втрат.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Функція втрат обчислює, наскільки поточна модель відрізняється від запроваджених даних. Ми будемо використовувати стандартну модель втрат для лінійної регрессії, що підсумковує квадрати відстаней між поточною моделлю та наданими даними.&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">linear_model - y</code><span> створить вектор, де кожний елемент є дельта помилки для відповідного приклада. Ми визиваємо&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.square</code><span> щоб піднести це значення в квадрат</span>. Потім ми збираємо всі помилки в квадраті, щоб створити єдиний скаляр, що абстрагує помилку для всіх прикладів, з використанням&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.reduce_sum</code>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">y </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">squared_deltas </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">square</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">linear_model </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="pln" style="box-sizing: inherit;"> y</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">loss </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">reduce_sum</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">squared_deltas</span><span class="pun"
style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">loss</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">x</span><span
class="pun" style="box-sizing: inherit;">:[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> y</span><span
class="pun" style="box-sizing: inherit;">:[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">]}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">отримуємо значення</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">23.66</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми можемо покращити це вручну, через присвоєння інших значень до векторів<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code><span> </span>до ідеальних значень -1 та 1. Змінна ініціалізована до значення, що провадить&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code><span>, але може бути змінена з використанням оператора, такого як </span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.assign</code>. Наприклад,&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W=-1</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b=1</code><span> є оптимальними параметрами для нашої моделі. Ми змінюємо&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code><span> відповідно</span>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">fixW </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">assign</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">W</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[-</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">fixb </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">assign</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">b</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">([</span><span
class="pln" style="box-sizing: inherit;">fixW</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> fixb</span><span class="pun" style="box-sizing: inherit;">])</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">loss</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">x</span><span
class="pun" style="box-sizing: inherit;">:[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> y</span><span
class="pun" style="box-sizing: inherit;">:[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">]}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Заключний друк покаже нам відсутність втрат.</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.0</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми вгадали "ідеальні" значення&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> </span>та<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code>, але головне завдання машинного навчання є пошук коректних параметрів моделі автоматично. Ми покажемо, як досягти цього, в наступному розділі.</p><h2
id="tftrain_api" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">tf.train API</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Розгорнута дискусія з машинного навчання лежить за лаштунками цього керівництва. Однак TensorFlow провадить&nbsp;<span></span><strong
style="box-sizing: inherit; font-weight: bold;">оптимізатори</strong><span>, </span>що повільно змінюють кожну змінну щоб мінімізувати функцію втрат. Простіший оптимізатор є&nbsp;<span></span><strong
style="box-sizing: inherit; font-weight: bold;">градієнтний спуск</strong>. Він модифікує кожну змінну відповідно до величини похідної втрати відносно цієї змінної. Загалом, обчислення символічних похідних вручну є втомливим та схильним до помилок. Відповідно, TensorFlow може автоматично продукувати похідні, беручи тільки опис моделі з використанням функції&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.gradients</code>. Для спрощення оптимізатор типово робить це за вас. Наприклад,</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">optimizer </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">GradientDescentOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.01</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">train </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> optimizer</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">minimize</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">loss</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">init</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># скадає значення до навірних по замовчанню</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> i </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> range</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">:[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> y</span><span
class="pun" style="box-sizing: inherit;">:[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">]})</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="kwd"
style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span class="pun"
style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="pln" style="box-sizing: inherit;">W</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> b</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">results in the final model parameters:</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pun" style="box-sizing: inherit;">[</span><span class="pln" style="box-sizing: inherit;">array</span><span
class="pun" style="box-sizing: inherit;">([-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.9999969</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">),</span><span class="pln" style="box-sizing: inherit;"> array</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.99999082</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp;dtype</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">)]</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми виконали справжнє машинна навчання! Хоча зробити цю просту лінійну регрессію насправді не потребує багато коду TensorFlow core, більш складні моделі та методи подачі даних даних до вашої моделі потребуватиме більше кода. Таким чином TensorFlow провадить вищій рівень абстракції для загальних шаблонів, структур та функціональності. Ми вивчимо, як використовувати деякі з ціх абстракцій в наступному розділі.</p><h3
id="complete_program" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Ціла програма</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Завершена модель лінійної регрессії з тренуванням показана нижче:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> numpy </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> np<br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> tensorflow </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> tf<br style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Параметри моделі</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">W </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">([.</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">([-.</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Вхід та вихід моделі</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">x </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">placeholder</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">linear_model </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> W </span><span class="pun" style="box-sizing: inherit;">*</span><span
class="pln" style="box-sizing: inherit;"> x </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> b<br style="box-sizing: inherit;">y </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">placeholder</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># втрати</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">loss </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reduce_sum</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">square</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">linear_model </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="pln" style="box-sizing: inherit;"> y</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># sum of the squares</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># оптимізатор</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">optimizer </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">train</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">GradientDescentOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.01</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">train </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> optimizer</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">minimize</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">loss</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># дані для тренування</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">x_train </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">y_train </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># цикл тренування</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">init </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">global_variables_initializer</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">sess </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Session</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">init</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># скидаємо змінні в помілкові значення</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> i </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> range</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;">x_train</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> y</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;">y_train</span><span class="pun" style="box-sizing: inherit;">})</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># обчислюємо точність тренування</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">curr_W</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> curr_b</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> curr_loss </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="pln" style="box-sizing: inherit;">W</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> b</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> loss</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="pln" style="box-sizing: inherit;">x</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;">x_train</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> y</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;">y_train</span><span
class="pun" style="box-sizing: inherit;">})</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"W: %s b: %s loss: %s"</span><span
class="pun" style="box-sizing: inherit;">%(</span><span class="pln" style="box-sizing: inherit;">curr_W</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> curr_b</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> curr_loss</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">При виконанні це продукує</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[-</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.9999969</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"> b</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.99999082</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"> loss</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5.69997e-11</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, що страти є дуже малим числом (біля нуля). Якщо ви виконаєте цю програму, ваші втрати можуть не бути такими самими, бо модель ініціалізується довільними значеннями.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ця більш ускладнена програма все ще може бути відображена в TensorBoard<span>&nbsp;</span><img
alt="TensorBoard final model visualization" src="https://www.tensorflow.org/images/getting_started_final.png"
style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%;"></p><h2
id="tfcontriblearn" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;"><code
style="box-sizing: inherit; background: 0px center; color: rgb(33, 33, 33); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 21.6px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: break-word;">tf.contrib.learn</code></h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><code style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn</code><span> є високорівневою бібліотекою </span>TensorFlow, що спрощує механізми машинного навчання, включаючи наступне:</p><ul
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">виконання навчальних циклів</li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">виконання оціночних циклів</li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">керування наборами даних</li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;">керування подачею даних</li></ul><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">tf.contrib.learn визначає багато загальних моделей.</p><h3
id="basic_usage" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Базове використання</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, наскільки простішим стає програма лінійної регресії за допомогою<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn</code>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> tensorflow </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> tf<br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># NumPy часто використовується для завантаження, маніпуляції та попередньої обробки даних.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> numpy </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> np<br style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Декларуємо список прикмет. Ми маємо тільку одну прикмету дійсного типу. Існує багато</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># інших типів стовпчиків, що більш складні та корисні.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">features </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">contrib</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">layers</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">real_valued_column</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"x"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> dimension</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">)]</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="com"
style="box-sizing: inherit; color: rgb(216, 27, 96);"># Очікувач є фронт ендом для викллику тренування (підгонки) та обчислення</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># (виводу). Існує багато наперед визначених типів, як лінійна регрессія,</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># логістична регрессія, лінійна класифікація, логістична класифікація, та</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># багато класифікаторів та регресій на нейронних мережах. Наступний код провадить</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># очікувач, що виконує лінійну регресію.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">estimator </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">contrib</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">learn</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">LinearRegressor</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">feature_columns</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">features</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="com"
style="box-sizing: inherit; color: rgb(216, 27, 96);"># TensorFlow надає багато допоміжних методів для читання та налаштування наборів даних.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Тут ми використовуємо два набори даних: один для тренування і один для оцінювання</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Ми маємо сказати функції, скільки пакунків даних </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);">(num_epochs) ми бажаємо, та наскільки великим <br># має бути кожний пакунок.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">x_train </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> np</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">array</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">y_train </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> np</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">array</span><span class="pun" style="box-sizing: inherit;">([</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">x_eval </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> np</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">array</span><span class="pun" style="box-sizing: inherit;">([</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">8.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">y_eval </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> np</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">array</span><span class="pun" style="box-sizing: inherit;">([-</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.01</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">input_fn </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">contrib</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">learn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">io</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">numpy_input_fn</span><span class="pun"
style="box-sizing: inherit;">({</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"x"</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;">x_train</span><span
class="pun" style="box-sizing: inherit;">},</span><span class="pln" style="box-sizing: inherit;"> y_train</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; batch_size</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num_epochs</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">eval_input_fn </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">contrib</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">learn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">io</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">numpy_input_fn</span><span class="pun"
style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"x"</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;">x_eval</span><span
class="pun" style="box-sizing: inherit;">},</span><span class="pln" style="box-sizing: inherit;"> y_eval</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> batch_size</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> num_epochs</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="com"
style="box-sizing: inherit; color: rgb(216, 27, 96);"># Ми можемо виконати 1000 тренувальних кроків через виклик метода, та передавши йому тренувальний набір даних</span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);">.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">estimator</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">fit</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> steps</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="com"
style="box-sizing: inherit; color: rgb(216, 27, 96);"># Тут ми обчислюємо, наскільки гарною є наша модель.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">train_loss </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> estimator</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">evaluate</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">eval_loss </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> estimator</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">evaluate</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">input_fn</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">eval_input_fn</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"train loss: %r"</span><span
class="pun" style="box-sizing: inherit;">%</span><span class="pln" style="box-sizing: inherit;"> train_loss</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"eval loss: %r"</span><span
class="pun" style="box-sizing: inherit;">%</span><span class="pln" style="box-sizing: inherit;"> eval_loss</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Результат роботи програми</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">&nbsp; &nbsp; train loss</span><span class="pun"
style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">{</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'global_step'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'loss'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.3049088e-08</span><span
class="pun" style="box-sizing: inherit;">}</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">eval</span><span
class="pln" style="box-sizing: inherit;"> loss</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'global_step'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'loss'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.0025487561</span><span
class="pun" style="box-sizing: inherit;">}</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, як наші обчислені дані мають більшу втрату, але вона все ще близька до нуля. Це означає, що ми навчаємось вірно.</p><h3
id="a_custom_model" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Власна модель</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><code style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn</code><span> не обмежує вас власними моделями</span>. Припустимо, ми бажаємо створити власну модель, що не вбудована в TensorFlow. Ми можемо все ще залишити високий рівень абстракції набору даних, подачі, тренування, тощо від <code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn</code>. Для ілюстрації ми покажемо, как реалізувати наш новий еквівалент моделі&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">LinearRegressor</code><span> з використанням нашого знання низького рівня </span>TensorFlow API.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб визначити власну модель, що робить з&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn</code>, нам треба використати<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn.Estimator</code>.<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn.LinearRegressor</code><span> </span>є насправді суб-класом<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn.Estimator</code>. Замість створення суб-класа&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Estimator</code>, ми просто надамо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Estimator</code><span> функцію</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">model_fn</code><span>, що вкаже&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.contrib.learn</code><span>, як він має обчислювати прогнози, кроки тренування та втрати. Код буде наступним</span>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> numpy </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> np<br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> tensorflow </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> tf<br style="box-sizing: inherit;"></span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Декларуємо список прикмет, ми маєто тільку одну дійсного типу</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">def</span><span
class="pln" style="box-sizing: inherit;"> model</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">features</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> labels</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> mode</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; </span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Будуємо лінійну модель та прогнозуєме значення</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; W </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">get_variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"W"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float64</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; b </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">get_variable</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"b"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> dtype</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float64</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; y </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> W</span><span class="pun" style="box-sizing: inherit;">*</span><span
class="pln" style="box-sizing: inherit;">features</span><span class="pun" style="box-sizing: inherit;">[</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'x'</span><span
class="pun" style="box-sizing: inherit;">]</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">+</span><span class="pln" style="box-sizing: inherit;"> b<br
style="box-sizing: inherit;">&nbsp; </span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Суб-граф обчислення втрати</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; loss </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reduce_sum</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">square</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="pln" style="box-sizing: inherit;"> labels</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; </span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Суб-граф тренування</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; global_step </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">train</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">get_global_step</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; optimizer </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">GradientDescentOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.01</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; train </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">group</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">optimizer</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">minimize</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">loss</span><span
class="pun" style="box-sizing: inherit;">),</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">assign_add</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">global_step</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; </span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># ModelFnOps з'єднує суб-графи, що ми побудували, до відповідної функціональності</span><span
class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);">.</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; </span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">return</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">contrib</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">learn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">ModelFnOps</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; mode</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">mode</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> predictions</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">y</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; loss</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">loss</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; train_op</span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">train</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;">estimator </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">contrib</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">learn</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Estimator</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">model_fn</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">model</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># визначаємо наші набори даних</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">x_train </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> np</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">array</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">y_train </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> np</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">array</span><span class="pun" style="box-sizing: inherit;">([</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">3.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">x_eval </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> np</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">array</span><span class="pun" style="box-sizing: inherit;">([</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">8.</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">y_eval </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> np</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">array</span><span class="pun" style="box-sizing: inherit;">([-</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.01</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">input_fn </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">contrib</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">learn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">io</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">numpy_input_fn</span><span class="pun"
style="box-sizing: inherit;">({</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"x"</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> x_train</span><span
class="pun" style="box-sizing: inherit;">},</span><span class="pln" style="box-sizing: inherit;"> y_train</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> num_epochs</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="com"
style="box-sizing: inherit; color: rgb(216, 27, 96);"># тренування</span><span class="pln"
style="box-sizing: inherit;"><br style="box-sizing: inherit;">estimator</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">fit</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> steps</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="com" style="box-sizing: inherit; color: rgb(216, 27, 96);"># Тут ми обчислюємо, наскільки гароною є наша модель. </span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">train_loss </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> estimator</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">evaluate</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">input_fn</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">eval_loss </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> estimator</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">evaluate</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">input_fn</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">eval_input_fn</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"train loss: %r"</span><span
class="pun" style="box-sizing: inherit;">%</span><span class="pln" style="box-sizing: inherit;"> train_loss</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"eval loss: %r"</span><span
class="pun" style="box-sizing: inherit;">%</span><span class="pln" style="box-sizing: inherit;"> eval_loss</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Результати виконання</p><pre
class="prettyprint" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">train loss</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'global_step'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'loss'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">4.9380226e-11</span><span
class="pun" style="box-sizing: inherit;">}</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">eval</span><span
class="pln" style="box-sizing: inherit;"> loss</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'global_step'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'loss'</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.01010081</span><span
class="pun" style="box-sizing: inherit;">}</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, як вміст власної функції&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">model()</code><span> дуже подібний до нашої ручної моделі тренування з низькорівневого</span> API.</p><h2
id="next_steps" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Наступні кроки</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ви маєте знання основ TensorFlow. Ви маєте декілька додаткових керівництв, які ви можете передивитись для подальшого навчання. Якщо ви є початківцем в вивченні машинного навчання, передивіться&nbsp;<span></span><a
href="https://www.tensorflow.org/get_started/mnist/beginners" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">MNIST для початківців</a>, інакше дивіться<span> </span><a
href="https://www.tensorflow.org/get_started/mnist/pros" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Поглиблений MNIST для експертов</a>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"></p><h1 itemprop="name"
class="devsite-page-title" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: rgb(117, 117, 117); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">MNIST для ML початківців</h1><div
class="devsite-article-body clearfix
            " itemprop="articleBody" style="box-sizing: inherit; margin: 0px; padding: 0px; color: rgb(33, 33, 33); font-family: Roboto, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><em style="box-sizing: inherit; font-style: italic;">Ця інструкція призначена для читачів, які нові для обох, машинного навчання та TensorFlow. Якщо ви вже знаєте, що таке MNIST, та що таке софтмакс регрессія (мультіномінальна логістика), ви можете перейти до цього&nbsp;<span></span><a
href="https://www.tensorflow.org/get_started/mnist/pros" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">швидшого туторіала</a>. Переконайтесь, що встановили <a
href="https://www.tensorflow.org/install/index" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorFlow</a><span> </span>перед початком кожного з керівництв.</em></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Коли ми навчаємось програмуванню, традиційно перша річ, що ми робимо, це друкуємо "Hello World". Так само, як програмування має Hello World, машинне навчання має MNIST.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">MNIST є простим набором даних з комп'ютерного бачення. Він складаєтсья з зображень рукописних цифр в такому вигляді:</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 322.797px;"><img
src="https://www.tensorflow.org/images/MNIST.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 322.797px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Він також включає мітки, що кажуть, які цифри зображені. Наприклад, мітки для зображення вище будуть 5, 0, 4, та 1.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В цьому туторіалі ми збираємось тренувати модель, що буде переглядати зображення, та розпізнавати, які цифри вони зображують. Наша ціль не тренує насправді складну модель, що досягає визначної якості, хоча ми надамо вам такий код пізніше! Поки ми лише торкнемось TensorFlow. Поки ми почнемо з дуже простої моделі на ім'я Softmax Regression.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Справжній код для цього туторіала є дуже короткий, та всі цікаві речі відбуваються в трьох рядках. Однак це дуже важливорозуміти ідеї за цім: обоє, як робить TensorFlow, та головні концепції машинного навчання. Для цього ми збираємось дуже уважно пройтись по коду.&nbsp;</p><h2
id="about_this_tutorial" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Щодо цього туторіала</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Цей туторіал пояснює те, що відбувається в коді&nbsp;<span></span><a
href="https://www.github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/examples/tutorials/mnist/mnist_softmax.py"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">mnist_softmax.py</a>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ви можете використовувати цей туторіал в декілька різних способів, включаючи:</p><ul
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Копіюйте та вставляйте кожний фрагмент коду, рядок за рядком, в оточення Python, по мірі читання пояснень рядок за рядком.</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Виконайте файл <span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist_softmax.py</code><span> в </span>Python, або перед, або після читання пояснень, та використовуйте цей туторіал для розуміння рядків кода, що незрозумілі для вас.</p></li></ul><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Що ми досягнемо в цьому туторіалі:</p><ul
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Навчимось щодо даних MNIST та софтмакс регресії</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Створимо функцію, що буде моделлю для розпізнавання цифр, базуючись на розгляданні кожного пікселя зображення</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Використаємо TensorFlow для тренування моделі для розпізнавання цифр, через "погляд" на тисячі прикладів (та виконання для цього нашої першої сессії TensorFlow)</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Перевіримо точність моделі за допомогою наших тестових даних</p></li></ul><h2
id="the_mnist_data" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Дані MNIST</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Дані MNIST знаходяться на сайті<span> </span><a
href="http://yann.lecun.com/exdb/mnist/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Yann LeCun's</a>. Якщо ви копіюєте та вставляєте код з цього туторіала, почніть з ціх двох рядків кода, що завантажать та прочитають дані автоматично:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">from</span><span
class="pln" style="box-sizing: inherit;"> tensorflow</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">examples</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">tutorials</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">mnist </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> input_data<br style="box-sizing: inherit;">mnist </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> input_data</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">read_data_sets</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">"MNIST_data/"</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> one_hot</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">True</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Дані MNIST поділені на три частини: 55,000 точок даних для тренування (<code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.train</code>), 10,000 точок для даних тестування (<code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.test</code>), та 5,000 точок для валідації (<code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.validation</code>). Цей поділ дуже важливий: в машинному навчанні основою є те, що ми маємо окремі дані, по яких ми не навчаємось, так що ми можемо бути впевнені, що те, чому ми навчаємость, має загальне значення!</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Як зазначалось вище, кожна точка даних MNIST має дві частини: зображення рукописної цифри, та відповідна мітка. Ми будемо позначати зображення "x" та мітки "y". Обоє, набір для тренування та набір для тестування, містять зображення та їх відповідні мітки; наприклад, зображення для тестування&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.train.images</code><span>, та мітки для тренування</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.train.labels</code>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Кожне зображення розміром 28 на 28 пікселів. Ми можемо інтерпретувати це як великий масив чисел:</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 403.5px;"><img
src="https://www.tensorflow.org/images/MNIST-Matrix.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 403.5px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми можемо розрівняти цей масив в вектор з 28x28 = 784 чисел. Не має значення, як ми спрямлятимемо масив, доки ми будемо робити це узгоджено для всіх зображень. З цієї перспективи зображення MNIST є простий пакунок крапок в 784-розмірному векторному просторі,&nbsp; з дуже багатою <a
href="http://colah.github.io/posts/2014-10-Visualizing-MNIST/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">структурою</a><span> </span>(увага: обчислювально інтенсивна візуалізація).</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Вірівнювання дати прибирає інформацію щодо 2D структури зображення. Чи це не є поганим? Так, найкращі методи комп'ютерного бачення використовують цю структуру, і ми також будемо робити це далі в цьому туторіалі. Але простий метод, що ми застосуємо тут, софтмакс регрессія (описана нижче), цього не використовує.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В результаті&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.train.images</code><span> є тензором </span>(n-вимірним масивом) в розмірністю<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[55000, 784]</code>. Перший вимір є індексом в списку зображень, та другий є індекс кожного пікселя для кожного зоображення. Кожне входження в тензорі є інтенсивність пікселя між 0 та 1, для окремого пікселя для окремого зображення.</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 322.797px;"><img
src="https://www.tensorflow.org/images/mnist-train-xs.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 322.797px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Кожне зображення в MNIST має відповідну відмітку, число між 0 та 9, що представляє цифру, намальоване на зображенні.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Для наших цілей ми збираємось перетворити наші відмітки на "односпрямовані вектори". Односпрямований вектор є вектор, що є 0 в більшості напрямків, та 1 в одному напрямку. В цьому випадку n-на цифра буде представлена як вектор, що має 1 в n-ній розмірності.&nbsp;<span
class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mn></mn><mo></mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn></mn><mo></mo><mn></mn><mo
stretchy="false"></mo></math></span></span> Відповідно,&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.train.labels</code><span> масив з плаваючою крапкою розміром</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[55000, 10]</code>.</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 322.797px;"><img
src="https://www.tensorflow.org/images/mnist-train-ys.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 322.797px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми дійсно готові створити модель!</p><h2
id="softmax_regressions" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Софтмакс регрессія</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми знаємо, що кожне зображення в MNIST є рукописна цифра від нуля до дев'яти. Так що кожна річ може бути тільки чимось одним з десяти. Ми бажаємо бути в змозі поглянути на зображення, та надати вірогідность що це може бути певною цифрою. Наприклад, наша модель може подивитись на зображення дев'ятки, та на 80% впевнено сказати, що це дев'ять, та дати 5% шансів, що це буде вісім (завдяки верхній петлі), та рохи вірогідності всім іншим, щоб загалом утворились 100%.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Це класичний випадок, коли софтмакс регресія є природною, простою моделлю. Якщо ви бажаєте призначити вірогідності тому, що об'єкти є однією з декількох речей, софтмакс є тим, що це робить, оскільки софтмакс використовує список значень від 0 до 1, що разом складають 1. Навіть пізніше, коли ми тренуватемо більш складні моделі, останній крок буде софтмакс. </p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Софтмакс регрессія має два кроки: спочатку ми додаємо докази того, що вхідний примірник належить до певного класу, та потім ми конвертуємо ці докази в вірогідності.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб підрахувати докази, що дане зображення є певного класу, ми робимо інтенсивності пікселів. Вага є негативною, якщо піксель має високу інтенсивність, що свідчить проти того, що зображення належить до класу, та позитивна, якщо докази свідчать за.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Наступна диаграма показує ваги однієї моделі, що є результатом навчання з ціх класів. Червоне представляє негативні ваги, сині - позитивні ваги.&nbsp;</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 322.797px;"><img
src="https://www.tensorflow.org/images/softmax-weights.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 322.797px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми також додаємо додаткове свідоцтво, назване нахилом. Загалом, ми бажаємо бути в змозі сказати, що деякі речі, найбільш вірогідно, незалежні від входу. Результатом є те, що свідоцтво для класу <span></span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.903ex" viewBox="0 -715.3 345.5 819.3"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-69" x="0" y="0"><path stroke-width="1" id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><span> </span>маючи вход<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.429ex" viewBox="0 -511.5 572.5 615.4"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><span> </span>є:</p><div
style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="MathJax_Preview"
style="box-sizing: inherit; color: inherit;"></span><div class="MathJax_SVG_Display"
style="box-sizing: inherit; margin: 1em 0em; padding: 0px; text-align: center; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 807px; display: block !important;"><span
class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mtext&gt;evidence&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="27.815ex" height="5.69ex" viewBox="0 -1021.1 11975.9 2449.8"
role="img" focusable="false" style="vertical-align: -3.318ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMAIN-65"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-76" x="444" y="0"><path stroke-width="1" id="MJMAIN-76" d="M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z"></path></use><use
xlink:href="#MJMAIN-69" x="973" y="0"><path stroke-width="1" id="MJMAIN-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path></use><use
xlink:href="#MJMAIN-64" x="1251" y="0"><path stroke-width="1" id="MJMAIN-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path></use><use
xlink:href="#MJMAIN-65" x="1808" y="0"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-6E" x="2252" y="0"><path stroke-width="1" id="MJMAIN-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-63" x="2809" y="0"><path stroke-width="1" id="MJMAIN-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path></use><use
xlink:href="#MJMAIN-65" x="3253" y="0"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="5229" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use><use
xlink:href="#MJMAIN-3D" x="4320" y="0"><path stroke-width="1" id="MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></use><g
transform="translate(5376,0)"><use xlink:href="#MJSZ2-2211" x="0" y="0"><path stroke-width="1"
id="MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="815" y="-1536"><path stroke-width="1"
id="MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></use></g><g
transform="translate(6987,0)"><use xlink:href="#MJMATHI-57" x="0" y="0"><path stroke-width="1"
id="MJMATHI-57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></use><g
transform="translate(944,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"
x="0" y="0"><path stroke-width="1" id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"><path stroke-width="1"
id="MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="977" y="0"><path stroke-width="1"
id="MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></use></g></g><g
transform="translate(9014,0)"><use xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1"
id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="809" y="-213"><path stroke-width="1"
id="MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></use></g><use
xlink:href="#MJMAIN-2B" x="10201" y="0"><path stroke-width="1" id="MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></use><g
transform="translate(11202,0)"><use xlink:href="#MJMATHI-62" x="0" y="0"><path stroke-width="1"
id="MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="607" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g></g></svg><span
class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 235.109px; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mtext>evidence</mtext><mi>i</mi></msub><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>W</mi><mrow
class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></math></span></span></div></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">де<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="2.993ex" height="2.376ex" viewBox="0 -766.3 1288.8 1023.1"
role="img" focusable="false" style="vertical-align: -0.596ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-57" x="0" y="0"><path stroke-width="1" id="MJMATHI-57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1335" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>W</mi><mi>i</mi></msub></math></span></span><span> </span>є вагами, та<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.797ex" height="2.376ex" viewBox="0 -766.3 773.8 1023.1"
role="img" focusable="false" style="vertical-align: -0.596ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-62" x="0" y="0"><path stroke-width="1" id="MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="607" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>i</mi></msub></math></span></span><span> є схильністю до класу</span><span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.903ex" viewBox="0 -715.3 345.5 819.3"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-69" x="0" y="0"><path stroke-width="1" id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span>, та<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.376ex" viewBox="-11.5 -715.3 424 1023.1"
role="img" focusable="false" style="vertical-align: -0.715ex; margin-left: -0.027ex;"
aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0"
transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-6A" x="0" y="0"><path
stroke-width="1" id="MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><span> є індексом для підсумку на пікселях в нашому вхідному зображенні</span><span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.429ex" viewBox="0 -511.5 572.5 615.4"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span>. Потім ми перетворимо свідчення на вірогідності&nbsp;<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.903ex" viewBox="0 -511.5 497.5 819.3"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><span> з використанням функції</span> "софтмакс":</p><div
style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="MathJax_Preview"
style="box-sizing: inherit; color: inherit;"></span><div class="MathJax_SVG_Display"
style="box-sizing: inherit; margin: 1em 0em; padding: 0px; text-align: center; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 807px; display: block !important;"><span
class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mtext&gt;evidence&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="22.673ex" height="2.613ex" viewBox="0 -817.3 9762.1 1125"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
xlink:href="#MJMAIN-3D" x="775" y="0"><path stroke-width="1" id="MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></use><g
transform="translate(1831,0)"><use xlink:href="#MJMAIN-73"><path stroke-width="1"
id="MJMAIN-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path></use><use
xlink:href="#MJMAIN-6F" x="394" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-66" x="895" y="0"><path stroke-width="1" id="MJMAIN-66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path></use><use
xlink:href="#MJMAIN-74" x="1201" y="0"><path stroke-width="1" id="MJMAIN-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path></use><use
xlink:href="#MJMAIN-6D" x="1591" y="0"><path stroke-width="1" id="MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-61" x="2424" y="0"><path stroke-width="1" id="MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></use><use
xlink:href="#MJMAIN-78" x="2925" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="5285" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><g
transform="translate(5674,0)"><use xlink:href="#MJMAIN-65"><path stroke-width="1"
id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-76" x="444" y="0"><path stroke-width="1" id="MJMAIN-76" d="M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z"></path></use><use
xlink:href="#MJMAIN-69" x="973" y="0"><path stroke-width="1" id="MJMAIN-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path></use><use
xlink:href="#MJMAIN-64" x="1251" y="0"><path stroke-width="1" id="MJMAIN-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path></use><use
xlink:href="#MJMAIN-65" x="1808" y="0"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-6E" x="2252" y="0"><path stroke-width="1" id="MJMAIN-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-63" x="2809" y="0"><path stroke-width="1" id="MJMAIN-63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path></use><use
xlink:href="#MJMAIN-65" x="3253" y="0"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use></g><use
xlink:href="#MJMAIN-29" x="9372" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g></svg><span
class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 191.656px; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mtext>softmax</mtext><mo
stretchy="false">(</mo><mtext>evidence</mtext><mo stretchy="false">)</mo></math></span></span></div></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тут софтмакс прислуговується як функція "активації" або "посилання", перетворюючи вихід нашої лінійної функції в бажану форму, в нашому випадку розподілена вірогідність між десятью випадками. Ви можете думати про перетворення накопиченних свідоцтв в вірогідності того, що наш вхід належить до певного класу. Це виражається так:</p><div
style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="MathJax_Preview"
style="box-sizing: inherit; color: inherit;"></span><div class="MathJax_SVG_Display"
style="box-sizing: inherit; margin: 1em 0em; padding: 0px; text-align: center; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 807px; display: block !important;"><span
class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;normalize&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="32.583ex" height="2.613ex" viewBox="0 -817.3 14028.6 1125"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMAIN-73"><path stroke-width="1" id="MJMAIN-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path></use><use
xlink:href="#MJMAIN-6F" x="394" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-66" x="895" y="0"><path stroke-width="1" id="MJMAIN-66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path></use><use
xlink:href="#MJMAIN-74" x="1201" y="0"><path stroke-width="1" id="MJMAIN-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path></use><use
xlink:href="#MJMAIN-6D" x="1591" y="0"><path stroke-width="1" id="MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-61" x="2424" y="0"><path stroke-width="1" id="MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></use><use
xlink:href="#MJMAIN-78" x="2925" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use><use
xlink:href="#MJMAIN-28" x="3453" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><use
xlink:href="#MJMATHI-78" x="3843" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><use
xlink:href="#MJMAIN-29" x="4415" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use><use
xlink:href="#MJMAIN-3D" x="5082" y="0"><path stroke-width="1" id="MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></use><g
transform="translate(6139,0)"><use xlink:href="#MJMAIN-6E"><path stroke-width="1"
id="MJMAIN-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-6F" x="556" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-72" x="1057" y="0"><path stroke-width="1" id="MJMAIN-72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path></use><use
xlink:href="#MJMAIN-6D" x="1449" y="0"><path stroke-width="1" id="MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-61" x="2283" y="0"><path stroke-width="1" id="MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></use><use
xlink:href="#MJMAIN-6C" x="2783" y="0"><path stroke-width="1" id="MJMAIN-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path></use><use
xlink:href="#MJMAIN-69" x="3062" y="0"><path stroke-width="1" id="MJMAIN-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path></use><use
xlink:href="#MJMAIN-7A" x="3340" y="0"><path stroke-width="1" id="MJMAIN-7A" d="M42 263Q44 270 48 345T53 423V431H393Q399 425 399 415Q399 403 398 402L381 378Q364 355 331 309T265 220L134 41L182 40H206Q254 40 283 46T331 77Q352 105 359 185L361 201Q361 202 381 202H401V196Q401 195 393 103T384 6V0H209L34 1L31 3Q28 8 28 17Q28 30 29 31T160 210T294 394H236Q169 393 152 388Q127 382 113 367Q89 344 82 264V255H42V263Z"></path></use><use
xlink:href="#MJMAIN-65" x="3785" y="0"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="10368" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><g
transform="translate(10758,0)"><use xlink:href="#MJMAIN-65"><path stroke-width="1"
id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-78" x="444" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use><use
xlink:href="#MJMAIN-70" x="973" y="0"><path stroke-width="1" id="MJMAIN-70" d="M36 -148H50Q89 -148 97 -134V-126Q97 -119 97 -107T97 -77T98 -38T98 6T98 55T98 106Q98 140 98 177T98 243T98 296T97 335T97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 61 434T98 436Q115 437 135 438T165 441T176 442H179V416L180 390L188 397Q247 441 326 441Q407 441 464 377T522 216Q522 115 457 52T310 -11Q242 -11 190 33L182 40V-45V-101Q182 -128 184 -134T195 -145Q216 -148 244 -148H260V-194H252L228 -193Q205 -192 178 -192T140 -191Q37 -191 28 -194H20V-148H36ZM424 218Q424 292 390 347T305 402Q234 402 182 337V98Q222 26 294 26Q345 26 384 80T424 218Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="12287" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><use
xlink:href="#MJMATHI-78" x="12677" y="0"><path stroke-width="1" id="MJMATHI-78"
d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><use
xlink:href="#MJMAIN-29" x="13249" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use><use
xlink:href="#MJMAIN-29" x="13639" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g></svg><span
class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 275.422px; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>softmax</mtext><mo
stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>normalize</mtext><mo
stretchy="false">(</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo
stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Якщо ви розкриєте ваше рівняння, ви отримаєте:</p><div
style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="MathJax_Preview"
style="box-sizing: inherit; color: inherit;"></span><div class="MathJax_SVG_Display"
style="box-sizing: inherit; margin: 1em 0em; padding: 0px; text-align: center; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 807px; display: block !important;"><span
class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="27.246ex" height="6.4ex" viewBox="0 -1530.6 11730.9 2755.5"
role="img" focusable="false" style="vertical-align: -2.845ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMAIN-73"><path stroke-width="1" id="MJMAIN-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path></use><use
xlink:href="#MJMAIN-6F" x="394" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-66" x="895" y="0"><path stroke-width="1" id="MJMAIN-66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path></use><use
xlink:href="#MJMAIN-74" x="1201" y="0"><path stroke-width="1" id="MJMAIN-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path></use><use
xlink:href="#MJMAIN-6D" x="1591" y="0"><path stroke-width="1" id="MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-61" x="2424" y="0"><path stroke-width="1" id="MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></use><use
xlink:href="#MJMAIN-78" x="2925" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use><use
xlink:href="#MJMAIN-28" x="3453" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><use
xlink:href="#MJMATHI-78" x="3843" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><g
transform="translate(4415,0)"><use xlink:href="#MJMAIN-29" x="0" y="0"><path stroke-width="1"
id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="550" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g><use
xlink:href="#MJMAIN-3D" x="5427" y="0"><path stroke-width="1" id="MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></use><g
transform="translate(6205,0)"><g transform="translate(397,0)"><rect stroke="none"
width="5007" height="60" x="0" y="220"></rect><g transform="translate(891,718)"><use
xlink:href="#MJMAIN-65"><path stroke-width="1" id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-78" x="444" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use><use
xlink:href="#MJMAIN-70" x="973" y="0"><path stroke-width="1" id="MJMAIN-70" d="M36 -148H50Q89 -148 97 -134V-126Q97 -119 97 -107T97 -77T98 -38T98 6T98 55T98 106Q98 140 98 177T98 243T98 296T97 335T97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 61 434T98 436Q115 437 135 438T165 441T176 442H179V416L180 390L188 397Q247 441 326 441Q407 441 464 377T522 216Q522 115 457 52T310 -11Q242 -11 190 33L182 40V-45V-101Q182 -128 184 -134T195 -145Q216 -148 244 -148H260V-194H252L228 -193Q205 -192 178 -192T140 -191Q37 -191 28 -194H20V-148H36ZM424 218Q424 292 390 347T305 402Q234 402 182 337V98Q222 26 294 26Q345 26 384 80T424 218Z"></path></use><use
xlink:href="#MJMAIN-28" x="1529" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><g
transform="translate(1919,0)"><use xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1"
id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g><use
xlink:href="#MJMAIN-29" x="2835" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g><g
transform="translate(60,-719)"><use xlink:href="#MJSZ1-2211" x="0" y="0"><path stroke-width="1"
id="MJSZ1-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="1494" y="-405"><path stroke-width="1"
id="MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></use><g
transform="translate(1614,0)"><use xlink:href="#MJMAIN-65"><path stroke-width="1"
id="MJMAIN-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path></use><use
xlink:href="#MJMAIN-78" x="444" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use><use
xlink:href="#MJMAIN-70" x="973" y="0"><path stroke-width="1" id="MJMAIN-70" d="M36 -148H50Q89 -148 97 -134V-126Q97 -119 97 -107T97 -77T98 -38T98 6T98 55T98 106Q98 140 98 177T98 243T98 296T97 335T97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 61 434T98 436Q115 437 135 438T165 441T176 442H179V416L180 390L188 397Q247 441 326 441Q407 441 464 377T522 216Q522 115 457 52T310 -11Q242 -11 190 33L182 40V-45V-101Q182 -128 184 -134T195 -145Q216 -148 244 -148H260V-194H252L228 -193Q205 -192 178 -192T140 -191Q37 -191 28 -194H20V-148H36ZM424 218Q424 292 390 347T305 402Q234 402 182 337V98Q222 26 294 26Q345 26 384 80T424 218Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="3144" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><g
transform="translate(3533,0)"><use xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1"
id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="809" y="-213"><path stroke-width="1"
id="MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></use></g><use
xlink:href="#MJMAIN-29" x="4498" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g></g></g></g></svg><span
class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 230.312px; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>softmax</mtext><mo
stretchy="false">(</mo><mi>x</mi><msub><mo stretchy="false">)</mo><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo
stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mi>j</mi></munder><mi>exp</mi><mo>⁡</mo><mo
stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Але більш часто корисно думати про софтмакс першим чином: експоненціювання вхідних значень з послідуючою нормалізацію. Експоненціація означає, що ще одна одиниця свідоцтва збільшує вагу, надану до любої гіпотези мутиплікативно. Та навпаки, мати на один доказ менше означає, що гіпотеза матиме тільки частину від попереднього значення. Відсутність гіпотези має нульову або негативну вагу. Потім софтмакс нормалізує ці ваги, так що вони разом складають одиницю, формуючи валідний розподіл вірогідності. (Щоб сприймати функцію софтмакс більш інтуітивно, передивіться цей&nbsp;<span></span><a
href="http://neuralnetworksanddeeplearning.com/chap3.html#softmax" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">розділ</a><span> з книги Макса Нельсена, разом з інтерактивною візуалізацією</span>).</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ви можете змалювати сфотмакс регрессію як дещо, що виглядає наступним чином, але зі значно більшим числом <span></span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.429ex" viewBox="0 -511.5 572.5 615.4"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span>. Для кожного виходу ми обчислюємо зважену суму <span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.429ex" viewBox="0 -511.5 572.5 615.4"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-78" x="0" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span>, додаємо схильність, та потім застосовуємо софтамакс.</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 443.844px;"><img
src="https://www.tensorflow.org/images/softmax-regression-scalargraph.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 443.844px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Якщо ми запишемо це в вигляді рівняння, ми отримуємо:</p><div
style="box-sizing: inherit; margin: 20px 0px 10px 201.75px; padding: 0px; width: 419.625px;"><img
src="https://www.tensorflow.org/images/softmax-regression-scalarequation.png" alt="[y1, y2, y3] = softmax(W11*x1 + W12*x2 + W13*x3 + b1,  W21*x1 + W22*x2 + W23*x3 + b2,  W31*x1 + W32*x2 + W33*x3 + b3)"
style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 419.625px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми можемо "векторизувати" цю процедуру, обертаючи її на множення матриць та додавання вектора. Це корисно для обчислювальної ефективності (це також корисний спосіб мислення).</p><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 403.5px;"><img
src="https://www.tensorflow.org/images/softmax-regression-vectorequation.png" alt="[y1, y2, y3] = softmax([[W11, W12, W13], [W21, W22, W23], [W31, W32, W33]]*[x1, x2, x3] + [b1, b2, b3])"
style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 403.5px;"></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Більш компактно ми можемо просто записати:</p><div
style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="MathJax_Preview"
style="box-sizing: inherit; color: inherit;"></span><div class="MathJax_SVG_Display"
style="box-sizing: inherit; margin: 1em 0em; padding: 0px; text-align: center; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 807px; display: block !important;"><span
class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="21.687ex" height="2.613ex" viewBox="0 -817.3 9337.5 1125"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
xlink:href="#MJMAIN-3D" x="775" y="0"><path stroke-width="1" id="MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></use><g
transform="translate(1831,0)"><use xlink:href="#MJMAIN-73"><path stroke-width="1"
id="MJMAIN-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path></use><use
xlink:href="#MJMAIN-6F" x="394" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-66" x="895" y="0"><path stroke-width="1" id="MJMAIN-66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path></use><use
xlink:href="#MJMAIN-74" x="1201" y="0"><path stroke-width="1" id="MJMAIN-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path></use><use
xlink:href="#MJMAIN-6D" x="1591" y="0"><path stroke-width="1" id="MJMAIN-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></use><use
xlink:href="#MJMAIN-61" x="2424" y="0"><path stroke-width="1" id="MJMAIN-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></use><use
xlink:href="#MJMAIN-78" x="2925" y="0"><path stroke-width="1" id="MJMAIN-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="5285" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><use
xlink:href="#MJMATHI-57" x="5674" y="0"><path stroke-width="1" id="MJMATHI-57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></use><use
xlink:href="#MJMATHI-78" x="6723" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use><use
xlink:href="#MJMAIN-2B" x="7517" y="0"><path stroke-width="1" id="MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></use><use
xlink:href="#MJMATHI-62" x="8518" y="0"><path stroke-width="1" id="MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></use><use
xlink:href="#MJMAIN-29" x="8948" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g></svg><span
class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 183.312px; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><mtext>softmax</mtext><mo
stretchy="false">(</mo><mi>W</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span></div></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер давайте перейдемо до того, що може використовувати TensorFlow.</p><h2
id="implementing_the_regression" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Реалізація регрессії</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб виконувати ефективні числові обчислення в Python, ми типово використовуємо бібліотеки, як&nbsp;<span></span><a
href="http://www.numpy.org/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">NumPy</a><span>, що виконують коштовні операції, такі, як множення матриць, за межами </span>Python, використовуючи ефективний код на іншій мові. На жаль, все ще може бути багато навантаження від перемикання на Python після кожної операції. Це навантаження особливо погане, якщо ви бажаєте виконувати обчислення на GPU або розподілено, коли є велика ціна передачі даних.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow також робить складні речі за межами Python, але він проувається ще далі, щоб уникнути зайвих навантажень. Замість виконання окремої коштовної операції окремо від Python, TensorFlow дозволяє нам описати граф взаємодіючих операцій, що будуть робити повністю за межами Python. (Підходи як цей можна побачити в декількох бібліотеках машинного навчання).</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб використати TensorFlow, спочатку нам треба імпортувати її.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> tensorflow </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> tf<br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми опишемо ці ітеративні операції через маніпулювання символічними змінними. Давайте створимо таку змінну:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">x </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">None</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">784</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> </span>не є специфічним значенням . Це<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code>, значення, що ми будемо вводити, коли ми запросимо TensorFlow виконати обчислення. Ми бажаємо бути в змозі вводити любу кількість MNIST зображень, кожне в вигляді 784-розмірного вектора. Ми представляємо це як 2-D тензор з числами з плаваючою крапкою розмірністю<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[None, 784]</code>. (Де&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">None</code> означає, що розміртість може бути довільною).</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Нам також знадобляться всі ваги та схилення для нашої моделі. Ми можемо подумки розглядати їх як додаткові вхідні, але TensorFlow має навіть кращий шлях для їх обробки:<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code>.&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code><span> є змінним тензором, що живе в графі </span>TensorFlow взаємодіючих операцій. Він може бути використаний, та навіть модифікований під час обчислення. Для застосувань машинного навчання ви зазавичай моделюєте параметри за допомогою<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">zeros</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">784</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">zeros</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми створюємо ці&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code> через надання&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code><span> початкового значення</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code>: в цьому випадку ми ініціалізуємо обоє,&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code><span>, як тензори, заповнені нулями</span>. Оскільки ми збираємось навчити&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code>, не має значення, чив вони будуть ініційовані.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, що&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> має розмірність</span> [784, 10], оскільки ми бажаємо помножити 784-розмірні вектори зображень для отримання 10-вимірних векторів свідчень для різних класів.<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code><span> </span>має розмірність [10], так що ми можемо додавати його на виході.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми можемо реалізувати нашу модель. Її визначення займає лише один рядок!</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">y </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">softmax</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">matmul</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> W</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> b</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Спершу ми множимо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> на</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> за допомогою вираза</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.matmul(x, W)</code>. Це виглядає перевернутим в порівнянні з використанням в рівнянні, де ми маємо&nbsp;<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="3.765ex" height="2.021ex" viewBox="0 -766.3 1621 870.2"
role="img" focusable="false" style="vertical-align: -0.241ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-57" x="0" y="0"><path stroke-width="1" id="MJMATHI-57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></use><use
xlink:href="#MJMATHI-78" x="1048" y="0"><path stroke-width="1" id="MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi><mi>x</mi></math></span></span>, бо ми робимо малий трюк, де&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> є</span> 2D тензором з багатьма входами. Потім ми додаємо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code>, та нарешті застосовуємо<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.softmax</code>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ось і все. В нас це зайняло однин рядок для визначення моделі, після пари коротких рядків налаштування. Це так, оскільки TensorFlow розроблений щоб зробити софтмакс регрессію особливо простою: це просто дуже гнучкий спосіб описати багато типів числових обчислень, від моделей машинного навчання до фізичних симуляцій. Та коли вже визначена, наша модель може виконуватись на різних пристроях: CPU вашого комп'ютера, GPU, та навіть телефонах!</p><h2
id="training" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Тренування</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб натренувати нашу модель, нам треба визначити, що це значить, що наша модель гарна. Гаразд, насправді в машинному навчанні ми зазвичай визначаємо, що означає, що наша модель погана. Ми називаємо це ціною або втратами, та це представляє, наскільки далеко наша модель від бажаного результату. Ми будемо намагатись мінімізувати цю помилку, та чим менший буде зсув помилки, тим краща наша модель.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Одна з дуже загальних, дуже милих функцій для визначення втрат моделі є так звана "кросс-ентропія". Кросс-ентропія виникла через роздуми щодо кодування конпрессії інформації в теорії інформації, але вона розлетілась, будучи важливою ідеєю, в багато сфер, від азартних ігор до машинного навчання. Вона визначається так:</p><div
style="box-sizing: inherit; margin: 0px; padding: 0px;"><span class="MathJax_Preview"
style="box-sizing: inherit; color: inherit;"></span><div class="MathJax_SVG_Display"
style="box-sizing: inherit; margin: 1em 0em; padding: 0px; text-align: center; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 807px; display: block !important;"><span
class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="24.515ex" height="5.335ex" viewBox="0 -1021.1 10554.9 2296.9"
role="img" focusable="false" style="vertical-align: -2.963ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-48" x="0" y="0"><path stroke-width="1" id="MJMATHI-48" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></use><g
transform="translate(831,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-79"
x="0" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
transform="scale(0.5)" xlink:href="#MJMAIN-2032" x="706" y="408"><path stroke-width="1"
id="MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="1493" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><use
xlink:href="#MJMATHI-79" x="1882" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
xlink:href="#MJMAIN-29" x="2380" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use><use
xlink:href="#MJMAIN-3D" x="3047" y="0"><path stroke-width="1" id="MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></use><use
xlink:href="#MJMAIN-2212" x="4103" y="0"><path stroke-width="1" id="MJMAIN-2212"
d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></use><g
transform="translate(5049,0)"><use xlink:href="#MJSZ2-2211" x="0" y="0"><path stroke-width="1"
id="MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g><g
transform="translate(6660,0)"><use xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1"
id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="706" y="445"><path stroke-width="1"
id="MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-430"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g><g
transform="translate(7661,0)"><use xlink:href="#MJMAIN-6C"><path stroke-width="1"
id="MJMAIN-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path></use><use
xlink:href="#MJMAIN-6F" x="278" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-67" x="779" y="0"><path stroke-width="1" id="MJMAIN-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="8941" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><g
transform="translate(9330,0)"><use xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1"
id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"><path stroke-width="1"
id="MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></use></g><use
xlink:href="#MJMAIN-29" x="10165" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g></svg><span
class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 207.219px; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>H</mi><mrow
class="MJX-TeXAtom-ORD"><msup><mi>y</mi><mo>′</mo></msup></mrow></msub><mo stretchy="false">(</mo><mi>y</mi><mo
stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mi>y</mi><mi>i</mi><mo>′</mo></msubsup><mi>log</mi><mo>⁡</mo><mo
stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Де<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.903ex" viewBox="0 -511.5 497.5 819.3"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><span> </span>є передбачуваний розподіл вірогідностей, та&nbsp;<span> </span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="1.845ex" height="2.613ex" viewBox="0 -817.3 794.5 1125"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="706" y="513"><path stroke-width="1"
id="MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>′</mo></msup></math></span></span><span> </span>є дійсним розподілом (односпрямований вектор з цифровими мітками). В деякому грубому сміслі кросс-ентропія оцінює, наскільки неефективно наші очікування оцінюють дійсний стан. Іти далі до деталей щодо кросс-ентропії за межами нашого розгляду, але її варто&nbsp;<a
href="http://colah.github.io/posts/2015-09-Visual-Information/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">зрозуміти</a>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб реалізувати кросс-ентропію, нам треба спочатку додати новий заміщувач для введення вірних відповідей:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">y_ </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">None</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Потім ми можемо реалізувати функцію кросс-ентропії,<span>&nbsp;</span><span
class="MathJax_Preview" style="box-sizing: inherit; color: inherit;"></span><span
class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;"
role="presentation" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;"><svg
xlink="http://www.w3.org/1999/xlink" width="13.205ex" height="2.613ex" viewBox="0 -817.3 5685.5 1125"
role="img" focusable="false" style="vertical-align: -0.715ex;" aria-hidden="true"><g
stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use
xlink:href="#MJMAIN-2212" x="0" y="0"><path stroke-width="1" id="MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></use><use
xlink:href="#MJSZ1-2211" x="945" y="0"><path stroke-width="1" id="MJSZ1-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></use><g
transform="translate(2168,0)"><use xlink:href="#MJMATHI-79" x="0" y="0"><path stroke-width="1"
id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="706" y="513"><path stroke-width="1"
id="MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path></use></g><g
transform="translate(3129,0)"><use xlink:href="#MJMAIN-6C"><path stroke-width="1"
id="MJMAIN-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path></use><use
xlink:href="#MJMAIN-6F" x="278" y="0"><path stroke-width="1" id="MJMAIN-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path></use><use
xlink:href="#MJMAIN-67" x="779" y="0"><path stroke-width="1" id="MJMAIN-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path></use></g><use
xlink:href="#MJMAIN-28" x="4408" y="0"><path stroke-width="1" id="MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></use><use
xlink:href="#MJMATHI-79" x="4798" y="0"><path stroke-width="1" id="MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></use><use
xlink:href="#MJMAIN-29" x="5295" y="0"><path stroke-width="1" id="MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></use></g></svg><span
class="MJX_Assistive_MathML" role="presentation" style="box-sizing: inherit; top: 0px; left: 0px; clip: rect(1px 1px 1px 1px); user-select: none; position: absolute !important; padding: 1px 0px 0px !important; border: 0px !important; height: 1px !important; width: 1px !important; overflow: hidden !important; display: block !important; transition: none;"><math
xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mo>∑</mo><msup><mi>y</mi><mo>′</mo></msup><mi>log</mi><mo>⁡</mo><mo
stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">cross_entropy </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reduce_mean</span><span
class="pun" style="box-sizing: inherit;">(-</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reduce_sum</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y_ </span><span
class="pun" style="box-sizing: inherit;">*</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">log</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y</span><span
class="pun" style="box-sizing: inherit;">),</span><span class="pln" style="box-sizing: inherit;"> reduction_indices</span><span
class="pun" style="box-sizing: inherit;">=[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Спершу&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.log</code><span> обчислює логарифм кожного елемента&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">y</code>. Далі ми множимо кожний елемент&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">y_</code><span> </span>на відповідний елемент&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.log(y)</code>. Тоді&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.reduce_sum</code><span> додає елементи в другий вимір </span>y, через параметр<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">reduction_indices=[1]</code>. Нарешті,&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.reduce_mean</code><span> обчислює очікування по всім прикладам в пакунку.&nbsp;</span></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, що в джерельному коді ми не використовуєме це формулювання, оскільки воно числово нестабільне. Замість цього ми застосовуємо&nbsp;<code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.softmax_cross_entropy_with_logits</code><span> </span>на ненормалізованих (тобто ми викликаємо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">softmax_cross_entropy_with_logits</code><span> на</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.matmul(x, W) + b</code>), оскільки ця більш числово стабільна функція внутрішньо обчислює софтмакс активацію. В вашому коді використовуйте&nbsp; <span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.softmax_cross_entropy_with_logits</code>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер, коли ми знаємо, що ми бажаємо щоб робила модель, дуже просто змусити TensorFlow натренувати її на це. Оскільки TensorFlow знає цілий граф ваших обчислень, він може автоматично використовувати алгоритм<span> </span><a
href="http://colah.github.io/posts/2015-08-Backprop/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">зворотнього просування (backpropagation)</a> для ефективного визначення, як ваші змінні впливають на втрати, які ми бажаємо мінімізувати. Потім він може застосувати обриний вами алгоритм оптимізації для модифікації змінних та зменшення втрат.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">train_step </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">GradientDescentOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.05</span><span
class="pun" style="box-sizing: inherit;">).</span><span class="pln" style="box-sizing: inherit;">minimize</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">cross_entropy</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В цьому випадку ми просимо TensorFlow мінімізувати<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">cross_entropy</code><span> з використанням&nbsp;</span><span></span><a
href="https://en.wikipedia.org/wiki/Gradient_descent" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">алгоритмі спадаючого градієнта</a><span> </span>з частотою навчання 0.5. Спадання градієнта є простою процедурою, коли TensorFlow просто просуває кожну змінну на невеликий відтінок в напрямку, що зменшує вартість. Але TensorFlow також провадить&nbsp;<span></span><a
href="https://www.tensorflow.org/api_guides/python/train#Optimizers" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">багато інших алгоритмів оптимізації</a>: використати один з них так само просто, як змінити один рядок.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Що насправді тут робить TensorFlow, за лаштунками сцени, це додає нові операції до вашого графа, що реалізують зворотнє просування та знижку градієнта. Потім він повертає єдину операцію, що, коли виконується, робить крок тренування знижки градієнта, трохи підкручуючи змінні для зменшення втрат.&nbsp;</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми можемо запустити модель в&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">InteractiveSession</code>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">sess </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">InteractiveSession</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Спершу ми маємо створити операцію для ініціалізації створених нами змінних:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">global_variables_initializer</span><span
class="pun" style="box-sizing: inherit;">().</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер тренуємо, виконуючи крок тренування 1000 разів!</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> _ </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> range</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; batch_xs</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> batch_ys </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> mnist</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">next_batch</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">100</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">train_step</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> feed_dict</span><span class="pun" style="box-sizing: inherit;">={</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> batch_xs</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> y_</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> batch_ys</span><span class="pun" style="box-sizing: inherit;">})</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">На кожному кроці циклу тренування ми отримуємо "пакунок" з однієї сотні точок даних з нашого тренувального набору. Ми виконуємо&nbsp;&nbsp;<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">train_step</code><span>, подаючи пакунки даних, що заміщують наші </span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code>-и.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Використання малих пакунків випадкових даних називаєтся стохастичним тренуванням, в цьому випадку, стохастичним спадаючим градієнтом. В ідеалі ми б бажали використовувати всі дані на кожному кроці тренування, оскільки це дало б нам краще уявлення, що ми робимо, але це коштовно. Так що замість цього ми використовуємо підмножину кожного разу. Робити це дешево, та має більшість з тих же переваг. Doing this is cheap and has much of the same benefit.</p><h2
id="evaluating_our_model" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Оцінювання нашої моделі</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Наскільки гарно робить наша модель?</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Гаразд, спочатку давайте з'ясуємо, коли ми визначили вірну мітку.&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.argmax</code><span> є вкрай корисною функцією, що надає вам індекс найвищого входження в тензорі по деякій вісі. Наприклад,&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.argmax(y,1)</code><span> є мітка, яку наша модель вважає найбільш вірогідною для кожного вводу, тоді як</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.argmax(y_,1)</code><span> є коректна мітка</span>. Ми можемо використовувати&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.equal</code>для перевірки, чи наше передбачення співпадає з істиною.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">correct_prediction </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">equal</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">argmax</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">),</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">argmax</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y_</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Це дає нам список логічних значень. Щоб визначити, що функція є коректною, ми переводимо це в числа з плаваючою крапкою, та потім беремо очікування. Наприклад, <code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[True, False, True, True]</code><span> стане</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[1,0,1,1]</code><span>, що дасть</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">0.75</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">accuracy </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">reduce_mean</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">cast</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">correct_prediction</span><span class="pun"
style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Нарешті ми запитуємо нашу точність на основі наших тестових даних.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">accuracy</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> feed_dict</span><span
class="pun" style="box-sizing: inherit;">={</span><span class="pln" style="box-sizing: inherit;">x</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> mnist</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">test</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">images</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> y_</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> mnist</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">test</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">labels</span><span
class="pun" style="box-sizing: inherit;">}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Це має бути щось біля 92%.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Чи це добре? Гаразд, насправді ні. Насправді це досить погано. Це через те, що ми використовували дуже просту модель. З деякими малими змінами ми зможемо отримати до 97%. Кращі моделі можуть досягти навіть 99.7% точності! (Для додаткової інформації погляньте на список<a
href="http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"> результатів</a>).</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Що важливе, що ми навчились від цієї моделі. Це раз ,якщо ви відчуваєте себе пригніченим через ці результати, переходьте до&nbsp;<a
href="https://www.tensorflow.org/get_started/mnist/pros" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">наступного туторіала</a><span>, де ми зробимо значно краще</span>, та навчимось, як будувати складні моделі з використанням TensorFlow!</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"></p><h1 itemprop="name"
class="devsite-page-title" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: rgb(117, 117, 117); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Поглиблений MNIST для експертів</h1><div
class="devsite-article-body clearfix
            " itemprop="articleBody" style="box-sizing: inherit; margin: 0px; padding: 0px; color: rgb(33, 33, 33); font-family: Roboto, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow є потужною бібліотекою для виконання маштабних числових обчислень. Одне з завдань, де він неперевершений, є реалізація тренування глибоких нейронних мереж. В цьому керівництві ми вивчимо основні будівельні блоки моделі TensorFlow при конструюванні глибокого конволюційного класифікатора MNIST.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><em style="box-sizing: inherit; font-style: italic;">Цей вступ очікує знайомство з нейронними мережами та набором даних MNIST. Якщо ви не маєте підгрунтя, передивіться&nbsp;<span></span><a
href="https://www.tensorflow.org/get_started/mnist/beginners" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">вступ для початківців</a>. Текож будьте впевнені, що встановили <a
href="https://www.tensorflow.org/install/index" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorFlow</a><span> перед тим, як почати</span>.</em></p><h2
id="about_this_tutorial" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Про це керівництво</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Перша частина цього керівництва пояснює, що відбувається в коді&nbsp;<span></span><a
href="https://www.github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/examples/tutorials/mnist/mnist_softmax.py"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">mnist_softmax.py</a>, що є базовою реалізацією моделі Tensorflow. Друга частина показує деякі шляхи для покращення точності.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ви можете скопіювати та вставити кожний фрагмент з цього туторіала в оточення Python, щоб слідувати за ним, або ви можете завантажити повністю реалізовану глибоку мережу з&nbsp;<span></span><a
href="https://www.github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/examples/tutorials/mnist/mnist_deep.py"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">mnist_deep.py</a><span>&nbsp;</span>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Чого ми досягнемо в цьому туторіалі:</p><ul
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Створимо функцію софтмакс регрессії, що є моделлю для різпізнання цифр MNIST, базуючись на вивченні кожного пікселя зображення</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Використаємо Tensorflow для тренування моделі для розпізнавання цифр, через "погляд" на тисячі прикладів (та виконання для цього нашої першої сессії Tensorflow)</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Перевіримо точність моделі нашими тестовими даними</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Побудуємо, натренуємо, та протестуємо багаторівневу нейронну мережу для покращення наших результатів</p></li></ul><h2
id="setup" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Налаштування</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Перед тим, як ми створимо нашу модель, ми спочатку завантажимо набір даних MNIST, та розпочнемо сессію TensorFlow.</p><h3
id="load_mnist_data" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Завантажуємо дані MNIST</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Якщо ви копіюєте та вставляєте код з цього туторіала, почніть з ціх двох рядків кода, що завантажать та прочитають дані автоматично:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">from</span><span
class="pln" style="box-sizing: inherit;"> tensorflow</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">examples</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">tutorials</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">mnist </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> input_data<br style="box-sizing: inherit;">mnist </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> input_data</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">read_data_sets</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'MNIST_data'</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> one_hot</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">True</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тут&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist</code><span> є легковажний клас, що зберігає набори тренування, валідації та тестування як масиви </span>NumPy. Він також провадить функцію для ітерацій по мініпакунках даних, що буде використаний нижче.&nbsp;</p><h3
id="start_tensorflow_interactivesession" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Запуск інтерактивної сессії TensorFlow</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow покладається на вкрай ефективний бекенд C++ для виконання власних обчислень. З'єднання з бекендом називаєтсья сессією. Загальне використання для програм TensorFlow є зпершу створити граф, та потім виконати його.&nbsp;</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тут ми замість цього використаємо зручний клас&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">InteractiveSession</code>, що робить TensorFlow більше гнучким щодо того, як ви структуруєте код. Це також дозволяє вам перепішувати операції, що побудовують&nbsp;<span></span><a
href="https://www.tensorflow.org/get_started/get_started#the_computational_graph"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">граф обчислень<span
style="color: #212121;">, з виконанням графа. Це особливо зручно при роботі в інтерактивних контекстах, як </span></a>IPython. Якщо ви не використовуєте&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">InteractiveSession</code>, тоді ви повинні побудувати повний граф обчислень перед початком сесіії, та&nbsp;<a
href="https://www.tensorflow.org/get_started/get_started#the_computational_graph"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">запустіть граф.</a></p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">import</span><span
class="pln" style="box-sizing: inherit;"> tensorflow </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> tf<br style="box-sizing: inherit;">sess </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">InteractiveSession</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h4 id="computation_graph" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 18px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Граф обчислень</h4><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб виконувати ефективні обчислення в Python, ми типово використовуємо бібліотеки, як&nbsp;<span></span><a
href="http://www.numpy.org/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">NumPy</a><span>, що виконують коштовні операції, такі, як множення матриць, за межами </span>Python, виконуючи високо ефективний код, реалізований в іншій мові. На жаль, також може бути багато втрат від перемикань назад до Python на кожній операції. Ці втрати особливо погані, якщо ви бажаєте виконувати операції на GPU, або в розподілений спосіб, коли може бути високою ціна передачі даних.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow також виконує складні операції за межами Python, але він іде далі, щоб уникнути зайвого навантаження. Замість виконання однієї коштовної операції незалежно від Python, TensorFlow дозволяє нам описати граф взаємодіючих операцій, що роблять повністю за межами Python. Цей підхід подібний до тих, що використовуються в Theano або Torch.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Роль кода Python, таким чином, це побудова цьго зовнішнього графа обчислень, та задавати, які частини графа обчислень повинно виконувати. Дивіться розділ<span> </span><a
href="https://www.tensorflow.org/get_started/get_started#the_computational_graph"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Граф обчислень&nbsp;</a><span></span>з<span> </span><a
href="https://www.tensorflow.org/get_started/get_started" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Починаємо робити з TensorFlow</a><span> щодо додаткових деталей</span>.</p><h2
id="build_a_softmax_regression_model" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Побудова моделі софтмакс регрессії</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">В цьому розділі ми побудуємо модель софтмакс регрессії з поодиноким лінійним шаром. В наступному розділі ми будемо розширювати її до випадку софтмакс регрессії з багатошаровою конволюційною мережою.</p><h3
id="placeholders" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Заміщувачі</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми почнемо побудову графа обчислень зі створення вузлів для вхідних зображень та цільових вихідних класів.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">x </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> shape</span><span class="pun" style="box-sizing: inherit;">=[</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">None</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">784</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">y_ </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> shape</span><span class="pun" style="box-sizing: inherit;">=[</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">None</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тут&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">y_</code><span> не є специфічними значеннями. Скоріше, кожне з них є&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code><span>&nbsp;</span>-- значення, що ми будемо вводити, коли ми попросимо TensorFlow виконати обчислення.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Вхідні зображення&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> будуть складатись з </span>2d тензора чисел з плаваючою крапкою. Ми присвоюємо йому<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">shape</code><span> </span>розміром&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[None, 784]</code>, де<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">784</code><span> є розмірність для кожного спрямленого зображення </span><span>MNIST </span>28 на 28 пікселів, та<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">None</code><span> вказує, що перша розмірність, що відповідає за розмів пакунку, може бути любого розміру. Цільовий вихідний клас&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">y_</code><span> буде також складатись з </span>2d тензора, де кожний рядок є одномісним 10-розмірним вектором, що вказує, який клас цифри (від нуля до дев'яти) відповідає відповідному MNIST зображенню.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Аргумент&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">shape</code><span> до&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code><span> є опціональним, але він дозволяє </span>TensorFlow автоматично відловлювати помилки, що походять від несумісності форм тензорів.</p><h3
id="variables" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Змінні</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми визначаємо ваги&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> та схильності&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code><span> для нашої моделі</span>. Ми можемо розглядати їх як додаткові вхідні зничення, але TensorFlow має навіть кращий спосіб обробляти їх:<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code>.&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code><span> є значенням, що живе в графі обчислень </span>TensorFlow. Вони можуть бути використані та навіть модифіковані в процесі обчислень. В застосунках машинного навчання ви будете мати параметри моделі в вигляді&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">zeros</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">784</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">zeros</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">]))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми передаємо початкові значенян для кожного параметра в виклику для&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code>. В цьому випадку ми ініціалізуємо обоє,&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code> як тензори, заповнені нулями.<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">W</code><span> </span>є матрицею 784x10 (оскільки ми маємо 784 вхідних властивостей та 10 виходів), та&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code><span> </span>є 10-вимірним вектором (оскільки ми маєте 10 класів).</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Перед тим, як&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code> може бути використане в сессії, вони повинні бути ініціалізовані з використанням цієї сессії. Цей крок приймає початкові значення (в цьому випадку це тензори, заповнені нулями), що вже задані, присвоюються до кожної <code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variable</code>. Це може бути зроблене для всіх&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Variables</code><span> разом</span>:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">global_variables_initializer</span><span
class="pun" style="box-sizing: inherit;">())</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h3 id="predicted_class_and_loss_function"
style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Прогнозований клас та функція втрати</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми можемо реалізувати регресійну модель. Вона займає всього один рядок! Ми множимо векторизований ввод зображень&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> на матрицю ваг, та додаємо схильність&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">b</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">y </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">matmul</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;">W</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> b<br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми можемо задати функцію втрат майже так же просто. Втрата означає, наскільки погана точність моделі для окремого приклада; ми намагаємось мінімізувати це значення на протязі всіх експериментів. Тут наша функція втрат є кросс-ентропією між ціллю, та функцією софтмакс активації, застосованої до прогнозованої моделі. Як і в керівництві для початківців, ми використовуємо стабільну функцію:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">cross_entropy </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reduce_mean</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">softmax_cross_entropy_with_logits</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">labels</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">y_</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> logits</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">y</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зауважте, що&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.softmax_cross_entropy_with_logits</code><span> зсередини застосовує софтмакс до прогнозу моделі для ненормалізованої моделі, та підсумовує по всіх класах, та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.reduce_mean</code><span> приймає середньє по всім цім сумам</span>.</p><h2
id="train_the_model" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Тренування моделі</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер, коли ми визначили нашу модель та функцію втрат тренування, є прямолінійним для тренування з використанням TensorFlow. Оскільки TensorFlow знає весь граф обчислень, він може автоматично диференцювати для пошуку градієнтів втрат з точки зору змінних. TensorFlow має різноманітні&nbsp;<span></span><a
href="https://www.tensorflow.org/api_guides/python/train#optimizers" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">вбудовані алгоритми оптимізації</a>. Наприклад, ми будемо використовувати крутіший градієнтний спуск, з довжиною кроку 0.5, щоб зменшити кросс-ентропію.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">train_step </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">GradientDescentOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.5</span><span
class="pun" style="box-sizing: inherit;">).</span><span class="pln" style="box-sizing: inherit;">minimize</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">cross_entropy</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Що насправді зробив TensorFlow в цьому окремому рядку, це додав нові оператори до графа обчислень. Ці оператори включають дещо для обчислень градієнтів, обчислення кроків оновлення параметрів, та застосування оновлення кроків до параметрів.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Повернута операція, <span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">train_step</code>, при виконанні буде застосовувати оновлення спадаючого градієнта до параметрів. Таким чином, тренування моделі може бути досягнено через повторне виконання&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">train_step</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> _ </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> range</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1000</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; batch </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> mnist</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">next_batch</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">100</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; train_step</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">feed_dict</span><span class="pun" style="box-sizing: inherit;">={</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> batch</span><span class="pun" style="box-sizing: inherit;">[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> y_</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> batch</span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">]})</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми завантажили 100 треновочних прикладів в кожній треновачній ітерації. Потім ми виконуємо операцію<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">train_step</code>, використовуючи<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">feed_dict</code><span> для заміщення&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code><span> тензорів</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> та</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">y_</code><span> на тренувальні приклади</span>. Зауважте, що ви можете замінити любий тензор в вашому графі обчислення, використовуючи&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">feed_dict</code><span>&nbsp;</span>-- це не обмежується тільки<span> до </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code>.</p><h3
id="evaluate_the_model" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Обчислення моделі</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Наскільки гарна наша модель?</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Спершу, ми уявимо собі, де ми спрогнозували коректну мітку.&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.argmax</code><span> є вкрай корисною функцією, що дає вам індекс найвищого елемента в тензорі по заданій вісі. Наприклад,&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.argmax(y,1)</code><span> </span>є міткою нашої моделі, найбільш вірогідною для кожного входу, тоді як&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.argmax(y_,1)</code><span> є вірна мітка. Ми можемо використати&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.equal</code><span> для перевірки, чи наше передбачення співпадає з правдою.&nbsp;</span></p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">correct_prediction </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">equal</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">argmax</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">),</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">argmax</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y_</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Це дає нам список логічних значень. Для визначення, що функція коректна, ми перетворюємо число з плаваючою крапкою, та оптім беремо очікування. Наприклад,<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[True, False, True, True]</code><span> перетвориться на</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[1,0,1,1]</code><span>, що дає&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">0.75</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">accuracy </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">reduce_mean</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">cast</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">correct_prediction</span><span class="pun"
style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Нарешті, ми обчислюємо нашу точність на тестових даних. Це повинно дати близько 92% вірних.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">accuracy</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">eval</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">feed_dict</span><span
class="pun" style="box-sizing: inherit;">={</span><span class="pln" style="box-sizing: inherit;">x</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> mnist</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">test</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">images</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> y_</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> mnist</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">test</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">labels</span><span
class="pun" style="box-sizing: inherit;">}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h2 id="build_a_multilayer_convolutional_network"
style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Побудова багатошарової конволюційної мережіBuild a Multilayer Convolutional Network</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Отримані 92% точності на MNIST є поганим. Це майже незручно погано. В цьому розділі ми виправимо це, перестрибнувши від дуже простої моделі до дечого помірно складного: невеличкої конволюційної нейронної мережі. Це дасть нам близько 99.2% точності -- не витвір мистецтва, але пристойно.</p><h3
id="weight_initialization" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Ініціалізація ваги</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Для створення цієї моделі ми збираємось створити багато ваг та схильностей. Ми повинні загалом ініціалізувати ваги невеликою кількістю шуму для руйнування симметричності, та для виключення нульових градієнтів. Оскільки ми використовуємо&nbsp;<span> </span><a
href="https://en.wikipedia.org/wiki/Rectifier_%28neural_networks%29" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">ReLU</a> нейрони, також є гарною практикою ініціалізувати їх трохи позитивним схилом, щоб уникнити "мертвих нейронів". Замість робибти це постійно, доки ми будуємо модель, давайте створимо дві корисні функції, щоб це робилось за нас.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">def</span><span
class="pln" style="box-sizing: inherit;"> weight_variable</span><span class="pun"
style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">shape</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; initial </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">truncated_normal</span><span class="pun"
style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">shape</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> stddev</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.1</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">return</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">initial</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="kwd"
style="box-sizing: inherit; color: rgb(59, 120, 231);">def</span><span class="pln"
style="box-sizing: inherit;"> bias_variable</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">shape</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; initial </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">constant</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> shape</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">shape</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">return</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">initial</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h3 id="convolution_and_pooling"
style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Конволюція та пули</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">TensorFlow також дає нам багато гнучкості в операціях конволюціі та створені пулів. Як ми будемо обробляти границі? Який буде розмір кроку? В цьому прикладі, ми завжди збираємось обирати ванільну версію. Наші конволюції використовують крок рівний одному, та відступи нуль, так що віхід буде того ж розміру, що і вхід. Наш пулінг є старий добрий максимальний пулінг по блоках 2x2. Щоб утримувати наш код простішим, давайте також абстрагуємо ці операції в функції.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">def</span><span
class="pln" style="box-sizing: inherit;"> conv2d</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> W</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; </span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">return</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">conv2d</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> W</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> strides</span><span class="pun" style="box-sizing: inherit;">=[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> padding</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'SAME'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">def</span><span
class="pln" style="box-sizing: inherit;"> max_pool_2x2</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; </span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">return</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">max_pool</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> ksize</span><span class="pun" style="box-sizing: inherit;">=[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strides</span><span
class="pun" style="box-sizing: inherit;">=[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> padding</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'SAME'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h3 id="first_convolutional_layer"
style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Перший рівень конволюції</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ми можемо реалізувати наш перший рівень. Він буде складатись з конволюції, за яким буде виконуватись максимальний пулінг. Конволюція буде обчислювати 32 властивості для кожних патчів 5x5. Його тензор ваги має розмір&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[5, 5, 1, 32]</code>. Перші дві розмірності є розмір патчу, далі іде число вхідних каналів, та останній є число вихідних каналів. Ми також маємо вектор схилення з компонентом для кожного каналу.&nbsp;</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W_conv1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> weight_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">32</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b_conv1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> bias_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">32</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб застосувати слой, спочатку перетворимо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x</code><span> на тензор</span> 4d, з другою та четвертою розмірностями відповідними до ширини та висоти зображеня, та останнє число відповідає каналу кольору.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">x_image </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">reshape</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">[-</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">28</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">28</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Потім ми конволюємо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">x_image</code><span> тензором ваги, додаємо схильність, застосовуємо функцію </span>ReLU, та нарешті макс пул. Метод&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">max_pool_2x2</code><span> буде зменшувати розмір зображення до </span>14x14.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">h_conv1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">relu</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">conv2d</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">x_image</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> W_conv1</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> b_conv1</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">h_pool1 </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> max_pool_2x2</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">h_conv1</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h3 id="second_convolutional_layer"
style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Другий рівень конволюції</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб побудувати глибшу мережу, ми накладемо декілька шарів такого типу. Другий шар буде мати 64 властивостей для кожного патча 5x5.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W_conv2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> weight_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">5</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">32</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">64</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b_conv2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> bias_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">64</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;">h_conv2 </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">nn</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">relu</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">conv2d</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">h_pool1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> W_conv2</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">+</span><span class="pln" style="box-sizing: inherit;"> b_conv2</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">h_pool2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> max_pool_2x2</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">h_conv2</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><h3
id="densely_connected_layer" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Щільно пов'язаний шар</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер, коли розмір зображення зменшився до 7x7, ми додамо повністю пов'язаний рівень з 1024 нейронами, щоб дозволити обробку всього зображення. Ми змінимо форму тензора з рівня пулінга в пакунок векторів, помножимо на матрицю векторів, додами схильність, та застосуємо ReLU.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W_fc1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> weight_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">*</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">*</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">64</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1024</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b_fc1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> bias_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1024</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;">h_pool2_flat </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reshape</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">h_pool2</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">[-</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7</span><span
class="pun" style="box-sizing: inherit;">*</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">7</span><span
class="pun" style="box-sizing: inherit;">*</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">64</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">h_fc1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">relu</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">matmul</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">h_pool2_flat</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> W_fc1</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> b_fc1</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><h4
id="dropout" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 18px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Відсічення</h4><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Щоб зменшити переобладнання, ми застосуємо&nbsp;<span></span><a
href="https://www.cs.toronto.edu/%7Ehinton/absps/JMLRdropout.pdf" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">відсічення</a><span> </span>перед рівнем зчитування. Ми створимо&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder</code><span> для вірогідності того, що вивід нейрону буде збережений під час відсічення</span>. Це дозволить нам ввімкнути відсічення під час тренування, та відключити його під час тренування. Операція TensorFlow<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.dropout</code><span> автоматично обробляє маштабування виводів нейронів на додаток до їх маскування</span>, так що відсічення робить без додаткового маштабування. <sup
id="a1" style="box-sizing: inherit; line-height: 1;"><a href="https://www.tensorflow.org/get_started/mnist/pros#f1"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">1</a></sup></p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">keep_prob </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">float32</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">h_fc1_drop </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">nn</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">dropout</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">h_fc1</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> keep_prob</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h3 id="readout_layer" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Рівень зчитування</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Нарешті, ми додамо рівень, такий самий, як для софтмакс регрессії вище.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">W_fc2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> weight_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1024</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">b_fc2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> bias_variable</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">10</span><span
class="pun" style="box-sizing: inherit;">])</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;">y_conv </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">matmul</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">h_fc1_drop</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> W_fc2</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="pun" style="box-sizing: inherit;">+</span><span class="pln" style="box-sizing: inherit;"> b_fc2<br
style="box-sizing: inherit;"></span></code></pre><h3 id="train_and_evaluate_the_model"
style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Тренування та оцінування моделі</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Як гарно поводиться наша мережа? Щоб натренувати та оцінити її, ми будемо використовувати код, що майже ідентичний до того, що був для простої моделі мережі SoftMax вище.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Різниця в наступному:</p><ul
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: disc outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Ми замінимо крутіший оптимізатор  the steepest gradient descent optimizer with the more sophisticated ADAM optimizer.</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Ми включимо додатковий параметр&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">keep_prob</code><span> в</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">feed_dict</code><span> для контроля рівня відсічення</span>.</p></li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><p style="box-sizing: inherit; margin: 0px; padding: 0px;">Ми будемо додавати журналювання до кожної 100ї ітерації в процес тренування.</p></li></ul><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми також будемо використовувати tf.Session, скоріше ніж tf.InteractiveSession. Це краще розділяє процес створення графа (задання моделі), та процес обчислення графа (підгонка моделі). Це загалом дає чистіший код. tf.Session створюється в&nbsp;<span></span><a
href="https://docs.python.org/3/whatsnew/2.6.html#pep-343-the-with-statement" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">with</code><span> блоці</span></a><span>, так що він автоматично зруйнується, коли здійснеться вихід з блоку</span>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Тепер ви можете виконати цей код. Майте на увазі, що він виконує 20 тисяч ітерацій тренування, та може тривати деякий час (можливо до пів години часу), в залежності від процесора.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">cross_entropy </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">reduce_mean</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">softmax_cross_entropy_with_logits</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">labels</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">y_</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> logits</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">y_conv</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">train_step </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">AdamOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1e-4</span><span
class="pun" style="box-sizing: inherit;">).</span><span class="pln" style="box-sizing: inherit;">minimize</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">cross_entropy</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">correct_prediction </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">equal</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">argmax</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">y_conv</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">),</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">argmax</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">y_</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">accuracy </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">reduce_mean</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">cast</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">correct_prediction</span><span class="pun"
style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span><span class="kwd"
style="box-sizing: inherit; color: rgb(59, 120, 231);">with</span><span class="pln"
style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Session</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> sess</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">global_variables_initializer</span><span
class="pun" style="box-sizing: inherit;">())</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> i </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> range</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">20000</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; batch </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> mnist</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">next_batch</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">50</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">if</span><span
class="pln" style="box-sizing: inherit;"> i </span><span class="pun" style="box-sizing: inherit;">%</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">100</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">==</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; train_accuracy </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> accuracy</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">eval</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">feed_dict</span><span
class="pun" style="box-sizing: inherit;">={</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x</span><span class="pun"
style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> batch</span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> y_</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> batch</span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> keep_prob</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.0</span><span
class="pun" style="box-sizing: inherit;">})</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'step %d, training accuracy %g'</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">%</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">i</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> train_accuracy</span><span class="pun"
style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; train_step</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">feed_dict</span><span class="pun" style="box-sizing: inherit;">={</span><span
class="pln" style="box-sizing: inherit;">x</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> batch</span><span class="pun" style="box-sizing: inherit;">[</span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> y_</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> batch</span><span
class="pun" style="box-sizing: inherit;">[</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"> keep_prob</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0.5</span><span
class="pun" style="box-sizing: inherit;">})</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; </span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'test accuracy %g'</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">%</span><span
class="pln" style="box-sizing: inherit;"> accuracy</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">eval</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">feed_dict</span><span
class="pun" style="box-sizing: inherit;">={</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; x</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> mnist</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">test</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">images</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> y_</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> mnist</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">test</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">labels</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> keep_prob</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.0</span><span
class="pun" style="box-sizing: inherit;">}))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Останній набір тестів після виконання цього кода повинен бути біля 99.2%.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ми тільки що навчились, як швидко будувати, тренувати та оцінювати досить складну модель глибокого навчання з використанням TensorFlow.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><b id="f1" style="box-sizing: inherit;">1</b>: Для цієї малої конволюційної мережі, продуктивність насправді майже ідентична з відсіченням та без. Відсічення часто дуже ефективне для зменшення переобладнання, але воно найбільше корисне, коли тренуються дуже великі нейронні мережі.<span> </span><a
href="https://www.tensorflow.org/get_started/mnist/pros#a1" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">↩</a></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"></p><h1 itemprop="name"
class="devsite-page-title" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; color: rgb(117, 117, 117); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 34px; line-height: 40px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 0px 0px 20px; position: relative; top: -4px; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">TensorFlow механіка 101</h1><div
class="devsite-article-body clearfix
            " itemprop="articleBody" style="box-sizing: inherit; margin: 0px; padding: 0px; color: rgb(33, 33, 33); font-family: Roboto, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Код:<span>&nbsp;</span><a
href="https://www.github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/examples/tutorials/mnist/"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">tensorflow/examples/tutorials/mnist/</a></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ціль цієї інструкції є показати, як використовувати TensorFlow для тренування та оцінювання простої просувай-вперед нейронної мережі для класифікації рукописних цифр, використовуючи (класичний) набір даних MNIST. Призначена аудиторія для цієї інструкції є досвідчені користувачі з машинного навчання, що цікавляться TensorFlow.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ці інструкції не призначені для навчання машинному навчанню загалом.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Будь ласка переконайтесь, що ви слідували інструкціям по&nbsp;<span></span><a
href="https://www.tensorflow.org/install/index" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">встановленню TensorFlow</a>.</p><h2
id="tutorial_files" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Файли інструкції</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Ця інструкція посилається на наступні файли:</p><div
class="devsite-table-wrapper" style="box-sizing: inherit; margin: 16px 0px; padding: 0px; overflow: auto;"><table
style="box-sizing: inherit; border: 0px; border-collapse: collapse; border-spacing: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: Roboto, sans-serif; margin: 0px; width: 807px;"><thead
style="box-sizing: inherit;"><tr style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><th
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 16px; line-height: 24px; font-family: Roboto, sans-serif; height: 48px; padding: 8px; vertical-align: middle; color: rgb(255, 255, 255);">Файл</th><th
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 16px; line-height: 24px; font-family: Roboto, sans-serif; height: 48px; padding: 8px; vertical-align: middle; color: rgb(255, 255, 255);">Призначення</th></tr></thead><tbody
style="box-sizing: inherit;"><tr style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;"><a
href="https://www.github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/examples/tutorials/mnist/mnist.py"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none; margin-top: 0px; margin-bottom: 0px;"><code
style="box-sizing: inherit; background: 0px center; color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal; -webkit-font-smoothing: auto;">mnist.py</code></a></td><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;">Код для побудови повністю поєднаної моделі MNIST.</td></tr><tr
style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;"><a
href="https://www.github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/examples/tutorials/mnist/fully_connected_feed.py"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none; margin-top: 0px; margin-bottom: 0px;"><code
style="box-sizing: inherit; background: 0px center; color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal; -webkit-font-smoothing: auto;">fully_connected_feed.py</code></a></td><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;">Наступний код для тренування побудованої моделі MNIST на завантажених наборах даних на базі словника подачі.</td></tr></tbody></table></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Просто виконайте файл<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">fully_connected_feed.py</code><span> напряму для початку тренування</span>:</p><pre
class="prettyprint lang-bash" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">python fully_connected_feed</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">py<br
style="box-sizing: inherit;"></span></code></pre><h2 id="prepare_the_data" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Підготовка даних</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">MNIST є класичною проблемою машинного навчання. Проблема є в перегляді сірих зображень, розміром 28x28 пікселів, де зображені рукописні цифри, та визначити, які цифри вони представляють, для всіх цифер від нуля до дев'яти.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><img alt="MNIST Digits"
src="https://www.tensorflow.org/images/mnist_digits.png" data-tooltip-align="b,c"
data-tooltip="MNIST Digits" aria-label="MNIST Digits" data-title="MNIST Digits"
style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%;"></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Для додаткової інформації звертайтесь до&nbsp;<span></span><a
href="http://yann.lecun.com/exdb/mnist/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">сторінки Yann LeCun's MNIST</a><span> або</span><span> </span><a
href="http://colah.github.io/posts/2014-10-Visualizing-MNIST/" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Chris Olah's візуалізацій MNIST</a>.</p><h3
id="download" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Завантаження</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Зверху метода<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">run_training()</code>, функція&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">input_data.read_data_sets()</code><span> переконається, що коректний набір даних був завертажений в вашу локальну теку , та потім розпаковує ці дані, щоб повернути директорію примірників</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">DataSet</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">data_sets </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> input_data</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">read_data_sets</span><span class="pun"
style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">FLAGS</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">train_dir</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> FLAGS</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">fake_data</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><strong
style="box-sizing: inherit; font-weight: bold;">ЗАУВАЖЕННЯ</strong>: Флаг<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">fake_data</code><span> </span>використовується для цілей юніт-тестування, та може бути безпечно ігнорований читачем. </p><div
class="devsite-table-wrapper" style="box-sizing: inherit; margin: 16px 0px; padding: 0px; overflow: auto;"><table
style="box-sizing: inherit; border: 0px; border-collapse: collapse; border-spacing: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: Roboto, sans-serif; margin: 0px; width: 807px;"><thead
style="box-sizing: inherit;"><tr style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><th
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 16px; line-height: 24px; font-family: Roboto, sans-serif; height: 48px; padding: 8px; vertical-align: middle; color: rgb(255, 255, 255);">Набір даних</th><th
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 16px; line-height: 24px; font-family: Roboto, sans-serif; height: 48px; padding: 8px; vertical-align: middle; color: rgb(255, 255, 255);">Призначення</th></tr></thead><tbody
style="box-sizing: inherit;"><tr style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;"><code
style="box-sizing: inherit; background: 0px center; color: rgb(33, 33, 33); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal; -webkit-font-smoothing: auto; margin-top: 0px; margin-bottom: 0px;"><span
style="box-sizing: inherit;">data_sets.<wbr style="box-sizing: inherit;">train</span></code></td><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;">55000 зображень та міток для первинного тренування</td></tr><tr
style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;"><code
style="box-sizing: inherit; background: 0px center; color: rgb(33, 33, 33); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal; -webkit-font-smoothing: auto; margin-top: 0px; margin-bottom: 0px;"><span
style="box-sizing: inherit;">data_sets.<wbr style="box-sizing: inherit;">validation</span></code></td><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;">5000 зображень та міток для ітеративної валідації точності тренування</td></tr><tr
style="box-sizing: inherit; background: rgb(120, 144, 156); border-width: 1px 0px 0px; border-right-style: initial; border-bottom-style: initial; border-left-style: initial; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image: initial; border-top-style: solid; border-top-color: rgb(207, 216, 220);"><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;"><code
style="box-sizing: inherit; background: 0px center; color: rgb(33, 33, 33); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal; -webkit-font-smoothing: auto; margin-top: 0px; margin-bottom: 0px;"><span
style="box-sizing: inherit;">data_sets.<wbr style="box-sizing: inherit;">test</span></code></td><td
style="box-sizing: inherit; border: 0px; margin: 0px; text-align: left; color: rgb(33, 33, 33); padding: 7px 8px 8px; background: rgba(255, 255, 255, 0.95); vertical-align: top;">10000 зображень та міток для заключного тестування точності тренування</td></tr></tbody></table></div><h3
id="inputs_and_placeholders" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Входи та замісники</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Функція&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">placeholder_inputs()</code><span> створює дві опції&nbsp;</span><span></span><a
href="https://www.tensorflow.org/api_docs/python/tf/placeholder" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.placeholder</code></a><span>, що визначає розмір входів, включаючи&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">batch_size</code>, для залишку графа, та в якому буде відбуватись справжнє тренування.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">images_placeholder </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">placeholder</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">float32</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> shape</span><span
class="pun" style="box-sizing: inherit;">=(</span><span class="pln" style="box-sizing: inherit;">batch_size</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mnist</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">IMAGE_PIXELS</span><span
class="pun" style="box-sizing: inherit;">))</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">labels_placeholder </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">placeholder</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">int32</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> shape</span><span class="pun" style="box-sizing: inherit;">=(</span><span
class="pln" style="box-sizing: inherit;">batch_size</span><span class="pun" style="box-sizing: inherit;">))</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Далі нижче, в циклі тренування, база даних цілих зображень та міток нарізаються, щоб поміщатись в&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">batch_size</code><span> для кожного кроку, співпадаючи з ціми замісниками, та потім передаються в функцію&nbsp;</span><span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">sess.run()</code><span> з використанням параметра</span><span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">feed_dict</code>.</p><h2
id="build_the_graph" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Побудова графа</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Після створення замісників для даних, граф будується з файлу&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.py</code><span>, відповідно до </span>3-крокового шаблону:<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">inference()</code>,<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">loss()</code>, та<span> </span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">training()</code>.</p><ol
style="box-sizing: inherit; margin: 0px; padding-left: 40px; list-style: decimal outside;"><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><code style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">inference()</code><span>&nbsp;</span>- Будує граф так само, як потребує для виконання марежі, щоб робити передбачення.</li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><code style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">loss()</code><span>&nbsp;</span>- Додає графи виводу, потрібні для генерації втрат.&nbsp;</li><li
style="box-sizing: inherit; margin: 8px 0px; padding: 0px;"><code style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">training()</code><span>&nbsp;</span>- Додає граф втрат, потрібний для обчислення та застосування градієнтів.</li></ol><div
style="box-sizing: inherit; margin: 20px auto 10px; padding: 0px; width: 766.641px;"><img
src="https://www.tensorflow.org/images/mnist_subgraph.png" style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%; width: 766.641px;"></div><h3
id="inference" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Вивід</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Функція&nbsp;<span></span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">inference()</code><span>будує граф настільки, як треба до повернення тензора, що буде містити передбаченя виводу.&nbsp;</span></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Вона приймає зображення на вхід, та будує зверху нього пару повністю пов'язаних рівнів за допомогою&nbsp;<span></span><a
href="https://en.wikipedia.org/wiki/Rectifier_%28neural_networks%29" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">ReLU</a> активації, за якою слідує десятивузловий лінійний рівень, що вказує на вихідні накопичувачі.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Кожний рівень створений під унікальним <span></span><a
href="https://www.tensorflow.org/api_docs/python/tf/name_scope" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.name_scope</code></a><span>, що діє як префікс для елементів, створених в цьому просторі</span>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">with</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">name_scope</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'hidden1'</span><span
class="pun" style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Within the defined scope, the weights and biases to be used by each of these layers are generated into<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/Variable" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code></a><span>&nbsp;</span>instances, with their desired shapes:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">weights </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">truncated_normal</span><span class="pun"
style="box-sizing: inherit;">([</span><span class="pln" style="box-sizing: inherit;">IMAGE_PIXELS</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> hidden1_units</span><span
class="pun" style="box-sizing: inherit;">],</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stddev</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1.0</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">/</span><span
class="pln" style="box-sizing: inherit;"> math</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">sqrt</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">float</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">IMAGE_PIXELS</span><span
class="pun" style="box-sizing: inherit;">))),</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; name</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'weights'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">biases </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">zeros</span><span
class="pun" style="box-sizing: inherit;">([</span><span class="pln" style="box-sizing: inherit;">hidden1_units</span><span
class="pun" style="box-sizing: inherit;">]),</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'biases'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">When, for instance, these are created under the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">hidden1</code><span>&nbsp;</span>scope, the unique name given to the weights variable would be "<code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">hidden1/weights</code>".</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Each variable is given initializer ops as part of their construction.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">In this most common case, the weights are initialized with the<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/truncated_normal" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.truncated_normal</code></a><span>&nbsp;</span>and given their shape of a 2-D tensor with the first dim representing the number of units in the layer from which the weights connect and the second dim representing the number of units in the layer to which the weights connect. For the first layer, named<code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">hidden1</code>, the dimensions are<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[IMAGE_PIXELS, hidden1_units]</code><span>&nbsp;</span>because the weights are connecting the image inputs to the hidden1 layer. The<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.truncated_normal</code><span>&nbsp;</span>initializer generates a random distribution with a given mean and standard deviation.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Then the biases are initialized with<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/zeros" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.zeros</code></a><span>&nbsp;</span>to ensure they start with all zero values, and their shape is simply the number of units in the layer to which they connect.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The graph's three primary ops -- two<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/nn/relu" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.relu</code></a><span>&nbsp;</span>ops wrapping<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/matmul" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.matmul</code></a><span>&nbsp;</span>for the hidden layers and one extra<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.matmul</code><span>&nbsp;</span>for the logits -- are then created, each in turn, with separate<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code><span>&nbsp;</span>instances connected to each of the input placeholders or the output tensors of the previous layer.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">hidden1 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">relu</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">matmul</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">images</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> weights</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> biases</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">hidden2 </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">relu</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">matmul</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">hidden1</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> weights</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> biases</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">logits </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">matmul</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">hidden2</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> weights</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">+</span><span
class="pln" style="box-sizing: inherit;"> biases<br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Finally, the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">logits</code><span>&nbsp;</span>tensor that will contain the output is returned.</p><h3
id="loss" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Loss</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">loss()</code><span>&nbsp;</span>function further builds the graph by adding the required loss ops.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">First, the values from the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">labels_placeholder</code><span>&nbsp;</span>are converted to 64-bit integers. Then, a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/nn/sparse_softmax_cross_entropy_with_logits"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.sparse_softmax_cross_entropy_with_logits</code></a><span>&nbsp;</span>op is added to automatically produce 1-hot labels from the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">labels_placeholder</code><span>&nbsp;</span>and compare the output logits from the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">inference()</code><span>&nbsp;</span>function with those 1-hot labels.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">labels </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">to_int64</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">labels</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">cross_entropy </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">nn</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">sparse_softmax_cross_entropy_with_logits</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; labels</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">labels</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> logits</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">logits</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> name</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'xentropy'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">It then uses<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/reduce_mean" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.reduce_mean</code></a><span>&nbsp;</span>to average the cross entropy values across the batch dimension (the first dimension) as the total loss.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">loss </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">reduce_mean</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">cross_entropy</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> name</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'xentropy_mean'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">And the tensor that will then contain the loss value is returned.</p><blockquote
style="box-sizing: inherit; background: rgb(247, 247, 247); margin: 16px 0px; padding: 8px; quotes: none;"><aside
class="note" style="box-sizing: inherit; display: block; font-size: 14px; margin: 0px; padding: 12px 24px 12px 60px; background: rgb(225, 245, 254); color: rgb(2, 136, 209);"><strong
style="box-sizing: inherit; font-weight: bold; margin-top: 0px;">Note:</strong><span
style="box-sizing: inherit; margin-bottom: 0px;"><span>&nbsp;</span>Cross-entropy is an idea from information theory that allows us to describe how bad it is to believe the predictions of the neural network, given what is actually true. For more information, read the blog post Visual Information Theory (http://colah.github.io/posts/2015-09-Visual-Information/)</span></aside></blockquote><h3
id="training" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Training</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">training()</code><span>&nbsp;</span>function adds the operations needed to minimize the loss via<span>&nbsp;</span><a
href="https://en.wikipedia.org/wiki/Gradient_descent" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Gradient Descent</a>.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Firstly, it takes the loss tensor from the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">loss()</code><span>&nbsp;</span>function and hands it to a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/summary/scalar" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.summary.scalar</code></a>, an op for generating summary values into the events file when used with a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/summary/FileWriter" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.summary.FileWriter</code></a><span>&nbsp;</span>(see below). In this case, it will emit the snapshot value of the loss every time the summaries are written out.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">summary</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">scalar</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'loss'</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> loss</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Next, we instantiate a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/train/GradientDescentOptimizer"
style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.train.GradientDescentOptimizer</code></a><span>&nbsp;</span>responsible for applying gradients with the requested learning rate.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">optimizer </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">GradientDescentOptimizer</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">learning_rate</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">We then generate a single variable to contain a counter for the global training step and the<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/train/Optimizer#minimize" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.train.Optimizer.minimize</code></a><span>&nbsp;</span>op is used to both update the trainable weights in the system and increment the global step. This op is, by convention, known as the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">train_op</code><span>&nbsp;</span>and is what must be run by a TensorFlow session in order to induce one full step of training (see below).</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">global_step </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Variable</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> name</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'global_step'</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> trainable</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">False</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">train_op </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> optimizer</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">minimize</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">loss</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> global_step</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">global_step</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><h2
id="train_the_model" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Train the Model</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Once the graph is built, it can be iteratively trained and evaluated in a loop controlled by the user code in<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">fully_connected_feed.py</code>.</p><h3
id="the_graph" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">The Graph</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">At the top of the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">run_training()</code><span>&nbsp;</span>function is a python<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">with</code><span>&nbsp;</span>command that indicates all of the built ops are to be associated with the default global<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/Graph" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Graph</code></a><span>&nbsp;</span>instance.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">with</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Graph</span><span
class="pun" style="box-sizing: inherit;">().</span><span class="pln" style="box-sizing: inherit;">as_default</span><span
class="pun" style="box-sizing: inherit;">():</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">A<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Graph</code><span>&nbsp;</span>is a collection of ops that may be executed together as a group. Most TensorFlow uses will only need to rely on the single default graph.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">More complicated uses with multiple graphs are possible, but beyond the scope of this simple tutorial.</p><h3
id="the_session" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">The Session</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Once all of the build preparation has been completed and all of the necessary ops generated, a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/Session" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Session</code></a><span>&nbsp;</span>is created for running the graph.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">sess </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Session</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Alternately, a<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Session</code><span>&nbsp;</span>may be generated into a<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">with</code><span>&nbsp;</span>block for scoping:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">with</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Session</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"> </span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">as</span><span
class="pln" style="box-sizing: inherit;"> sess</span><span class="pun" style="box-sizing: inherit;">:</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The empty parameter to session indicates that this code will attach to (or create if not yet created) the default local session.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Immediately after creating the session, all of the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Variable</code><span>&nbsp;</span>instances are initialized by calling<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/Session#run" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Session.run</code></a><span>&nbsp;</span>on their initialization op.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">init </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">global_variables_initializer</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">init</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/Session#run" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.Session.run</code></a><span>&nbsp;</span>method will run the complete subset of the graph that corresponds to the op(s) passed as parameters. In this first call, the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">init</code><span>&nbsp;</span>op is a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/group" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.group</code></a><span>&nbsp;</span>that contains only the initializers for the variables. None of the rest of the graph is run here; that happens in the training loop below.</p><h3
id="train_loop" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Train Loop</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">After initializing the variables with the session, training may begin.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The user code controls the training per step, and the simplest loop that can do useful training is:</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> step </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> xrange</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">FLAGS</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">max_steps</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">run</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">train_op</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">However, this tutorial is slightly more complicated in that it must also slice up the input data for each step to match the previously generated placeholders.</p><h4
id="feed_the_graph" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 18px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Feed the Graph</h4><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">For each step, the code will generate a feed dictionary that will contain the set of examples on which to train for the step, keyed by the placeholder ops they represent.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">In the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">fill_feed_dict()</code><span>&nbsp;</span>function, the given<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">DataSet</code><span>&nbsp;</span>is queried for its next<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">batch_size</code><span>&nbsp;</span>set of images and labels, and tensors matching the placeholders are filled containing the next images and labels.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">images_feed</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> labels_feed </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> data_set</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">next_batch</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">FLAGS</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">batch_size</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FLAGS</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">fake_data</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">A python dictionary object is then generated with the placeholders as keys and the representative feed tensors as values.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">feed_dict </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">{</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; images_placeholder</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> images_feed</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; labels_placeholder</span><span class="pun"
style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"> labels_feed</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="pun" style="box-sizing: inherit;">}</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">This is passed into the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">sess.run()</code><span>&nbsp;</span>function's<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">feed_dict</code><span>&nbsp;</span>parameter to provide the input examples for this step of training.</p><h4
id="check_the_status" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 18px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Check the Status</h4><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The code specifies two values to fetch in its run call:<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">[train_op, loss]</code>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> step </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> xrange</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">FLAGS</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">max_steps</span><span class="pun" style="box-sizing: inherit;">):</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; feed_dict </span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> fill_feed_dict</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">data_sets</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">train</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;images_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;labels_placeholder</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; _</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> loss_value </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">([</span><span
class="pln" style="box-sizing: inherit;">train_op</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> loss</span><span class="pun" style="box-sizing: inherit;">],</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;feed_dict</span><span
class="pun" style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;">feed_dict</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Because there are two values to fetch,<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">sess.run()</code><span>&nbsp;</span>returns a tuple with two items. Each<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Tensor</code><span>&nbsp;</span>in the list of values to fetch corresponds to a numpy array in the returned tuple, filled with the value of that tensor during this step of training. Since<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">train_op</code><span>&nbsp;</span>is an<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">Operation</code><span>&nbsp;</span>with no output value, the corresponding element in the returned tuple is<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">None</code><span>&nbsp;</span>and, thus, discarded. However, the value of the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">loss</code><span>&nbsp;</span>tensor may become NaN if the model diverges during training, so we capture this value for logging.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Assuming that the training runs fine without NaNs, the training loop also prints a simple status text every 100 steps to let the user know the state of training.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">if</span><span
class="pln" style="box-sizing: inherit;"> step </span><span class="pun" style="box-sizing: inherit;">%</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">100</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">==</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">0</span><span
class="pun" style="box-sizing: inherit;">:</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'Step %d: loss = %.2f (%.3f sec)'</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">%</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">step</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> loss_value</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> duration</span><span class="pun" style="box-sizing: inherit;">))</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><h4
id="visualize_the_status" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 18px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Visualize the Status</h4><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">In order to emit the events files used by<span>&nbsp;</span><a
href="https://www.tensorflow.org/get_started/summaries_and_tensorboard" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">TensorBoard</a>, all of the summaries (in this case, only one) are collected into a single Tensor during the graph building phase.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">summary </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">summary</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">merge_all</span><span class="pun" style="box-sizing: inherit;">()</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">And then after the session is created, a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/summary/FileWriter" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.summary.FileWriter</code></a><span>&nbsp;</span>may be instantiated to write the events files, which contain both the graph itself and the values of the summaries.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">summary_writer </span><span class="pun"
style="box-sizing: inherit;">=</span><span class="pln" style="box-sizing: inherit;"> tf</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">summary</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">FileWriter</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">FLAGS</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">train_dir</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> sess</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">graph</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Lastly, the events file will be updated with new summary values every time the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">summary</code><span>&nbsp;</span>is evaluated and the output passed to the writer's<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">add_summary()</code><span>&nbsp;</span>function.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">summary_str </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">summary</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> feed_dict</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">feed_dict</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">summary_writer</span><span
class="pun" style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">add_summary</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">summary_str</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> step</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">When the events files are written, TensorBoard may be run against the training folder to display the values from the summaries.</p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><img alt="MNIST TensorBoard"
src="https://www.tensorflow.org/images/mnist_tensorboard.png" data-tooltip-align="b,c"
data-tooltip="MNIST TensorBoard" aria-label="MNIST TensorBoard" data-title="MNIST TensorBoard"
style="box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; max-width: 100%;"></p><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"><strong style="box-sizing: inherit; font-weight: bold;">NOTE</strong>: For more info about how to build and run Tensorboard, please see the accompanying tutorial<span>&nbsp;</span><a
href="https://www.tensorflow.org/get_started/summaries_and_tensorboard" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;">Tensorboard: Visualizing Learning</a>.</p><h4
id="save_a_checkpoint" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 18px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Save a Checkpoint</h4><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">In order to emit a checkpoint file that may be used to later restore a model for further training or evaluation, we instantiate a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/train/Saver" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.train.Saver</code></a>.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">saver </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="typ" style="box-sizing: inherit; color: rgb(156, 39, 176);">Saver</span><span
class="pun" style="box-sizing: inherit;">()</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">In the training loop, the<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/train/Saver#save" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.train.Saver.save</code></a><span>&nbsp;</span>method will periodically be called to write a checkpoint file to the training directory with the current values of all the trainable variables.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">saver</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">save</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> FLAGS</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train_dir</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> global_step</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">step</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">At some later point in the future, training might be resumed by using the<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/train/Saver#restore" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.train.Saver.restore</code></a><span>&nbsp;</span>method to reload the model parameters.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">saver</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">restore</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> FLAGS</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">train_dir</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><h2
id="evaluate_the_model" style="box-sizing: inherit; overflow: hidden; padding: 0px 0px 3px; text-overflow: ellipsis; border-bottom: 1px solid rgb(235, 235, 235); font-style: normal; font-variant: normal; font-weight: 300; font-stretch: normal; font-size: 24px; line-height: 32px; font-family: Roboto, sans-serif; letter-spacing: -0.01em; margin: 40px 0px 20px;">Evaluate the Model</h2><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Every thousand steps, the code will attempt to evaluate the model against both the training and test datasets. The<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">do_eval()</code><span>&nbsp;</span>function is called thrice, for the training, validation, and test datasets.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'Training Data Eval:'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">do_eval</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; eval_correct</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; images_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; labels_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; data_sets</span><span class="pun"
style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">train</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'Validation Data Eval:'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">do_eval</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; eval_correct</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; images_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; labels_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; data_sets</span><span class="pun"
style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">validation</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">'Test Data Eval:'</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">do_eval</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">sess</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; eval_correct</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; images_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; labels_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; data_sets</span><span class="pun"
style="box-sizing: inherit;">.</span><span class="pln" style="box-sizing: inherit;">test</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><blockquote style="box-sizing: inherit; background: rgb(247, 247, 247); margin: 16px 0px; padding: 8px; quotes: none;"><p
style="box-sizing: inherit; margin: 0px; padding: 0px;">Note that more complicated usage would usually sequester the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">data_sets.test</code><span>&nbsp;</span>to only be checked after significant amounts of hyperparameter tuning. For the sake of a simple little MNIST problem, however, we evaluate against all of the data.</p></blockquote><h3
id="build_the_eval_graph" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Build the Eval Graph</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">Before entering the training loop, the Eval op should have been built by calling the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">evaluation()</code><span>&nbsp;</span>function from<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">mnist.py</code><span>&nbsp;</span>with the same logits/labels parameters as the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">loss()</code><span>&nbsp;</span>function.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">eval_correct </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> mnist</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">evaluation</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">logits</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> labels_placeholder</span><span class="pun"
style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">evaluation()</code><span>&nbsp;</span>function simply generates a<span>&nbsp;</span><a
href="https://www.tensorflow.org/api_docs/python/tf/nn/in_top_k" style="box-sizing: inherit; color: rgb(3, 155, 229); outline: 0px; text-decoration: none;"><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(3, 155, 229); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">tf.nn.in_top_k</code></a><span>&nbsp;</span>op that can automatically score each model output as correct if the true label can be found in the K most-likely predictions. In this case, we set the value of K to 1 to only consider a prediction correct if it is for the true label.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">eval_correct </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> tf</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">nn</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">in_top_k</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">logits</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> labels</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="lit" style="box-sizing: inherit; color: rgb(197, 57, 41);">1</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;"></span></code></pre><h3 id="eval_output" style="box-sizing: inherit; overflow: hidden; padding: 0px; text-overflow: ellipsis; font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 20px; line-height: 32px; font-family: Roboto, sans-serif; margin: 32px 0px 16px;">Eval Output</h3><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">One can then create a loop for filling a<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">feed_dict</code><span>&nbsp;</span>and calling<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">sess.run()</code><span>&nbsp;</span>against the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">eval_correct</code><span>&nbsp;</span>op to evaluate the model on the given dataset.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">for</span><span
class="pln" style="box-sizing: inherit;"> step </span><span class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">in</span><span
class="pln" style="box-sizing: inherit;"> xrange</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">steps_per_epoch</span><span class="pun"
style="box-sizing: inherit;">):</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; feed_dict </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> fill_feed_dict</span><span class="pun"
style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">data_set</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;images_placeholder</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;labels_placeholder</span><span
class="pun" style="box-sizing: inherit;">)</span><span class="pln" style="box-sizing: inherit;"><br
style="box-sizing: inherit;">&nbsp; &nbsp; true_count </span><span class="pun" style="box-sizing: inherit;">+=</span><span
class="pln" style="box-sizing: inherit;"> sess</span><span class="pun" style="box-sizing: inherit;">.</span><span
class="pln" style="box-sizing: inherit;">run</span><span class="pun" style="box-sizing: inherit;">(</span><span
class="pln" style="box-sizing: inherit;">eval_correct</span><span class="pun" style="box-sizing: inherit;">,</span><span
class="pln" style="box-sizing: inherit;"> feed_dict</span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;">feed_dict</span><span class="pun" style="box-sizing: inherit;">)</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;"></span></code></pre><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;">The<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">true_count</code><span>&nbsp;</span>variable simply accumulates all of the predictions that the<span>&nbsp;</span><code
style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 500; font-stretch: normal; font-size: 14.4px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 1px 4px; word-break: break-word;">in_top_k</code><span>&nbsp;</span>op has determined to be correct. From there, the precision may be calculated from simply dividing by the total number of examples.</p><pre
class="prettyprint lang-python" style="box-sizing: inherit; background: rgb(247, 247, 247); color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 14px; line-height: 20px; font-family: &quot;Roboto Mono&quot;, monospace; padding: 8px; margin: 16px 0px; overflow-x: auto; position: relative;"><div
class="devsite-code-button-wrapper" style="box-sizing: inherit; margin: -8px 0px 0px; padding: 0px; opacity: 0; position: absolute; right: 0px; transition: opacity 0.2s;"><div
class="devsite-code-button gc-analytics-event material-icons devsite-dark-code-button"
data-category="Site-Wide Custom Events" data-label="Dark Code Toggle" track-type="exampleCode"
track-name="darkCodeToggle" data-tooltip-align="b,c" data-tooltip="Dark code theme"
aria-label="Dark code theme" data-title="Dark code theme" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div><div
class="devsite-code-button gc-analytics-event material-icons devsite-click-to-copy-button"
data-category="Site-Wide Custom Events" data-label="Click To Copy" track-type="exampleCode"
track-name="clickToCopy" data-tooltip-align="b,c" data-tooltip="Click to copy" aria-label="Click to copy"
data-title="Click to copy" style="box-sizing: inherit; margin: 0px; padding: 3px; font-family: &quot;Material Icons&quot;; font-weight: normal; font-style: normal; font-size: 18px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; white-space: nowrap; word-wrap: normal; direction: ltr; font-feature-settings: 'liga' 1; -webkit-font-smoothing: antialiased; background: rgba(0, 0, 0, 0.26); color: rgb(255, 255, 255); cursor: default; transition: background 0.2s; vertical-align: bottom;"></div></div><code
style="box-sizing: inherit; background: 0px center; color: rgb(55, 71, 79); font-style: normal; font-variant: normal; font-weight: 400; font-stretch: normal; font-size: 14px; line-height: 1; font-family: &quot;Roboto Mono&quot;, monospace; padding: 0px; word-break: normal;"><span
class="pln" style="box-sizing: inherit;">precision </span><span class="pun" style="box-sizing: inherit;">=</span><span
class="pln" style="box-sizing: inherit;"> true_count </span><span class="pun" style="box-sizing: inherit;">/</span><span
class="pln" style="box-sizing: inherit;"> num_examples<br style="box-sizing: inherit;"></span><span
class="kwd" style="box-sizing: inherit; color: rgb(59, 120, 231);">print</span><span
class="pun" style="box-sizing: inherit;">(</span><span class="str" style="box-sizing: inherit; color: rgb(13, 144, 79);">' &nbsp;Num examples: %d &nbsp;Num correct: %d &nbsp;Precision @ 1: %0.04f'</span><span
class="pln" style="box-sizing: inherit;"> </span><span class="pun" style="box-sizing: inherit;">%</span><span
class="pln" style="box-sizing: inherit;"><br style="box-sizing: inherit;">&nbsp; &nbsp; &nbsp; </span><span
class="pun" style="box-sizing: inherit;">(</span><span class="pln" style="box-sizing: inherit;">num_examples</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> true_count</span><span
class="pun" style="box-sizing: inherit;">,</span><span class="pln" style="box-sizing: inherit;"> precision</span><span
class="pun" style="box-sizing: inherit;">))</span></code></pre></div><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"></p></div><p
style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"></p></div><p style="box-sizing: inherit; margin: 16px 0px; padding: 0px;"></p></div><p></p></div><p></p>
            <p><br></p></body></html>