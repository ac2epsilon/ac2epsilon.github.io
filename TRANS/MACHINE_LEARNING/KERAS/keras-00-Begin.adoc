include::header.adoc[]

= Keras: Бібліотека глибокого навчання Python

image:keras-logo-2018-large-1200.png[]

== Ви щойно знайшли Keras.

Keras is a high-level neural networks API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano. It was developed with a focus on enabling fast experimentation. Being able to go from idea to result with the least possible delay is key to doing good research.
Keras - API нейронних мереж високого рівня, написаний на Python і здатний працювати над https://github.com/tensorflow/tensorflow[TensorFlow], https://github.com/Microsoft/cntk[CNTK] або https://github.com/Theano/Theano[Theano]. Він був розроблений з акцентом на швидке експериментування. _Вміння переходити від ідеї до результату з найменшою можливою затримкою є ключовим для хорошого дослідження._

Використовуйте Keras, якщо вам потрібна бібліотека глибокого навчання, яка:

* Дозволяє легко та швидко прототипувати (завдяки зручності користування, модульності та розширюваності).
* Підтримує як конволюційні мережі, так і періодичні мережі, а також їх комбінації.
* Працює безперебійно на CPU та GPU.

Прочитайте документацію на https://keras.io/[Keras.io].

Keras сумісний з: Python *2.7-3.6*.

== Універсальний Keras та `tf.keras`:

Наразі ми рекомендуємо користувачам Keras, які використовують багато-бекендний Keras з бекендом TensorFlow, перейти до `tf.keras` в TensorFlow 2.0. `tf.keras` краще підтримується і має кращу інтеграцію з функціями TensorFlow (жадібне виконання, підтримка розповсюдження та інші).

Keras 2.2.5 був останнім випуском Keras, що реалізував API 2.2. *. Це був останній випуск, який підтримував лише TensorFlow 1 (а також Theano та CNTK).

Поточний реліз - Keras 2.3.0, який вносить значні зміни в API та додає підтримку для TensorFlow 2.0. 2.3.0 випуск стане останнім основним випуском багато-бекендних Keras. Багато-бекендний Keras витісняється `tf.keras`.

Помилки, наявні в багато-бекендних Keras, будуть виправлятись лише до квітня 2020 року (як частина мінорних релізів).

Для отримання додаткової інформації про майбутнє Keras див. Примітки до зборів Keras.

== Керівні принципи

* *Дружність до користувачів.* Keras - це API, призначений для людей, а не для машин. Це ставить досвід користувача спереду та в центр. Keras дотримується кращих практик зменшення когнітивного навантаження: він пропонує послідовні та прості API, він мінімізує кількість дій користувачів, необхідних для загальних випадків використання, та забезпечує чіткий та дієвий зворотний зв'язок при помилці користувача.

* *Модульність.* Модель розуміється як послідовність або граф самостійних, повністю настроюваних модулів, які можна підключити разом з якомога меншими обмеженнями. Зокрема, нейронні шари, функції витрат, оптимізатори, схеми ініціалізації, функції активації та схеми регуляризації - це окремі модулі, які можна комбінувати для створення нових моделей.

* *Легка розширюваність.* Нові модулі легко додавати (як нові класи та функції), а існуючі модулі провадять доволі прикладів. Можливість легко створювати нові модулі дозволяє отримати повну виразність, що робить Keras придатним для складних досліджень.

* *Робота з Python.* Немає окремих конфігураційних файлів моделей у декларативному форматі. Моделі описані в коді Python, що є компактним, простішим у налагодженні та дозволяє просте розширення.

== Початок роботи: 30 секунд на Keras

Основна структура даних Keras - це *model*, спосіб впорядкування шарів. Найпростіший тип моделі - модель `Sequential`, лінійний стек шарів. Для більш складних архітектур слід використовувати функціональний https://keras.io/getting-started/functional-api-guide[API Keras], який дозволяє будувати довільні графи шарів.

Ось послідовна модель `Sequential`:

[source,python]
----
from keras.models import Sequential

model = Sequential()
----

Укладання шарів просте, як `.add()`:

[source,python]
----
from keras.layers import Dense

model.add(Dense(units=64, activation='relu', input_dim=100))
model.add(Dense(units=10, activation='softmax'))
----

Як тільки ваша модель виглядає добре, налаштуйте її процес навчання за допомогою `.compile()`:

[source,python]
----
model.compile(loss='categorical_crossentropy',
              optimizer='sgd',
              metrics=['accuracy'])
----

Якщо вам потрібно, ви можете додатково налаштувати оптимізатор. Основний принцип Keras полягає в тому, щоб зробити речі досить простими, при цьому дозволяючи користувачеві повністю контролювати, коли їм потрібно (ультимативним керуванням є проста розширюваність джерельного коду).

[source,python]
----
model.compile(loss=keras.losses.categorical_crossentropy,
              optimizer=keras.optimizers.SGD(lr=0.01, momentum=0.9, nesterov=True))
----

Тепер ви можете ітерувати свої тренувальні дані в пакунках:

[source,python]
----
# x_train та y_train - це масиви Numpy - як і в API Scikit-Learn.
model.fit(x_train, y_train, epochs=5, batch_size=32)
----

Крім того, ви можете подавати партії до своєї моделі вручну:

[source,python]
----
model.train_on_batch(x_batch, y_batch)
----

Оцініть свою ефективність в одному рядку:

[source,python]
----
loss_and_metrics = model.evaluate(x_test, y_test, batch_size=128)
----

Або генеруйте прогнози щодо нових даних:

[source,python]
----
classes = model.predict(x_test, batch_size=128)
----

Так саме швидке створення системи відповідей на питання, моделі класифікації зображень, нейронної машини Тюрінга або будь-якої іншої моделі. Ідеї ​​глибокого навчання прості, то чому їх реалізація повинна бути болісною?

Для отримання більш поглибленого підручника про Keras ви можете подавитись:

* https://keras.io/getting-started/sequential-model-guide[Початок роботи з послідовною моделлю Sequential]
* https://keras.io/getting-started/functional-api-guide[Початок роботи з функціональним API]

У https://github.com/keras-team/keras/tree/master/examples[папці прикладів] репозиторія ви знайдете більш досконалі моделі: запитання-відповіді на мережах пам'яті, генерування тексту зі стеками LSTM тощо.

== Установка

Перш ніж встановлювати Keras, будь ласка, встановіть один із його бекенд двигунів: TensorFlow, Theano або CNTK. Ми рекомендуємо бекенд TensorFlow.

* https://www.tensorflow.org/install/[Інструкції з установки TensorFlow].
* http://deeplearning.net/software/theano/install.html#install[Інструкції з установки Theano].
* https://docs.microsoft.com/en-us/cognitive-toolkit/setup-cntk-on-your-machine[Інструкції з установки CNTK].

Ви також можете встановити наступні необов'язкові залежності:

* `cuDNN` (рекомендується, якщо ви плануєте запускати Keras в GPU).
* `HDF5` та `h5py` (необхідні, якщо ви плануєте зберігати моделі Keras на диску).
* `graphviz` та `pydot` (використовуються утилітами візуалізації для побудови графіків моделей).

Потім ви можете встановити сам Keras. Існує два способи встановлення Keras:

* Встановити Keras з PyPI (рекомендується):

Примітка. Ці кроки встановлення передбачають, що ви перебуваєте в середовищі Linux або Mac. Якщо ви працюєте в Windows, вам потрібно буде видалити sudo, щоб запустити команди нижче.

[source,bash]
----
sudo pip install keras
----

Якщо ви використовуєте virtualenv, можливо, ви захочете уникати використання `sudo`:

[source,bash]
----
pip install keras
----

* Як варіант: встановіть Keras з джерела GitHub:

По-перше, клонуйте Keras за допомогою git:

[source,bash]
----
git clone https://github.com/keras-team/keras.git
----

Потім перейдіть до папки Keras і запустіть команду встановлення:

[source,bash]
----
cd keras
sudo python setup.py install
----

=== Налаштування сервера Keras

За замовчуванням Keras буде використовувати TensorFlow як свою бібліотеку маніпуляцій з матрицями. Дотримуйтесь цих вказівок, щоб налаштувати сервер Keras.

=== Підтримка

Ви можете задати питання та долучитися до дискусії про розвиток:

* В Keras Google group.
* В каналі Keras Slack. Use this link to request an invitation to the channel.

Ви також можете публікувати звіти про помилки та запити на функції (лише) у проблемах GitHub. Обов’язково спочатку прочитайте наші вказівки.

=== Чому це ім'я, Keras?

Keras (κέρας) в перекладі з грецької означає ріг. Це посилання на літературний образ із давньогрецької та латинської літератури, вперше знайдений в «Одіссеї», де духи мрії (Онейрой, множ. від Онейрос) розділені між тими, хто обманює людей хибними видіннями, які прибувають на Землю через ворота слонової кістки і тих, хто сповіщає про майбутнє, яке здійсниться, хто прибуде через ворота рогу. Це гра на слова κέρας (ріг) / κραίνω (виконати) та ἐλέφας (слонова кістка) / ἐλεφαίρομαι (обманювати).

Keras was initially developed as part of the research effort of project ONEIROS (Open-ended Neuro-Electronic Intelligent Robot Operating System).
Keras був спочатку розроблений у рамках дослідницьких робіт проекту ONEIROS (Відкрита нейро-електронна операційна система для інтелектуального робота).

  "Онєрої виходять за межі нашого розуміння - хто може бути впевнений, яку казку вони розповідають? Не все збувається, що люди шукають. Існують двоє воріт, що дають прохід швидкоплинному Онейрою; одна зроблена з рогу, одна із слонової кістки. Онерої які проходять через пилову слонову кістку, обманливі, несуть повідомлення, яке не буде виконано; ті, що виходять через відшліфований ріг, мають за собою правду, яку слід здійснити для людей, які їх бачать ". Гомер, Одіссея 19. 562 ff (Переклад Шеринга).

= Навіщо використовувати Keras?

На сьогодні існує безліч фреймворків глибокого навчання. Навіщо використовувати Keras, а не будь-який інший? Ось деякі сфери, в яких Keras вигідно вирізняється серед існуючих альтернатив.

== Keras надає пріоритет досвіду розробника

* Keras - це API, призначений для людей, а не для машин. Keras дотримується кращих практик зменшення когнітивного навантаження: він пропонує послідовні та прості API, він мінімізує кількість дій користувачів, необхідних для випадків загального використання, та забезпечує чіткий та дієвий зворотний зв'язок при помилці користувача.
* Це робить Keras простим у навчанні та легким у використанні. Як користувач Keras, ви більш продуктивні, що дозволяє вам швидше спробувати більше ідей, ніж у ваших конкурентів, що, в свою чергу, допомагає вигравати змагання з машинного навчання.
* Така простота використання не є ціною зниженої гнучкості: оскільки Keras інтегрується з мовами глибокого навчення нижчого рівня (зокрема TensorFlow), це дозволяє реалізувати все, що ви могли побудувати на базовій мові. Зокрема, як `tf.keras`, API Keras легко інтегрується з вашими робочими процесами TensorFlow.

=== Keras має широке сприйняття в галузі та науковому співтоваристві

image:dl_frameworks_power_scores.png[]

_Рейтинг фреймворків глибокого навчання, обчислений Джеффом Хейлом, на основі 11 джерел даних у 7 категоріях_

Маючи понад 250 000 індивідуальних користувачів станом на середину 2018 року, Keras має сильніші позиції як у галузі, так і в науковому співтоваристві, ніж будь-яка інша система глибокого навчання, крім самого TensorFlow (а API Keras є офіційним інтерфейсом TensorFlow через модуль `tf.keras`).

Ви вже постійно взаємодієте з функціями, створеними за допомогою Keras - він використовується в Netflix, Uber, Yelp, Instacart, Zocdoc, Square та багатьох інших. Він особливо популярний серед стартапів, які ставлять глибоке навчання в основі своїх продуктів.

Keras також є улюбленим серед дослідників глибокого навчання, який займає №2 з точки зору згадок у наукових статтях, завантажених на сервер переддруку arXiv.org. Keras також прийняли дослідники великих наукових організацій, зокрема CERN та NASA.

=== Keras дозволяє легко перетворити моделі на продукти

Ваші моделі Keras можна легко розгорнути на більшій кількості платформ, ніж будь-яку іншу систему глибокого навчання:

On iOS, via Apple’s CoreML (Keras support officially provided by Apple). Here's a tutorial.
* На iOS через https://developer.apple.com/documentation/coreml[Apple CoreML]  (підтримка Keras офіційно надана Apple). Ось https://www.pyimagesearch.com/2018/04/23/running-keras-models-on-ios-with-coreml/[підручник].
* На Android через Android TensorFlow. Приклад: https://medium.com/@timanglade/how-hbos-silicon-valley-built-not-hotdog-with-mobile-tensorflow-keras-react-native-ef03260747f3[Додаток Not Hotdog].
* У браузері через прискорені графічним процесором JavaScript, такі як https://transcranial.github.io/keras-js/#/[Keras.js] та https://mil-tokyo.github.io/webdnn/[WebDNN].
* У Google Cloud через https://www.tensorflow.org/serving/[TensorFlow-Serving].
* У веб-програмі з бекендом на Python (наприклад, https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html[для програм Flask]).
* На JVM, через https://deeplearning4j.org/model-import-keras[імпорт моделі DL4J], наданий SkyMind.
* На Raspberry Pi.

=== Keras підтримує декілька бекенд двигунів і не замикає вас в одній екосистемі

Your Keras models can be developed with a range of different deep learning backends. Importantly, any Keras model that only leverages built-in layers will be portable across all these backends: you can train a model with one backend, and load it with another (e.g. for deployment). Available backends include:
Ваші моделі Keras можуть бути розроблені за допомогою ряду різних https://keras.io/backend/[бекендів глибокого навчання]. Важливо, що будь-яка модель Keras, яка використовує лише вбудовані шари, буде однаковою для всіх цих програм: ви можете тренувати модель за допомогою одного бекенда та завантажувати її іншим (наприклад, для розгортання). Доступні пакети включають:

* Бекенд TensorFlow (від Google)
* Бекенд CNTK (від Microsoft)
* Бекенд Theano

В Amazon також є https://github.com/awslabs/keras-apache-mxnet[гілка Keras, яка використовує MXNet як бекенд.]

Таким чином, ваша модель Keras може пройти навчання на кількох різних апаратних платформах поза процесорами:

* https://developer.nvidia.com/deep-learning[NVIDIA GPU]
* https://cloud.google.com/tpu/[Google TPU] через сервер TensorFlow та Google Cloud
* Графічні процесори з підтримкою OpenCL, такі як AMD, через https://github.com/plaidml/plaidml[сервер PlaidML Keras]

=== У Keras є потужна підтримка багатьох GPU та підтримка розподіленого навчання

* Keras має вбуддовану підтримку для мульті-GPU паралельності по даних
* Horovod від Uber має першокласну підтримку для моделей Keras
* Моделі Keras можуть бути перетворені на TensorFlow Estimators і треновані and trained на кластерах з GPU на Google Cloud
* Keras може виконуватись на Spark через Dist-Keras (від CERN) та Elephas

=== Розробка Keras підтримується ключовими компаніями з екосистеми глибокого навчання

Розробка Keras підтримується в основному Google, і Keras API іде запакований в TensorFlow як `tf.keras`. Також Microsoft підтримує бекенд CNTK Keras. Amazon AWS підтримує гілку Keras з підтримкою MXNet. Інші компанії дописувачі включають NVIDIA, Uber та Apple (з CoreML).
